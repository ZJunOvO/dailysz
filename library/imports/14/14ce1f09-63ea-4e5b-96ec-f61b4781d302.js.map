{"version":3,"sources":["assets\\scripts\\page_level.js"],"names":["n","Object","defineProperty","exports","value","_evts","require","_res","_cfgMgr","_lang","_global","_festivalMgr","_levelMgr","_panelMgr","_tipMgr","_pInfo","_levelItem","m","cc","_decorator","v","ccclass","_","property","b","t","e","apply","arguments","bg","content","levelItemPrefab","lockedSp","unlockSp","startBtnLbl","jigsawPfb","bgSpr","startNode","startNodeGray","chaLb","secLb","secPro","__extends","prototype","onLoad","ins","getBundleByString","then","o","padScale","load","getBgId","SpriteFrame","node","isValid","spriteFrame","console","error","width","halfHeight","view","getVisibleSize","height","upChapter","checkStartBtn","initScrollView","initLvl","opE","on","onOperTap","bind","onE","start","scheduleOnce","parent","x","getPuzzleLvl","Math","ceil","string","levelDone","fillRange","isMianLocked","active","floor","instantiate","i","getPuzzleLvlCount","r","a","s","c","l","p","h","f","name","setParent","setPosition","w","getComponent","setLvlLbl","sp","levelNumber","isUnlocked","off","log","selectedLevel","onStart","call","buttonComp","Button","addComponent","transition","Transition","SCALE","zoomScale","tween","sequence","to","scale","repeatForever","addJigsaw","getLevelCost","children","position","y","onScrollForItemVis","length","u","serverCfg","lock_rules","main_line_lock","main_line_val","showTip","lang","format","getPower","open","itemId","startSelectedLevel","originalLevel","setPuzzleLvl","childrenCount","onBtnChapter","Sprite","getJigsawIcon","puzzlv","getMaterial","setProperty","checkShowFinger","onD","_fingerNode","lPre","getChildByName","addChild","v3","action","UPDJIGSAW","checkJigsaw","FINISH_PUZZLELV","checkAndPop","POP_FESTIVAL","popFestival","UPDATA_LEVEL_TMP","updateLvlTmp","levelTmp","isShow","isFesEnd","fesTaskDatas","v2","add","multiplyScalar","bezierTo","setTimeout","destroy","onDestroy","releaseJigsaw","assetManager","releaseAsset","releaseJigsawIcon","onBtnFes","__decorate","Node","Prefab","Label","Component"],"mappings":"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","sourceRoot":"/","sourcesContent":["var n;\nObject.defineProperty(exports, \"__esModule\", {value: !0});\nvar _evts = require(\"evts\");\nvar _res = require(\"res\");\nvar _cfgMgr = require(\"cfgMgr\");\nvar _lang = require(\"lang\");\nvar _global = require(\"global\");\nvar _festivalMgr = require(\"festivalMgr\");\nvar _levelMgr = require(\"levelMgr\");\nvar _panelMgr = require(\"panelMgr\");\nvar _tipMgr = require(\"tipMgr\");\nvar _pInfo = require(\"pInfo\");\nvar _levelItem = require(\"levelItem\");\nvar m = cc._decorator;\nvar v = m.ccclass;\nvar _ = m.property;\nvar b = (function (t) {\n    function e() {\n        var e = (null !== t && t.apply(this, arguments)) || this;\n        e.bg = null;\n        e.content = null;\n        e.levelItemPrefab = null;\n        e.lockedSp = null;\n        e.unlockSp = null;\n        e.startBtnLbl = null;\n        e.jigsawPfb = null;\n        e.bgSpr = null;\n        e.startNode = null;\n        e.startNodeGray = null;\n        e.chaLb = null;\n        e.secLb = null;\n        e.secPro = null;\n        return e;\n    }\n    __extends(e, t);\n    e.prototype.onLoad = function () {\n        var t = this;\n        _res.default.ins\n            .getBundleByString(\"resSps\")\n            .then(function (e) {\n                var o = _global.default.padScale ? \"ipad/\" : \"\";\n                e.load(\n                    \"pages/page_level/\" + o + \"bg\" + _levelMgr.default.ins.getBgId(),\n                    cc.SpriteFrame,\n                    function (e, o) {\n                        t.node && t.node.isValid && !e && (t.bg.spriteFrame = o);\n                    }\n                );\n            })\n            .catch(function (t) {\n                console.error(\"RTool.ins.getBundleByString('resSps')\", t);\n            });\n        _global.default.padScale && (this.bg.node.width = 1080);\n        this.halfHeight = cc.view.getVisibleSize().height / 2;\n        this.upChapter();\n        this.checkStartBtn();\n        this.initScrollView();\n        this.initLvl();\n        _evts.default.opE.on(this.onOperTap.bind(this));\n        this.onE();\n    };\n    e.prototype.start = function () {\n        var t = this;\n        _global.default.padScale &&\n            this.scheduleOnce(function () {\n                var e = (cc.view.getVisibleSize().width - 720) / 2;\n                t.chaLb.node.parent.x -= e;\n            });\n    };\n    e.prototype.upChapter = function () {\n        var t = _pInfo.default.ins.getPuzzleLvl();\n        var e = Math.ceil(t / 54);\n        this.chaLb.string = \"第\" + e + \"章\";\n        var o = t - 54 * (e - 1) - 1;\n        _global.default.levelDone && (o = 54);\n        this.secLb.string = o + \"/54\";\n        var n = o / 54;\n        this.secPro.fillRange = n;\n    };\n    e.prototype.checkStartBtn = function () {\n        var t = _pInfo.default.ins.isMianLocked();\n        this.startNodeGray.active = t;\n        this.startNode.active = !t;\n        _global.default.levelDone\n            ? (this.startBtnLbl.node.parent.active = !1)\n            : (this.startBtnLbl.node.parent.active = !0);\n    };\n    e.prototype.initScrollView = function () {\n        for (\n            var t = Math.floor,\n                e = cc.instantiate,\n                o = [45, -57, -160, -147, -113, 18, 37, -36, -102, 14, 55, 88, 12, -52],\n                n = [35, 110, 186, 288, 391, 423, 545, 648, 746, 806, 911, 1014, 1093, 1188],\n                i = _levelMgr.default.ins.getPuzzleLvlCount(),\n                r = this.levelItemPrefab,\n                a = this.lockedSp,\n                s = this.unlockSp,\n                c = this.content,\n                l = (_pInfo.default.ins.getPuzzleLvl() - 1) % i,\n                p = _global.default.levelDone,\n                h = 0,\n                f = 5;\n            h < i;\n            h++, f++\n        ) {\n            14 == f && (f = 0);\n            var m = t((h + 5) / 14);\n            var v = o[f];\n            var _ = n[f] + 1280 * m;\n            var b = e(r);\n            b.name = \"level_\" + (h + 1);\n            b.setParent(c);\n            b.setPosition(v, _);\n            b.active = !1;\n            var w = b.getComponent(_levelItem.default);\n            w.setLvlLbl(h + 1 + \"\");\n            w.sp.spriteFrame = h < l || p ? s : a;\n            \n            // 💝 允许点击任何已解锁的关卡\n            var levelNumber = h + 1;\n            var isUnlocked = h < l || p;\n            \n            if (isUnlocked) {\n                // 为已解锁关卡添加点击事件处理\n                b.off('click');\n                b.on('click', function() {\n                    console.log('🎯 选择关卡:', levelNumber);\n                    // 设置当前要玩的关卡\n                    _global.default.selectedLevel = levelNumber;\n                    // 触发开始游戏\n                    this.onStart.call(this);\n                }.bind(this));\n                \n                // 确保有Button组件用于点击\n                var buttonComp = b.getComponent(cc.Button);\n                if (!buttonComp) {\n                    buttonComp = b.addComponent(cc.Button);\n                    buttonComp.transition = cc.Button.Transition.SCALE;\n                    buttonComp.zoomScale = 0.9;\n                }\n            }\n            l !== h ||\n                p ||\n                cc\n                    .tween(b)\n                    .sequence(cc.tween().to(1, {scale: 1.1}), cc.tween().to(1, {scale: 0.9}))\n                    .repeatForever()\n                    .start();\n            (h + 1) % 9 == 0 && this.addJigsaw(v, _, h, l);\n        }\n    };\n    e.prototype.initLvl = function () {\n        var t = _levelMgr.default.ins.getPuzzleLvlCount();\n        var e = (_pInfo.default.ins.getPuzzleLvl() - 1) % t;\n        this.startBtnLbl.string = \"-\" + _levelMgr.default.ins.getLevelCost();\n        var o = this.content;\n        var n = 0;\n        if (0 != e) {\n            var i = o.children;\n            var r = i[1].position.y;\n            n = i[e].position.y - r;\n        }\n        n = (n = -this.halfHeight - n) < -4980 ? -4980 : n;\n        o.setPosition(0, n);\n        this.onScrollForItemVis();\n    };\n    e.prototype.onScrollForItemVis = function () {\n        for (\n            var t = this.content, e = t.position.y, o = this.halfHeight, n = t.children, i = 1, r = n.length;\n            i < r;\n            i++\n        ) {\n            var a = n[i];\n            var s = a.position.y + e;\n            a.active = -o < s && s < o;\n        }\n        for (var c = this.content.children[0].children, l = ((i = 0), c.length); i < l; i++) {\n            var u = c[i];\n            s = u.position.y + e;\n            u.active = -o < s && s < o;\n        }\n    };\n    e.prototype.onStart = function () {\n        if (_pInfo.default.ins.isMianLocked()) {\n            var t = _cfgMgr.default.serverCfg.lock_rules.main_line_lock.main_line_val;\n            _tipMgr.default.ins.showTip(_lang.lang[30001].format(t));\n        } else {\n            var e = _levelMgr.default.ins.getLevelCost();\n            _pInfo.default.ins.getPower() < e\n                ? _panelMgr.default.ins.open(\"ui/ui_getRes\", {itemId: \"times\"})\n                : this.startSelectedLevel();\n        }\n    };\n    \n    // 💝 新增：开始选择的关卡\n    e.prototype.startSelectedLevel = function() {\n        // 如果有选择的关卡，设置为当前关卡\n        if (_global.default.selectedLevel) {\n            console.log('🚀 开始选择的关卡:', _global.default.selectedLevel);\n            \n            // 临时保存原始关卡进度\n            if (!_global.default.originalLevel) {\n                _global.default.originalLevel = _pInfo.default.ins.getPuzzleLvl();\n            }\n            \n            // 设置选择的关卡为当前关卡\n            _pInfo.default.ins.setPuzzleLvl(_global.default.selectedLevel);\n            \n            // 清除选择的关卡\n            _global.default.selectedLevel = null;\n        }\n        \n        // 继续原来的游戏开始流程\n        if (_global.default.levelDone) {\n            _panelMgr.default.ins.open(\"ui/ui_selectMode\", null);  \n        } else {\n            _panelMgr.default.ins.open(\"ui/ui_lvInfo\", null);\n        }\n    };\n    e.prototype.addJigsaw = function (t, e, o, n) {\n        var i = cc.instantiate(this.jigsawPfb);\n        var r = this.content.children[0].childrenCount;\n        var a = [218, -206, 132, -172, 194, 115][r];\n        var s = [1188, 1838, 2835, 3532, 4548, 5364][r];\n        i.off(\"click\", this.onBtnChapter, this);\n        i.on(\"click\", this.onBtnChapter, this);\n        i.setPosition(a, s);\n        i.active = !1;\n        i.setParent(this.content.children[0]);\n        i.name = \"jigsaw_\" + this.content.children[0].childrenCount;\n        var c;\n        var l = i.children[1].getComponent(cc.Sprite);\n        var p = Math.ceil((o + 1) / 9);\n        _levelMgr.default.ins\n            .getJigsawIcon(p)\n            .then(function (t) {\n                t && (l.spriteFrame = t);\n            })\n            .catch(function () {\n                console.error(\"getJigsawIconErr\");\n            });\n        0 == n ||\n            (\"number\" == typeof _global.default.puzzlv &&\n                ((_global.default.puzzlv = _global.default.puzzlv % _levelMgr.default.ins.getPuzzleLvlCount()),\n                (n = _global.default.puzzlv)));\n        c = _global.default.levelDone ? 9 : n >= 9 * p ? 9 : n > 9 * p - 9 ? n % 9 : 0;\n        l.getMaterial(0).setProperty(\"height\", c);\n    };\n    e.prototype.onBtnChapter = function () {\n        _panelMgr.default.ins.open(\"ui/ui_chapter\", null);\n    };\n    e.prototype.onE = function () {\n        var t = _pInfo.default.ins.getPuzzleLvl();\n        this.checkShowFinger(t <= 3);\n    };\n    e.prototype.onD = function () {\n        this.checkShowFinger(!1);\n    };\n    e.prototype.checkShowFinger = function (t) {\n        var e = this;\n        t\n            ? this._fingerNode\n                ? (this._fingerNode.active = !0)\n                : _res.default.ins\n                      .lPre(\"prefab/finger\")\n                      .then(function (t) {\n                          e._fingerNode = cc.instantiate(t);\n                          e.node.getChildByName(\"startBtn\").addChild(e._fingerNode);\n                          var o = cc.v3(80, 0);\n                          e._fingerNode.setPosition(o);\n                          e._fingerNode.active = !0;\n                      })\n                      .catch(function () {\n                          console.error(\"getPrefabErr\");\n                      })\n            : this._fingerNode && this._fingerNode.active && (this._fingerNode.active = !1);\n    };\n    e.prototype.onOperTap = function (t) {\n        var e = null == t ? void 0 : t.action;\n        if (e)\n            switch (e) {\n                case _evts.default.UPDJIGSAW:\n                    this.checkJigsaw();\n                    break;\n                case _evts.default.FINISH_PUZZLELV:\n                    this.checkAndPop();\n                    break;\n                case _evts.default.POP_FESTIVAL:\n                    this.popFestival();\n                    break;\n                case _evts.default.UPDATA_LEVEL_TMP:\n                    this.updateLvlTmp();\n            }\n    };\n    e.prototype.updateLvlTmp = function () {\n        _global.default.levelTmp;\n    };\n    e.prototype.checkAndPop = function () {\n        this.checkJigsaw();\n        this.scheduleOnce(function () {\n            _global.default.levelDone\n                ? _panelMgr.default.ins.open(\"ui/ui_selectMode\", null)\n                : 1 == _pInfo.default.ins.getPuzzleLvl() % 54\n                ? _panelMgr.default.ins.open(\"ui/ui_chapterDone\", {})\n                : _panelMgr.default.ins.open(\"ui/ui_lvInfo\", {isShow: !0});\n        }, 0);\n    };\n    e.prototype.popFestival = function () {\n        !_festivalMgr.default.ins.isFesEnd() &&\n            _festivalMgr.default.ins.fesTaskDatas &&\n            _panelMgr.default.ins.open(\"ui/ui_festival\", null);\n    };\n    e.prototype.checkJigsaw = function () {\n        if (\"number\" == typeof _global.default.puzzlv) {\n            var t = (_pInfo.default.ins.getPuzzleLvl() - 1) % _levelMgr.default.ins.getPuzzleLvlCount();\n            if (t) {\n                if (_global.default.puzzlv != t || 1 == t) {\n                    var e = this.content.getChildByName(\"level_\" + t);\n                    var o = Math.ceil(t / 9);\n                    var n = this.content.children[0].getChildByName(\"jigsaw_\" + o);\n                    var i = cc.instantiate(e);\n                    i.setParent(e.parent);\n                    i.setPosition(e.position);\n                    var r = cc.v2(i.x, i.y);\n                    var a = cc.v2(n.x, n.y);\n                    var s = t % 9 || 9;\n                    var c = Math.floor((s - 1) / 3);\n                    var l = (s - 1) % 3;\n                    a.x += ((l - 1) * n.width * n.scale) / 3;\n                    a.y += ((1 - c) * n.width * n.scale) / 3;\n                    var p = a.add(r).multiplyScalar(0.7);\n                    cc.tween(i)\n                        .bezierTo(1, r, p, a)\n                        .call(function () {\n                            i.active = !1;\n                            setTimeout(function () {\n                                i.destroy();\n                            }, 100);\n                            n.children[1].getComponent(cc.Sprite).getMaterial(0).setProperty(\"height\", s);\n                        })\n                        .start();\n                }\n                _global.default.puzzlv = null;\n            }\n        }\n    };\n    e.prototype.onDestroy = function () {\n        _evts.default.opE.off(this.onOperTap.bind(this));\n        this.onD();\n        for (var t = _levelMgr.default.ins.getPuzzleLvlCount(), e = 0, o = 5; e < t; e++, o++)\n            (e + 1) % 9 == 0 && this.releaseJigsaw(e);\n        cc.assetManager.releaseAsset(this.bgSpr.spriteFrame);\n    };\n    e.prototype.releaseJigsaw = function (t) {\n        var e = Math.ceil((t + 1) / 9);\n        _levelMgr.default.ins.releaseJigsawIcon(e);\n    };\n    e.prototype.onBtnFes = function () {\n        _panelMgr.default.ins.open(\"ui/ui_festival\", null);\n    };\n    __decorate([_(cc.Sprite)], e.prototype, \"bg\", void 0);\n    __decorate([_(cc.Node)], e.prototype, \"content\", void 0);\n    __decorate([_(cc.Prefab)], e.prototype, \"levelItemPrefab\", void 0);\n    __decorate([_(cc.SpriteFrame)], e.prototype, \"lockedSp\", void 0);\n    __decorate([_(cc.SpriteFrame)], e.prototype, \"unlockSp\", void 0);\n    __decorate([_(cc.Label)], e.prototype, \"startBtnLbl\", void 0);\n    __decorate([_(cc.Prefab)], e.prototype, \"jigsawPfb\", void 0);\n    __decorate([_(cc.Sprite)], e.prototype, \"bgSpr\", void 0);\n    __decorate([_(cc.Node)], e.prototype, \"startNode\", void 0);\n    __decorate([_(cc.Node)], e.prototype, \"startNodeGray\", void 0);\n    __decorate([_(cc.Label)], e.prototype, \"chaLb\", void 0);\n    __decorate([_(cc.Label)], e.prototype, \"secLb\", void 0);\n    __decorate([_(cc.Sprite)], e.prototype, \"secPro\", void 0);\n    return __decorate([v], e);\n})(cc.Component);\nexports.default = b;\n"]}