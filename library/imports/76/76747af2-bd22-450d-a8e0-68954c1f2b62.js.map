{"version":3,"sources":["assets\\scripts\\newJigMgr.js"],"names":["Object","defineProperty","exports","value","_idx","require","_pInfo","_bagMgr","_festivalMgr","s","t","jigsawTileTotal","jigsawThemeNum","ins","getJigsawNum","localData","seed","get","_ins","enumerable","configurable","prototype","getJigsawTilesByIdx","e","getJigsawTiles","o","getItemCount","n","i","shuffleArray","length","a","indexOf","push","c","concat","l","u","p","d","Math","min","h","setJigsawTilesByIdx","setJigsawTiles","isItemUnlock","isPieceEnough","getNowJigsawLv","IsJigsawCompletedByIdx","getAllTiles","getUnPlacedNum","checkHasFin","r","seedRandom","floor","getLocalJigData","tiles","setLocalJigData","assign","platform","setStorage","getStorage","checkClearData","getIsClearJigsawData","setIsClearJigsawData","clearJigsawData","checkSetFin","setFinfishJigsaw","getHasFinFesJig","setHasFinFesJig","clearFinJig","resetJigByIdx"],"mappings":"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","sourceRoot":"/","sourcesContent":["Object.defineProperty(exports, \"__esModule\", {value: !0});\nvar _idx = require(\"idx\");\nvar _pInfo = require(\"pInfo\");\nvar _bagMgr = require(\"bagMgr\");\nvar _festivalMgr = require(\"festivalMgr\");\nvar s = (function () {\n    function t() {\n        this.jigsawTileTotal = 105;\n        this.jigsawThemeNum = _festivalMgr.default.ins.getJigsawNum();\n        this.localData = null;\n        this.seed = 5;\n    }\n    Object.defineProperty(t, \"ins\", {\n        get: function () {\n            return this._ins || (this._ins = new t());\n        },\n        enumerable: !1,\n        configurable: !0\n    });\n    t.prototype.getJigsawTilesByIdx = function (t) {\n        var e = this.getJigsawTiles()[t] || [];\n        var o = _bagMgr.default.ins.getItemCount(\"newYear_pieces\");\n        var n = t + 1;\n        this.seed = 21 + n;\n        var i = [\n            0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 22, 33, 44, 55, 66, 77, 88, 99, 89, 100, 91, 101, 93, 102, 95, 103,\n            97, 104, 98, 87, 76, 65, 54, 43, 32, 21\n        ];\n        this.shuffleArray(i);\n        i.length = 10;\n        for (var a = [], s = 0; s < 105; s++) -1 == i.indexOf(s) && a.push(s);\n        this.shuffleArray(a);\n        var c = i.concat(a);\n        if (e.length < this.jigsawTileTotal) {\n            var l = e.length;\n            var u = this.jigsawTileTotal - e.length;\n            var p = o - ((n - 1) * this.jigsawTileTotal + l);\n            if (p > 0) {\n                var d = Math.min(u, p);\n                for (s = 0; s < d; s++) {\n                    var h = c[l + s];\n                    e.push([h, -1]);\n                }\n            }\n        }\n        this.setJigsawTilesByIdx(t, e);\n        return e;\n    };\n    t.prototype.setJigsawTilesByIdx = function (t, e) {\n        var o = this.getJigsawTiles();\n        o[t] = e;\n        this.setJigsawTiles(o);\n    };\n    t.prototype.isItemUnlock = function () {\n        return !0;\n    };\n    t.prototype.isPieceEnough = function (t) {\n        var e = t * this.jigsawTileTotal;\n        return _bagMgr.default.ins.getItemCount(\"newYear_pieces\") > e;\n    };\n    t.prototype.getNowJigsawLv = function () {\n        for (var t = 0, e = this.getJigsawTiles().length; t < e; t++) if (!this.IsJigsawCompletedByIdx(t)) return t + 1;\n    };\n    t.prototype.IsJigsawCompletedByIdx = function (t) {\n        var e = this.getJigsawTiles()[t];\n        if (105 == e.length) {\n            for (var o = 0, n = e; o < n.length; o++) {\n                var i = n[o];\n                if (i[0] != i[1]) return !1;\n            }\n            return !0;\n        }\n        return !1;\n    };\n    t.prototype.getAllTiles = function () {\n        for (var t = 0, e = this.jigsawThemeNum; t < e; t++) this.getJigsawTilesByIdx(t);\n    };\n    t.prototype.getUnPlacedNum = function () {\n        this.getAllTiles();\n        for (var t = this.getJigsawTiles(), e = 0, o = 0, n = t.length; o < n; o++) {\n            var i = t[o];\n            if (!this.checkHasFin(o))\n                for (var r = 0, a = i.length; r < a; r++) {\n                    var s = i[r];\n                    s[1] != s[0] && e++;\n                }\n        }\n        return e;\n    };\n    t.prototype.seedRandom = function () {\n        this.seed = (9301 * this.seed + 49297) % 233280;\n        return this.seed / 233280;\n    };\n    t.prototype.shuffleArray = function (t) {\n        for (var e, o = t.length - 1; o > 0; o--) {\n            var n = Math.floor(this.seedRandom() * (o + 1));\n            e = [t[n], t[o]];\n            t[o] = e[0];\n            t[n] = e[1];\n        }\n    };\n    t.prototype.getJigsawTiles = function () {\n        var t = this.getLocalJigData().tiles;\n        return null == t ? [] : t;\n    };\n    t.prototype.setJigsawTiles = function (t) {\n        this.setLocalJigData({tiles: t});\n    };\n    t.prototype.setLocalJigData = function (t) {\n        var e = this.getLocalJigData();\n        this.localData = Object.assign(Object.assign({}, e), t);\n        _idx.platform.setStorage(\"newJigsaw\", this.localData);\n    };\n    t.prototype.getLocalJigData = function () {\n        null == this.localData && (this.localData = _idx.platform.getStorage(\"newJigsaw\") || {});\n        return this.localData;\n    };\n    t.prototype.checkClearData = function () {\n        _pInfo.default.ins.getIsClearJigsawData() &&\n            (_pInfo.default.ins.setIsClearJigsawData(!1), this.clearJigsawData());\n    };\n    t.prototype.clearJigsawData = function () {\n        this.localData = {};\n        _idx.platform.setStorage(\"newJigsaw\", this.localData);\n    };\n    t.prototype.checkSetFin = function (t) {\n        this.checkHasFin(t) || this.setFinfishJigsaw(t);\n    };\n    t.prototype.checkHasFin = function (t) {\n        return _pInfo.default.ins.getHasFinFesJig()[t] || !1;\n    };\n    t.prototype.setFinfishJigsaw = function (t) {\n        var e = _pInfo.default.ins.getHasFinFesJig();\n        e[t] = !0;\n        _pInfo.default.ins.setHasFinFesJig(e);\n    };\n    t.prototype.clearFinJig = function (t) {\n        var e = _pInfo.default.ins.getHasFinFesJig();\n        e[t] = !1;\n        _pInfo.default.ins.setHasFinFesJig(e);\n    };\n    t.prototype.resetJigByIdx = function (t) {\n        for (var e = this.getJigsawTilesByIdx(t), o = [], n = 0, i = e.length; n < i; n++) {\n            var r = e[n];\n            r[1] = -1;\n            o.push(r);\n        }\n        this.setJigsawTilesByIdx(t, o);\n        this.clearFinJig(t);\n    };\n    return t;\n})();\nexports.default = s;\n"]}