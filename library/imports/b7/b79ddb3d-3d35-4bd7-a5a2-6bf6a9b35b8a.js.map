{"version":3,"sources":["assets\\scripts\\festivalMgr.js"],"names":["Object","defineProperty","exports","value","fesTaskKey","a","_time","require","_cfgMgr","_pInfo","_bagMgr","p","cc","_decorator","d","ccclass","property","t","raceScore","raceTimes","costPower","throughMain","finishPuzzle","h","fesBeginTime","fesEndTime","fesTaskDatas","jigsawNum","e","get","_ins","enumerable","configurable","prototype","isFesEnd","ins","serverTime","isFesNotOpen","getTodayMaxPro","Math","floor","getNowTaskIdx","getFesPro","min","getNowTaskPro","getFesTaskPro","getNowTaskData","isTaskLocked","isTaskAllFinished","length","updPro","get_by","o","n","Number","setFesTaskPro","finishFesTask","setFesPro","isPuzzleLocked","getFesPuzzleLv","finishFesPuzzleLv","setFesPuzzleLv","clearFesPuzzleLv","getRedNum","nums","updateFestivalData","__awaiter","__generator","label","serverCfg","festival_tasks","fesName","getFesName","setFesName","beginTime","endTime","rules","sent","getFesPuzzleInfo","fesPuzzleData","i","id","type","size","diff","getFesPuzzleData","r","pow","s","c","l","u","getFesPuzzleDiff","getFesLevelCost","difficulty_rules","times_val","getFesPuzzleSprFrame","Promise","bundle","load","SpriteFrame","getFesDownSprFrame","isPuzzleMax","isJigsawMax","getItemCount","getJigsawNum","__decorate"],"mappings":"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","sourceRoot":"/","sourcesContent":["Object.defineProperty(exports, \"__esModule\", {value: !0});\nexports.fesTaskKey = void 0;\nvar a;\nvar _time = require(\"time\");\nvar _cfgMgr = require(\"cfgMgr\");\nvar _pInfo = require(\"pInfo\");\nvar _bagMgr = require(\"bagMgr\");\nvar p = cc._decorator;\nvar d = p.ccclass;\np.property;\n(function (t) {\n    t.raceScore = \"race_score\";\n    t.raceTimes = \"race_times\";\n    t.costPower = \"cost_power\";\n    t.throughMain = \"through_main\";\n    t.finishPuzzle = \"finish_puzzle\";\n})((a = exports.fesTaskKey || (exports.fesTaskKey = {})));\nvar h = (function () {\n    function t() {\n        this.fesBeginTime = 0;\n        this.fesEndTime = 0;\n        this.fesTaskDatas = null;\n        this.jigsawNum = 1;\n    }\n    var e;\n    e = t;\n    Object.defineProperty(t, \"ins\", {\n        get: function () {\n            return this._ins || (this._ins = new e());\n        },\n        enumerable: !1,\n        configurable: !0\n    });\n    t.prototype.isFesEnd = function () {\n        var t = _time.default.ins.serverTime;\n        return t < this.fesBeginTime || t >= this.fesEndTime;\n    };\n    t.prototype.isFesNotOpen = function () {\n        return _time.default.ins.serverTime < this.fesBeginTime;\n    };\n    t.prototype.getTodayMaxPro = function () {\n        var t = _time.default.ins.serverTime;\n        var e = Math.floor((t - this.fesBeginTime) / 86400);\n        return e < 0 ? 0 : e;\n    };\n    t.prototype.getNowTaskIdx = function () {\n        var t = this.getTodayMaxPro();\n        var e = _pInfo.default.ins.getFesPro();\n        return Math.min(e, t, 24);\n    };\n    t.prototype.getNowTaskPro = function () {\n        return _pInfo.default.ins.getFesTaskPro();\n    };\n    t.prototype.getFesPro = function () {\n        return _pInfo.default.ins.getFesPro();\n    };\n    t.prototype.getNowTaskData = function () {\n        var t = this.getNowTaskIdx();\n        return this.fesTaskDatas[t];\n    };\n    t.prototype.isTaskLocked = function () {\n        return _pInfo.default.ins.getFesPro() > this.getTodayMaxPro();\n    };\n    t.prototype.isTaskAllFinished = function () {\n        return _pInfo.default.ins.getFesPro() >= this.fesTaskDatas.length;\n    };\n    t.prototype.updPro = function (t, e) {\n        if (!this.isTaskLocked() && this.fesTaskDatas && this.getNowTaskData().get_by == t) {\n            var o = _pInfo.default.ins.getFesTaskPro();\n            var n = 0;\n            switch (t) {\n                case a.raceScore:\n                    n = e;\n                    break;\n                default:\n                    n = e + Number(o);\n            }\n            _pInfo.default.ins.setFesTaskPro(n);\n        }\n    };\n    t.prototype.finishFesTask = function () {\n        var t = _pInfo.default.ins;\n        var e = t.getFesPro();\n        t.setFesPro(e + 1);\n        t.setFesTaskPro(0);\n    };\n    t.prototype.isPuzzleLocked = function () {\n        return this.getFesPuzzleLv() - 1 > this.getTodayMaxPro();\n    };\n    t.prototype.getFesPuzzleLv = function () {\n        return _pInfo.default.ins.getFesPuzzleLv();\n    };\n    t.prototype.finishFesPuzzleLv = function () {\n        var t = _pInfo.default.ins.getFesPuzzleLv();\n        _pInfo.default.ins.setFesPuzzleLv(t + 1);\n    };\n    t.prototype.clearFesPuzzleLv = function () {\n        var t = _pInfo.default.ins;\n        t.setFesPuzzleLv(1);\n        t.setFesPro(0);\n        t.setFesTaskPro(0);\n    };\n    t.prototype.getRedNum = function () {\n        var t = 0;\n        if (!this.fesTaskDatas) return t;\n        if ((this.isPuzzleLocked() || t++, !this.isTaskLocked())) {\n            var e = this.getNowTaskData().nums;\n            this.getNowTaskPro() >= e && t++;\n        }\n        return t;\n    };\n    t.prototype.updateFestivalData = function () {\n        var t;\n        return __awaiter(this, void 0, void 0, function () {\n            var e;\n            var o;\n            return __generator(this, function (n) {\n                switch (n.label) {\n                    case 0:\n                        return (\n                            (e = null === (t = _cfgMgr.default.serverCfg) || void 0 === t ? void 0 : t.festival_tasks),\n                            (o = (null == e ? void 0 : e.fesName) || \"newYear\"),\n                            _pInfo.default.ins.getFesName() != o &&\n                                (_pInfo.default.ins.setFesName(o), this.clearFesPuzzleLv()),\n                            (this.fesBeginTime = Number(null == e ? void 0 : e.beginTime) || 1707148800),\n                            (this.fesEndTime = Number(null == e ? void 0 : e.endTime) || this.fesBeginTime + 216e4),\n                            (this.fesTaskDatas = null == e ? void 0 : e.rules),\n                            (this.jigsawNum = (null == e ? void 0 : e.jigsawNum) || 1),\n                            [2]\n                        );\n                    case 1:\n                        return [2, n.sent()];\n                }\n            });\n        });\n    };\n    t.prototype.getFesPuzzleInfo = function () {\n        var t = this.fesPuzzleData;\n        var e = t[0];\n        var o = t[1];\n        var n = this.getFesPuzzleLv() - 1;\n        var i = t[2 + o + (0 == n ? 0 : t[2 + n - 1] + n)];\n        return {id: n, type: e, size: 255 & i, diff: (i >> 8) & 255};\n    };\n    t.prototype.getFesPuzzleData = function () {\n        for (\n            var t = this.fesPuzzleData,\n                e = t[1],\n                o = this.getFesPuzzleLv() - 1,\n                n = 0 == o ? 0 : t[2 + o - 1] + o,\n                i = t[2 + o] + o,\n                r = t[2 + e + n],\n                a = Math.pow(255 & r, 2),\n                s = 2 + e + i + 1,\n                c = [],\n                l = 0,\n                u = 2 + e + n + 1;\n            u < s;\n            u++\n        ) {\n            for (var p = t[u], d = 0; d < 32; d++) {\n                var h = (1 << d) & 4294967295;\n                if (((c[l++] = (p & h) == h ? 1 : 0), l == a)) break;\n            }\n            if (l == a) break;\n        }\n        return c;\n    };\n    t.prototype.getFesPuzzleDiff = function () {\n        return this.getFesPuzzleInfo().diff;\n    };\n    t.prototype.getFesLevelCost = function () {\n        var t = e.ins.getFesPuzzleDiff();\n        var o = _cfgMgr.default.serverCfg.difficulty_rules.rules;\n        var n = 10;\n        var i = 1;\n        for (var r in o) {\n            var a = o[r];\n            if (((n = Number(a.times_val)), i === t)) break;\n            i++;\n        }\n        return n;\n    };\n    t.prototype.getFesPuzzleSprFrame = function () {\n        var t = this;\n        return new Promise(function (e, o) {\n            t.bundle.load(\"levels/\" + t.getFesPuzzleLv(), cc.SpriteFrame, function (t, n) {\n                t ? o() : e(n);\n            });\n        });\n    };\n    t.prototype.getFesDownSprFrame = function () {\n        var t = this;\n        return new Promise(function (e, o) {\n            t.bundle.load(\"chapter\", cc.SpriteFrame, function (t, n) {\n                t ? o() : e(n);\n            });\n        });\n    };\n    t.prototype.isPuzzleMax = function () {\n        return e.ins.getFesPuzzleLv() > 25;\n    };\n    t.prototype.isJigsawMax = function () {\n        return _bagMgr.default.ins.getItemCount(\"newYear_pieces\") >= 105 * this.jigsawNum;\n    };\n    t.prototype.getJigsawNum = function () {\n        return this.jigsawNum;\n    };\n    return (e = __decorate([d], t));\n})();\nexports.default = h;\n"]}