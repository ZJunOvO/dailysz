{"version":3,"sources":["assets\\scripts\\mailItem.js"],"names":["n","Object","defineProperty","exports","value","_time","require","_mailMgr","_panelMgr","l","cc","_decorator","u","ccclass","p","property","d","t","e","apply","arguments","title","content","leftT","goNode","mailSpf","newNode","qNode","rewardedNode","icon","timeBg","__extends","prototype","init","id","o","ins","serverMail","length","substring","string","i","msg","temple","updateState","undateTime","schedule","macro","REPEAT_FOREVER","state","mailState","award","spriteFrame","active","noRead","onOperTap","action","end_time","serverTime","unschedule","formatDate2Str","_forceUpdateRenderData","node","width","onEnable","on","showMailInfo","onDisable","off","open","__decorate","Label","Node","SpriteFrame","Sprite","Component"],"mappings":"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","sourceRoot":"/","sourcesContent":["var n;\nObject.defineProperty(exports, \"__esModule\", {value: !0});\nvar _time = require(\"time\");\nvar _mailMgr = require(\"mailMgr\");\nvar _panelMgr = require(\"panelMgr\");\nvar l = cc._decorator;\nvar u = l.ccclass;\nvar p = l.property;\nvar d = (function (t) {\n    function e() {\n        var e = (null !== t && t.apply(this, arguments)) || this;\n        e.title = null;\n        e.content = null;\n        e.leftT = null;\n        e.goNode = null;\n        e.mailSpf = [];\n        e.newNode = null;\n        e.qNode = null;\n        e.rewardedNode = null;\n        e.icon = null;\n        e.timeBg = null;\n        return e;\n    }\n    __extends(e, t);\n    e.prototype.init = function (t, e) {\n        this.id = t;\n        var o = _mailMgr.default.ins.serverMail[t];\n        if (o) {\n            var n = o.title;\n            n.length > 8 && (n = n.substring(0, 7) + \"...\");\n            this.title.string = n;\n            var i = o.msg;\n            i.length > 9 && (i = i.substring(0, 8) + \"...\");\n            this.content.string = i;\n            this.temple = o;\n            this.updateState(e);\n            this.undateTime();\n            this.schedule(this.undateTime, 1, cc.macro.REPEAT_FOREVER);\n        }\n    };\n    e.prototype.updateState = function (t) {\n        this.state = t;\n        t == _mailMgr.mailState.award\n            ? (this.icon.spriteFrame = this.mailSpf[1])\n            : (this.icon.spriteFrame = this.mailSpf[0]);\n        this.rewardedNode.active = t == _mailMgr.mailState.award;\n        this.newNode.active = t == _mailMgr.mailState.noRead;\n    };\n    e.prototype.onOperTap = function (t) {\n        null == t || t.action;\n    };\n    e.prototype.undateTime = function () {\n        if (this.temple.end_time) {\n            var t = this.temple.end_time / 1e3 - _time.default.ins.serverTime;\n            t < 0\n                ? this.unschedule(this.undateTime)\n                : ((this.leftT.string = \"剩余\" + _time.default.formatDate2Str(t)),\n                  this.leftT._forceUpdateRenderData(!0),\n                  (this.timeBg.node.width = this.leftT.node.width + 20));\n        }\n    };\n    e.prototype.onEnable = function () {\n        this.goNode.on(\"click\", this.showMailInfo, this);\n    };\n    e.prototype.onDisable = function () {\n        this.goNode.off(\"click\", this.showMailInfo, this);\n        this.unschedule(this.undateTime);\n    };\n    e.prototype.showMailInfo = function () {\n        _mailMgr.default.ins.serverMail[this.id] && _panelMgr.default.ins.open(\"ui/ui_mailInfo\", {id: this.id});\n    };\n    __decorate([p(cc.Label)], e.prototype, \"title\", void 0);\n    __decorate([p(cc.Label)], e.prototype, \"content\", void 0);\n    __decorate([p(cc.Label)], e.prototype, \"leftT\", void 0);\n    __decorate([p(cc.Node)], e.prototype, \"goNode\", void 0);\n    __decorate([p(cc.SpriteFrame)], e.prototype, \"mailSpf\", void 0);\n    __decorate([p(cc.Node)], e.prototype, \"newNode\", void 0);\n    __decorate([p(cc.Node)], e.prototype, \"qNode\", void 0);\n    __decorate([p(cc.Node)], e.prototype, \"rewardedNode\", void 0);\n    __decorate([p(cc.Sprite)], e.prototype, \"icon\", void 0);\n    __decorate([p(cc.Sprite)], e.prototype, \"timeBg\", void 0);\n    return __decorate([u], e);\n})(cc.Component);\nexports.default = d;\n"]}