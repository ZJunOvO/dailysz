
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/bagMgr.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'dfb15KhzmROJKM0MC8wEsot', 'bagMgr');
// scripts/bagMgr.js

"use strict";

//电子邮件puhalskijsemen@gmail.com
//源码网站 开vpn全局模式打开 http://web3incubators.com/
//电报https://t.me/gamecode999
//网页客服 http://web3incubators.com/kefu.html
Object.defineProperty(exports, "__esModule", {
  value: !0
});
exports.bagItem = void 0;

var _evts = require("evts");

var _idx = require("idx");

var _cfgMgr = require("cfgMgr");

var _lang = require("lang");

var _pInfo = require("pInfo");

var c = function () {
  function t() {
    if (this._propTag = "props", t._ins) throw new Error("bagMgr can only be one！");
    t._ins = this;
  }

  Object.defineProperty(t, "ins", {
    get: function get() {
      t._ins || new t();
      return t._ins;
    },
    enumerable: !1,
    configurable: !0
  });

  t.prototype.initBag = function (t) {
    if (t) {
      var e = _cfgMgr["default"].serverCfg.qw_line_rules.rules.times.set.basic_times.val;
      this.chgItemCount("qw_line_ticket", e, !1);
      this.updItem();
    }
  };

  Object.defineProperty(t.prototype, "bagItem", {
    get: function get() {
      this._bagItem || (this._bagItem = _pInfo["default"].ins.Bag);
      return this._bagItem;
    },
    enumerable: !1,
    configurable: !0
  });

  t.prototype.clearItem = function () {
    this._bagItem = null;
  };

  t.prototype.updItem = function () {
    _pInfo["default"].ins.Bag = this._bagItem;
  };

  t.prototype.useItem = function (t, e, o) {
    if (void 0 === e && (e = 1), t) if (this.bagItem[t]) {
      this.bagItem[t] -= e;
      this.bagItem[t] <= 0 && delete this.bagItem[t];
      this.updItem();
      var r = "拼图";
      _lang.gemeTypeKey[o] && (r = _lang.gemeTypeKey[o]);

      _idx.platform.reportEvent(_idx.ERepEvt.useItem, {
        gameType: r,
        itemId: _lang.reportKey[t]
      });

      _evts["default"].opE.emit({
        action: _evts["default"].UPD_MAIN_RED
      });
    } else cc.log("使用失败，无该道具：" + t);
  };

  t.prototype.checkItemEnough = function (t, e) {
    void 0 === e && (e = 1);
    return this.bagItem[t] && this.bagItem[t] >= e;
  };

  t.prototype.addItem = function (t, e, o, i) {
    void 0 === e && (e = 1);
    void 0 === o && (o = !0);
    void 0 === i && (i = !0);
    this.specialItemCheck(t, e) || t && (null == this.bagItem[t] && (this.bagItem[t] = 0), this.bagItem[t] += e, o && this.updItem(), "puzzle_pieces" !== t && "newYear_pieces" !== t || _evts["default"].opE.emit({
      action: _evts["default"].UPDJIGSAWGAME
    }), i && _evts["default"].opE.emit({
      action: _evts["default"].UPD_MAIN_RED
    }));
  };

  t.prototype.chgItemCount = function (t, e, o) {
    void 0 === e && (e = 1);
    void 0 === o && (o = !0);
    t && (null == this.bagItem[t] && (this.bagItem[t] = 0), this.bagItem[t] = e, o && this.updItem());
  };

  t.prototype.getItemCount = function (t) {
    return t && this.bagItem[t] ? this.bagItem[t] : 0;
  };

  t.prototype.specialItemCheck = function (t, e) {
    switch (t) {
      case "coin":
        return _pInfo["default"].ins.addCoin(e), !0;

      case "exp":
        return _pInfo["default"].ins.addExp(e), !0;

      case "times":
        return _pInfo["default"].ins.addPower(e), !0;

      default:
        return !1;
    }
  };

  return t;
}();

exports["default"] = c;

exports.bagItem = function () {
  this.count = 0;
};

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcYmFnTWdyLmpzIl0sIm5hbWVzIjpbIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiYmFnSXRlbSIsIl9ldnRzIiwicmVxdWlyZSIsIl9pZHgiLCJfY2ZnTWdyIiwiX2xhbmciLCJfcEluZm8iLCJjIiwidCIsIl9wcm9wVGFnIiwiX2lucyIsIkVycm9yIiwiZ2V0IiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsInByb3RvdHlwZSIsImluaXRCYWciLCJlIiwic2VydmVyQ2ZnIiwicXdfbGluZV9ydWxlcyIsInJ1bGVzIiwidGltZXMiLCJzZXQiLCJiYXNpY190aW1lcyIsInZhbCIsImNoZ0l0ZW1Db3VudCIsInVwZEl0ZW0iLCJfYmFnSXRlbSIsImlucyIsIkJhZyIsImNsZWFySXRlbSIsInVzZUl0ZW0iLCJvIiwiciIsImdlbWVUeXBlS2V5IiwicGxhdGZvcm0iLCJyZXBvcnRFdmVudCIsIkVSZXBFdnQiLCJnYW1lVHlwZSIsIml0ZW1JZCIsInJlcG9ydEtleSIsIm9wRSIsImVtaXQiLCJhY3Rpb24iLCJVUERfTUFJTl9SRUQiLCJjYyIsImxvZyIsImNoZWNrSXRlbUVub3VnaCIsImFkZEl0ZW0iLCJpIiwic3BlY2lhbEl0ZW1DaGVjayIsIlVQREpJR1NBV0dBTUUiLCJnZXRJdGVtQ291bnQiLCJhZGRDb2luIiwiYWRkRXhwIiwiYWRkUG93ZXIiLCJjb3VudCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBQSxNQUFNLENBQUNDLGNBQVAsQ0FBc0JDLE9BQXRCLEVBQStCLFlBQS9CLEVBQTZDO0VBQUNDLEtBQUssRUFBRSxDQUFDO0FBQVQsQ0FBN0M7QUFDQUQsT0FBTyxDQUFDRSxPQUFSLEdBQWtCLEtBQUssQ0FBdkI7O0FBQ0EsSUFBSUMsS0FBSyxHQUFHQyxPQUFPLENBQUMsTUFBRCxDQUFuQjs7QUFDQSxJQUFJQyxJQUFJLEdBQUdE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O0lBQzNDLFFBQVFULENBQVI7TUFDSSxLQUFLLE1BQUw7UUFDSSxPQUFPRixNQUFNLFdBQU4sQ0FBZXNCLEdBQWYsQ0FBbUJ5QixPQUFuQixDQUEyQnBDLENBQTNCLEdBQStCLENBQUMsQ0FBdkM7O01BQ0osS0FBSyxLQUFMO1FBQ0ksT0FBT1gsTUFBTSxXQUFOLENBQWVzQixHQUFmLENBQW1CMEIsTUFBbkIsQ0FBMEJyQyxDQUExQixHQUE4QixDQUFDLENBQXRDOztNQUNKLEtBQUssT0FBTDtRQUNJLE9BQU9YLE1BQU0sV0FBTixDQUFlc0IsR0FBZixDQUFtQjJCLFFBQW5CLENBQTRCdEMsQ0FBNUIsR0FBZ0MsQ0FBQyxDQUF4Qzs7TUFDSjtRQUNJLE9BQU8sQ0FBQyxDQUFSO0lBUlI7RUFVSCxDQVhEOztFQVlBLE9BQU9ULENBQVA7QUFDSCxDQXBGTyxFQUFSOztBQXFGQVYsT0FBTyxXQUFQLEdBQWtCUyxDQUFsQjs7QUFDQVQsT0FBTyxDQUFDRSxPQUFSLEdBQWtCLFlBQVk7RUFDMUIsS0FBS3dELEtBQUwsR0FBYSxDQUFiO0FBQ0gsQ0FGRCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiLy/nlLXlrZDpgq7ku7ZwdWhhbHNraWpzZW1lbkBnbWFpbC5jb21cbi8v5rqQ56CB572R56uZIOW8gHZwbuWFqOWxgOaooeW8j+aJk+W8gCBodHRwOi8vd2ViM2luY3ViYXRvcnMuY29tL1xuLy/nlLXmiqVodHRwczovL3QubWUvZ2FtZWNvZGU5OTlcbi8v572R6aG15a6i5pyNIGh0dHA6Ly93ZWIzaW5jdWJhdG9ycy5jb20va2VmdS5odG1sXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHt2YWx1ZTogITB9KTtcbmV4cG9ydHMuYmFnSXRlbSA9IHZvaWQgMDtcbnZhciBfZXZ0cyA9IHJlcXVpcmUoXCJldnRzXCIpO1xudmFyIF9pZHggPSByZXF1aXJlKFwiaWR4XCIpO1xudmFyIF9jZmdNZ3IgPSByZXF1aXJlKFwiY2ZnTWdyXCIpO1xudmFyIF9sYW5nID0gcmVxdWlyZShcImxhbmdcIik7XG52YXIgX3BJbmZvID0gcmVxdWlyZShcInBJbmZvXCIpO1xudmFyIGMgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIHQoKSB7XG4gICAgICAgIGlmICgoKHRoaXMuX3Byb3BUYWcgPSBcInByb3BzXCIpLCB0Ll9pbnMpKSB0aHJvdyBuZXcgRXJyb3IoXCJiYWdNZ3IgY2FuIG9ubHkgYmUgb25l77yBXCIpO1xuICAgICAgICB0Ll9pbnMgPSB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgXCJpbnNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHQuX2lucyB8fCBuZXcgdCgpO1xuICAgICAgICAgICAgcmV0dXJuIHQuX2lucztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogITEsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogITBcbiAgICB9KTtcbiAgICB0LnByb3RvdHlwZS5pbml0QmFnID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgaWYgKHQpIHtcbiAgICAgICAgICAgIHZhciBlID0gX2NmZ01nci5kZWZhdWx0LnNlcnZlckNmZy5xd19saW5lX3J1bGVzLnJ1bGVzLnRpbWVzLnNldC5iYXNpY190aW1lcy52YWw7XG4gICAgICAgICAgICB0aGlzLmNoZ0l0ZW1Db3VudChcInF3X2xpbmVfdGlja2V0XCIsIGUsICExKTtcbiAgICAgICAgICAgIHRoaXMudXBkSXRlbSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsIFwiYmFnSXRlbVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5fYmFnSXRlbSB8fCAodGhpcy5fYmFnSXRlbSA9IF9wSW5mby5kZWZhdWx0Lmlucy5CYWcpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhZ0l0ZW07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6ICExLFxuICAgICAgICBjb25maWd1cmFibGU6ICEwXG4gICAgfSk7XG4gICAgdC5wcm90b3R5cGUuY2xlYXJJdGVtID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9iYWdJdGVtID0gbnVsbDtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLnVwZEl0ZW0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9wSW5mby5kZWZhdWx0Lmlucy5CYWcgPSB0aGlzLl9iYWdJdGVtO1xuICAgIH07XG4gICAgdC5wcm90b3R5cGUudXNlSXRlbSA9IGZ1bmN0aW9uICh0LCBlLCBvKSB7XG4gICAgICAgIGlmICgodm9pZCAwID09PSBlICYmIChlID0gMSksIHQpKVxuICAgICAgICAgICAgaWYgKHRoaXMuYmFnSXRlbVt0XSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYmFnSXRlbVt0XSAtPSBlO1xuICAgICAgICAgICAgICAgIHRoaXMuYmFnSXRlbVt0XSA8PSAwICYmIGRlbGV0ZSB0aGlzLmJhZ0l0ZW1bdF07XG4gICAgICAgICAgICAgICAgdGhpcy51cGRJdGVtKCk7XG4gICAgICAgICAgICAgICAgdmFyIHIgPSBcIuaLvOWbvlwiO1xuICAgICAgICAgICAgICAgIF9sYW5nLmdlbWVUeXBlS2V5W29dICYmIChyID0gX2xhbmcuZ2VtZVR5cGVLZXlbb10pO1xuICAgICAgICAgICAgICAgIF9pZHgucGxhdGZvcm0ucmVwb3J0RXZlbnQoX2lkeC5FUmVwRXZ0LnVzZUl0ZW0sIHtnYW1lVHlwZTogciwgaXRlbUlkOiBfbGFuZy5yZXBvcnRLZXlbdF19KTtcbiAgICAgICAgICAgICAgICBfZXZ0cy5kZWZhdWx0Lm9wRS5lbWl0KHthY3Rpb246IF9ldnRzLmRlZmF1bHQuVVBEX01BSU5fUkVEfSk7XG4gICAgICAgICAgICB9IGVsc2UgY2MubG9nKFwi5L2/55So5aSx6LSl77yM5peg6K+l6YGT5YW377yaXCIgKyB0KTtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLmNoZWNrSXRlbUVub3VnaCA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICAgIHZvaWQgMCA9PT0gZSAmJiAoZSA9IDEpO1xuICAgICAgICByZXR1cm4gdGhpcy5iYWdJdGVtW3RdICYmIHRoaXMuYmFnSXRlbVt0XSA+PSBlO1xuICAgIH07XG4gICAgdC5wcm90b3R5cGUuYWRkSXRlbSA9IGZ1bmN0aW9uICh0LCBlLCBvLCBpKSB7XG4gICAgICAgIHZvaWQgMCA9PT0gZSAmJiAoZSA9IDEpO1xuICAgICAgICB2b2lkIDAgPT09IG8gJiYgKG8gPSAhMCk7XG4gICAgICAgIHZvaWQgMCA9PT0gaSAmJiAoaSA9ICEwKTtcbiAgICAgICAgdGhpcy5zcGVjaWFsSXRlbUNoZWNrKHQsIGUpIHx8XG4gICAgICAgICAgICAodCAmJlxuICAgICAgICAgICAgICAgIChudWxsID09IHRoaXMuYmFnSXRlbVt0XSAmJiAodGhpcy5iYWdJdGVtW3RdID0gMCksXG4gICAgICAgICAgICAgICAgKHRoaXMuYmFnSXRlbVt0XSArPSBlKSxcbiAgICAgICAgICAgICAgICBvICYmIHRoaXMudXBkSXRlbSgpLFxuICAgICAgICAgICAgICAgIChcInB1enpsZV9waWVjZXNcIiAhPT0gdCAmJiBcIm5ld1llYXJfcGllY2VzXCIgIT09IHQpIHx8XG4gICAgICAgICAgICAgICAgICAgIF9ldnRzLmRlZmF1bHQub3BFLmVtaXQoe2FjdGlvbjogX2V2dHMuZGVmYXVsdC5VUERKSUdTQVdHQU1FfSksXG4gICAgICAgICAgICAgICAgaSAmJiBfZXZ0cy5kZWZhdWx0Lm9wRS5lbWl0KHthY3Rpb246IF9ldnRzLmRlZmF1bHQuVVBEX01BSU5fUkVEfSkpKTtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLmNoZ0l0ZW1Db3VudCA9IGZ1bmN0aW9uICh0LCBlLCBvKSB7XG4gICAgICAgIHZvaWQgMCA9PT0gZSAmJiAoZSA9IDEpO1xuICAgICAgICB2b2lkIDAgPT09IG8gJiYgKG8gPSAhMCk7XG4gICAgICAgIHQgJiYgKG51bGwgPT0gdGhpcy5iYWdJdGVtW3RdICYmICh0aGlzLmJhZ0l0ZW1bdF0gPSAwKSwgKHRoaXMuYmFnSXRlbVt0XSA9IGUpLCBvICYmIHRoaXMudXBkSXRlbSgpKTtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLmdldEl0ZW1Db3VudCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHJldHVybiB0ICYmIHRoaXMuYmFnSXRlbVt0XSA/IHRoaXMuYmFnSXRlbVt0XSA6IDA7XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5zcGVjaWFsSXRlbUNoZWNrID0gZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgICAgc3dpdGNoICh0KSB7XG4gICAgICAgICAgICBjYXNlIFwiY29pblwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBfcEluZm8uZGVmYXVsdC5pbnMuYWRkQ29pbihlKSwgITA7XG4gICAgICAgICAgICBjYXNlIFwiZXhwXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9wSW5mby5kZWZhdWx0Lmlucy5hZGRFeHAoZSksICEwO1xuICAgICAgICAgICAgY2FzZSBcInRpbWVzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9wSW5mby5kZWZhdWx0Lmlucy5hZGRQb3dlcihlKSwgITA7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiAhMTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIHQ7XG59KSgpO1xuZXhwb3J0cy5kZWZhdWx0ID0gYztcbmV4cG9ydHMuYmFnSXRlbSA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmNvdW50ID0gMDtcbn07XG4iXX0=