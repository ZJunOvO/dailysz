
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/jigsawMgr.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '2f97e8To3BGBasqLgXvs1PD', 'jigsawMgr');
// scripts/jigsawMgr.js

"use strict";

Object.defineProperty(exports, "__esModule", {
  value: !0
});

var _idx = require("idx");

var _global = require("global");

var _pInfo = require("pInfo");

var _bagMgr = require("bagMgr");

var s = function () {
  function t() {
    this.jigsawTileTotal = 105;
    this.localData = null;
    this.seed = 5;
    this.saveStr = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!@#$%^&*()_+?><{}|[]. 亿'\"一二三四五六七八九十东西南北中百千万";
  }

  Object.defineProperty(t, "ins", {
    get: function get() {
      return this._ins || (this._ins = new t());
    },
    enumerable: !1,
    configurable: !0
  });

  t.prototype.getJigsawTilesByIdx = function (t) {
    var e = this.getJigsawTiles()[t] || [];

    var o = _bagMgr["default"].ins.getItemCount("puzzle_pieces");

    var n = t + 1;
    var i = this.getTicketPoolByIdx(t);

    if (e.length < this.jigsawTileTotal) {
      var r = e.length;
      var s = this.jigsawTileTotal - e.length;
      var c = o - ((n - 1) * this.jigsawTileTotal + r);
      if (c > 0) for (var l = Math.min(s, c), u = 0; u < l; u++) {
        var p = i[r + u];
        e.push([p, -1]);
      }
    }

    this.setJigsawTilesByIdx(t, e, !1);
    return e;
  };

  t.prototype.getTicketPoolByIdx = function (t) {
    var e = t + 1;
    this.seed = 22 + e;
    var o = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 22, 33, 44, 55, 66, 77, 88, 99, 89, 100, 91, 101, 93, 102, 95, 103, 97, 104, 98, 87, 76, 65, 54, 43, 32, 21];
    this.shuffleArray(o);
    o.length = 10;

    for (var n = [], i = 0; i < 105; i++) {
      -1 == o.indexOf(i) && n.push(i);
    }

    this.shuffleArray(n);
    return o.concat(n);
  };

  t.prototype.setJigsawTilesByIdx = function (t, e, o) {
    void 0 === o && (o = !0);

    for (var n = this.saveStr, i = "", a = 0, s = e.length; a < s; a++) {
      var c = e[a][1];
      var l = "-";
      -1 != c && (l = n[c]);
      i += l;
    }

    var u = this.getNewSaveTiles();

    if (u[t] = i, this.setNewSaveTiles(u), o) {
      var p = [t, i];

      _pInfo["default"].ins.setJigTiles(p);
    }
  };

  t.prototype.isItemUnlock = function (t) {
    var e = t * this.jigsawTileTotal;

    var o = _bagMgr["default"].ins.getItemCount("puzzle_pieces");

    var n = _pInfo["default"].ins.isJigsawLocked();

    return (0 == t || !n) && o > e;
  };

  t.prototype.isPieceEnough = function (t) {
    var e = t * this.jigsawTileTotal;
    return _bagMgr["default"].ins.getItemCount("puzzle_pieces") > e;
  };

  t.prototype.getNowJigsawLv = function () {
    for (var t = 0, e = this.getJigsawTiles().length; t < e; t++) {
      if (!this.IsJigsawCompletedByIdx(t)) return t + 1;
    }
  };

  t.prototype.IsJigsawCompletedByIdx = function (t) {
    var e = this.getJigsawTiles()[t];

    if (105 == e.length) {
      for (var o = 0, n = e; o < n.length; o++) {
        var i = n[o];
        if (i[0] != i[1]) return !1;
      }

      return !0;
    }

    return !1;
  };

  t.prototype.getAllTiles = function () {
    for (var t = 0, e = _global["default"].jisawCount; t < e; t++) {
      this.getJigsawTilesByIdx(t);
    }
  };

  t.prototype.getUnPlacedNum = function () {
    this.getAllTiles();

    for (var t = this.getJigsawTiles(), e = 0, o = 0, n = t.length; o < n; o++) {
      var i = t[o];
      if (!this.checkHasFin(o)) for (var r = 0, a = i.length; r < a; r++) {
        var s = i[r];
        s[1] != s[0] && e++;
      }
    }

    return e;
  };

  t.prototype.seedRandom = function () {
    this.seed = (9301 * this.seed + 49297) % 233280;
    return this.seed / 233280;
  };

  t.prototype.shuffleArray = function (t) {
    for (var e, o = t.length - 1; o > 0; o--) {
      var n = Math.floor(this.seedRandom() * (o + 1));
      e = [t[n], t[o]];
      t[o] = e[0];
      t[n] = e[1];
    }
  };

  t.prototype.getJigsawTiles = function () {
    var t = this.saveStr;

    var e = _pInfo["default"].ins.getJigTiles();

    var o = this.getNewSaveTiles();
    var n = [];
    var i = o.length;

    if (i) {
      -1 != e[0] && (o[e[0]] = e[1]);

      for (var a = 0; a < i; a++) {
        var s = o[a];

        if (s) {
          for (var c = this.getTicketPoolByIdx(a), l = [], u = 0, p = s.length; u < p; u++) {
            var d = c[u];
            var h = s[u];
            var f = [d, t.indexOf(h)];
            l.push(f);
          }

          n.push(l);
        }
      }
    } else for (var g = [], y = (a = 0, (n = this.getOldSaveTiles()).length); a < y; a++) {
      for (var m = n[a], v = "", _ = (u = 0, m.length); u < _; u++) {
        var b = m[u][1];
        var w = "-";
        -1 != b && (w = t[b]);
        v += w;
      }

      g.push(v);
      this.setNewSaveTiles(g);
      this.setOldSaveTiles([]);
    }

    return n;
  };

  t.prototype.getNewSaveTiles = function () {
    var t = this.getLocalJigData().jigTils;
    return null == t ? [] : t;
  };

  t.prototype.setNewSaveTiles = function (t) {
    this.setLocalJigData({
      jigTils: t
    });
  };

  t.prototype.getOldSaveTiles = function () {
    var t = this.getLocalJigData().tiles;
    return null == t ? [] : t;
  };

  t.prototype.setOldSaveTiles = function (t) {
    this.setLocalJigData({
      tiles: t
    });
  };

  t.prototype.setLocalJigData = function (t) {
    var e = this.getLocalJigData();
    this.localData = Object.assign(Object.assign({}, e), t);

    _idx.platform.setStorage("jigsawData", this.localData);
  };

  t.prototype.getLocalJigData = function () {
    null == this.localData && (this.localData = _idx.platform.getStorage("jigsawData") || {});
    return this.localData;
  };

  t.prototype.checkClearData = function () {
    _pInfo["default"].ins.getIsClearJigsawData() && (_pInfo["default"].ins.setIsClearJigsawData(!1), this.clearJigsawData());
  };

  t.prototype.clearJigsawData = function () {
    this.localData = {};

    _idx.platform.setStorage("jigsawData", this.localData);
  };

  t.prototype.checkSetFin = function (t) {
    this.checkHasFin(t) || this.setFinfishJigsaw(t);
  };

  t.prototype.checkHasFin = function (t) {
    return _pInfo["default"].ins.getHasFinJig()[t] || !1;
  };

  t.prototype.setFinfishJigsaw = function (t) {
    var e = _pInfo["default"].ins.getHasFinJig();

    e[t] = !0;

    _pInfo["default"].ins.setHasFinJig(e);
  };

  t.prototype.clearFinJig = function (t) {
    var e = _pInfo["default"].ins.getHasFinJig();

    e[t] = !1;

    _pInfo["default"].ins.setHasFinJig(e);
  };

  t.prototype.resetJigByIdx = function (t) {
    for (var e = this.getJigsawTilesByIdx(t), o = [], n = 0, i = e.length; n < i; n++) {
      var r = e[n];
      r[1] = -1;
      o.push(r);
    }

    this.setJigsawTilesByIdx(t, o, !1);
    this.clearFinJig(t);
  };

  return t;
}();

exports["default"] = s;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcamlnc2F3TWdyLmpzIl0sIm5hbWVzIjpbIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiX2lkeCIsInJlcXVpcmUiLCJfZ2xvYmFsIiwiX3BJbmZvIiwiX2JhZ01nciIsInMiLCJ0Iiwiamlnc2F3VGlsZVRvdGFsIiwibG9jYWxEYXRhIiwic2VlZCIsInNhdmVTdHIiLCJnZXQiLCJfaW5zIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsInByb3RvdHlwZSIsImdldEppZ3Nhd1RpbGVzQnlJZHgiLCJlIiwiZ2V0Smlnc2F3VGlsZXMiLCJvIiwiaW5zIiwiZ2V0SXRlbUNvdW50IiwibiIsImkiLCJnZXRUaWNrZXRQb29sQnlJZHgiLCJsZW5ndGgiLCJyIiwiYyIsImwiLCJNYXRoIiwibWluIiwidSIsInAiLCJwdXNoIiwic2V0Smlnc2F3VGlsZXNCeUlkeCIsInNodWZmbGVBcnJheSIsImluZGV4T2YiLCJjb25jYXQiLCJhIiwiZ2V0TmV3U2F2ZVRpbGVzIiwic2V0TmV3U2F2ZVRpbGVzIiwic2V0SmlnVGlsZXMiLCJpc0l0ZW1VbmxvY2siLCJpc0ppZ3Nhd0xvY2tlZCIsImlzUGllY2VFbm91Z2giLCJnZXROb3dKaWdzYXdMdiIsIklzSmlnc2F3Q29tcGxldGVkQnlJZHgiLCJnZXRBbGxUaWxlcyIsImppc2F3Q291bnQiLCJnZXRVblBsYWNlZE51bSIsImNoZWNrSGFzRmluIiwic2VlZFJhbmRvbSIsImZsb29yIiwiZ2V0SmlnVGlsZXMiLCJkIiwiaCIsImYiLCJnIiwieSIsImdldE9sZFNhdmVUaWxlcyIsIm0iLCJ2IiwiXyIsImIiLCJ3Iiwic2V0T2xkU2F2ZVRpbGVzIiwiZ2V0TG9jYWxKaWdEYXRhIiwiamlnVGlscyIsInNldExvY2FsSmlnRGF0YSIsInRpbGVzIiwiYXNzaWduIiwicGxhdGZvcm0iLCJzZXRTdG9yYWdlIiwiZ2V0U3RvcmFnZSIsImNoZWNrQ2xlYXJEYXRhIiwiZ2V0SXNDbGVhckppZ3Nhd0RhdGEiLCJzZXRJc0NsZWFySmlnc2F3RGF0YSIsImNsZWFySmlnc2F3RGF0YSIsImNoZWNrU2V0RmluIiwic2V0RmluZmlzaEppZ3NhdyIsImdldEhhc0ZpbkppZyIsInNldEhhc0ZpbkppZyIsImNsZWFyRmluSmlnIiwicmVzZXRKaWdCeUlkeCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQUEsTUFBTSxDQUFDQyxjQUFQLENBQXNCQyxPQUF0QixFQUErQixZQUEvQixFQUE2QztFQUFDQyxLQUFLLEVBQUUsQ0FBQztBQUFULENBQTdDOztBQUNBLElBQUlDLElBQUksR0FBR0MsT0FBTyxDQUFDLEtBQUQsQ0FBbEI7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHRCxPQUFPLENBQUMsUUFBRCxDQUFyQjs7QUFDQSxJQUFJRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxPQUFELENBQXBCOztBQUNBLElBQUlHLE9BQU8sR0FBR0gsT0FBTyxDQUFDLFFBQUQsQ0FBckI7O0FBQ0EsSUFBSUksQ0FBQyxHQUFJLFlBQVk7RUFDakIsU0FBU0MsQ0FBVCxHQUFhO0lBQ1QsS0FBS0MsZUFBTCxHQUF1QixHQUF2QjtJQUNBLEtBQUtDLFNBQUwsR0FBaUIsSUFBakI7SUFDQSxLQUFLQyxJQUFMLEdBQVksQ0FBWjtJQUNBLEtBQUtDLE9BQUwsR0FDSSw0R0FESjtFQUVIOztFQUNEZCxNQUFNLENBQUNDLGNBQVAsQ0FBc0JTLENBQXRCLEVBQXlCLEtBQXpCLEVBQWdDO0lBQzVCSyxHQUFHLEVBQUUsZUFBWTtNQUNiLE9BQU8sS0FBS0MsSUFBTCxLQUFjLEtBQUtBLElBQUwsR0FBWSxJQUFJTixDQUFKLEVBQTFCLENBQVA7SUFDSCxDQUgyQjtJQUk1Qk8sVUFBVSxFQUFFLENBQUMsQ0FKZTtJQUs1QkMsWUFBWSxFQUFFLENBQUM7RUFMYSxDQUFoQzs7RUFPQVIsQ0FBQyxDQUFDUyxTQUFGLENBQVlDLG1CQUFaLEdBQWtDLFVBQVVWLENBQVYsRUFBYTtJQUMzQyxJQUFJVyxDQUFDLEdBQUcsS0FB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Q0FBUixFQUFxQ2EsQ0FBQyxHQUFHLEVBQXpDLEVBQTZDRyxDQUFDLEdBQUcsQ0FBakQsRUFBb0RDLENBQUMsR0FBR04sQ0FBQyxDQUFDUSxNQUEvRCxFQUF1RUgsQ0FBQyxHQUFHQyxDQUEzRSxFQUE4RUQsQ0FBQyxFQUEvRSxFQUFtRjtNQUMvRSxJQUFJSSxDQUFDLEdBQUdULENBQUMsQ0FBQ0ssQ0FBRCxDQUFUO01BQ0FJLENBQUMsQ0FBQyxDQUFELENBQUQsR0FBTyxDQUFDLENBQVI7TUFDQVAsQ0FBQyxDQUFDYyxJQUFGLENBQU9QLENBQVA7SUFDSDs7SUFDRCxLQUFLUSxtQkFBTCxDQUF5QjVCLENBQXpCLEVBQTRCYSxDQUE1QixFQUErQixDQUFDLENBQWhDO0lBQ0EsS0FBSytELFdBQUwsQ0FBaUI1RSxDQUFqQjtFQUNILENBUkQ7O0VBU0EsT0FBT0EsQ0FBUDtBQUNILENBMU1PLEVBQVI7O0FBMk1BUixPQUFPLFdBQVAsR0FBa0JPLENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHt2YWx1ZTogITB9KTtcbnZhciBfaWR4ID0gcmVxdWlyZShcImlkeFwiKTtcbnZhciBfZ2xvYmFsID0gcmVxdWlyZShcImdsb2JhbFwiKTtcbnZhciBfcEluZm8gPSByZXF1aXJlKFwicEluZm9cIik7XG52YXIgX2JhZ01nciA9IHJlcXVpcmUoXCJiYWdNZ3JcIik7XG52YXIgcyA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gdCgpIHtcbiAgICAgICAgdGhpcy5qaWdzYXdUaWxlVG90YWwgPSAxMDU7XG4gICAgICAgIHRoaXMubG9jYWxEYXRhID0gbnVsbDtcbiAgICAgICAgdGhpcy5zZWVkID0gNTtcbiAgICAgICAgdGhpcy5zYXZlU3RyID1cbiAgICAgICAgICAgIFwiMDEyMzQ1Njc4OUFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXohQCMkJV4mKigpXys/Pjx7fXxbXS4g5Lq/J1xcXCLkuIDkuozkuInlm5vkupTlha3kuIPlhavkuZ3ljYHkuJzopb/ljZfljJfkuK3nmb7ljYPkuIdcIjtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIFwiaW5zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faW5zIHx8ICh0aGlzLl9pbnMgPSBuZXcgdCgpKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogITEsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogITBcbiAgICB9KTtcbiAgICB0LnByb3RvdHlwZS5nZXRKaWdzYXdUaWxlc0J5SWR4ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdmFyIGUgPSB0aGlzLmdldEppZ3Nhd1RpbGVzKClbdF0gfHwgW107XG4gICAgICAgIHZhciBvID0gX2JhZ01nci5kZWZhdWx0Lmlucy5nZXRJdGVtQ291bnQoXCJwdXp6bGVfcGllY2VzXCIpO1xuICAgICAgICB2YXIgbiA9IHQgKyAxO1xuICAgICAgICB2YXIgaSA9IHRoaXMuZ2V0VGlja2V0UG9vbEJ5SWR4KHQpO1xuICAgICAgICBpZiAoZS5sZW5ndGggPCB0aGlzLmppZ3Nhd1RpbGVUb3RhbCkge1xuICAgICAgICAgICAgdmFyIHIgPSBlLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBzID0gdGhpcy5qaWdzYXdUaWxlVG90YWwgLSBlLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBjID0gbyAtICgobiAtIDEpICogdGhpcy5qaWdzYXdUaWxlVG90YWwgKyByKTtcbiAgICAgICAgICAgIGlmIChjID4gMClcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBsID0gTWF0aC5taW4ocywgYyksIHUgPSAwOyB1IDwgbDsgdSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwID0gaVtyICsgdV07XG4gICAgICAgICAgICAgICAgICAgIGUucHVzaChbcCwgLTFdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRKaWdzYXdUaWxlc0J5SWR4KHQsIGUsICExKTtcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5nZXRUaWNrZXRQb29sQnlJZHggPSBmdW5jdGlvbiAodCkge1xuICAgICAgICB2YXIgZSA9IHQgKyAxO1xuICAgICAgICB0aGlzLnNlZWQgPSAyMiArIGU7XG4gICAgICAgIHZhciBvID0gW1xuICAgICAgICAgICAgMCwgMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsIDExLCAyMiwgMzMsIDQ0LCA1NSwgNjYsIDc3LCA4OCwgOTksIDg5LCAxMDAsIDkxLCAxMDEsIDkzLCAxMDIsIDk1LCAxMDMsXG4gICAgICAgICAgICA5NywgMTA0LCA5OCwgODcsIDc2LCA2NSwgNTQsIDQzLCAzMiwgMjFcbiAgICAgICAgXTtcbiAgICAgICAgdGhpcy5zaHVmZmxlQXJyYXkobyk7XG4gICAgICAgIG8ubGVuZ3RoID0gMTA7XG4gICAgICAgIGZvciAodmFyIG4gPSBbXSwgaSA9IDA7IGkgPCAxMDU7IGkrKykgLTEgPT0gby5pbmRleE9mKGkpICYmIG4ucHVzaChpKTtcbiAgICAgICAgdGhpcy5zaHVmZmxlQXJyYXkobik7XG4gICAgICAgIHJldHVybiBvLmNvbmNhdChuKTtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLnNldEppZ3Nhd1RpbGVzQnlJZHggPSBmdW5jdGlvbiAodCwgZSwgbykge1xuICAgICAgICB2b2lkIDAgPT09IG8gJiYgKG8gPSAhMCk7XG4gICAgICAgIGZvciAodmFyIG4gPSB0aGlzLnNhdmVTdHIsIGkgPSBcIlwiLCBhID0gMCwgcyA9IGUubGVuZ3RoOyBhIDwgczsgYSsrKSB7XG4gICAgICAgICAgICB2YXIgYyA9IGVbYV1bMV07XG4gICAgICAgICAgICB2YXIgbCA9IFwiLVwiO1xuICAgICAgICAgICAgLTEgIT0gYyAmJiAobCA9IG5bY10pO1xuICAgICAgICAgICAgaSArPSBsO1xuICAgICAgICB9XG4gICAgICAgIHZhciB1ID0gdGhpcy5nZXROZXdTYXZlVGlsZXMoKTtcbiAgICAgICAgaWYgKCgodVt0XSA9IGkpLCB0aGlzLnNldE5ld1NhdmVUaWxlcyh1KSwgbykpIHtcbiAgICAgICAgICAgIHZhciBwID0gW3QsIGldO1xuICAgICAgICAgICAgX3BJbmZvLmRlZmF1bHQuaW5zLnNldEppZ1RpbGVzKHApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5pc0l0ZW1VbmxvY2sgPSBmdW5jdGlvbiAodCkge1xuICAgICAgICB2YXIgZSA9IHQgKiB0aGlzLmppZ3Nhd1RpbGVUb3RhbDtcbiAgICAgICAgdmFyIG8gPSBfYmFnTWdyLmRlZmF1bHQuaW5zLmdldEl0ZW1Db3VudChcInB1enpsZV9waWVjZXNcIik7XG4gICAgICAgIHZhciBuID0gX3BJbmZvLmRlZmF1bHQuaW5zLmlzSmlnc2F3TG9ja2VkKCk7XG4gICAgICAgIHJldHVybiAoMCA9PSB0IHx8ICFuKSAmJiBvID4gZTtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLmlzUGllY2VFbm91Z2ggPSBmdW5jdGlvbiAodCkge1xuICAgICAgICB2YXIgZSA9IHQgKiB0aGlzLmppZ3Nhd1RpbGVUb3RhbDtcbiAgICAgICAgcmV0dXJuIF9iYWdNZ3IuZGVmYXVsdC5pbnMuZ2V0SXRlbUNvdW50KFwicHV6emxlX3BpZWNlc1wiKSA+IGU7XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5nZXROb3dKaWdzYXdMdiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgdCA9IDAsIGUgPSB0aGlzLmdldEppZ3Nhd1RpbGVzKCkubGVuZ3RoOyB0IDwgZTsgdCsrKSBpZiAoIXRoaXMuSXNKaWdzYXdDb21wbGV0ZWRCeUlkeCh0KSkgcmV0dXJuIHQgKyAxO1xuICAgIH07XG4gICAgdC5wcm90b3R5cGUuSXNKaWdzYXdDb21wbGV0ZWRCeUlkeCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHZhciBlID0gdGhpcy5nZXRKaWdzYXdUaWxlcygpW3RdO1xuICAgICAgICBpZiAoMTA1ID09IGUubGVuZ3RoKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBvID0gMCwgbiA9IGU7IG8gPCBuLmxlbmd0aDsgbysrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGkgPSBuW29dO1xuICAgICAgICAgICAgICAgIGlmIChpWzBdICE9IGlbMV0pIHJldHVybiAhMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAhMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gITE7XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5nZXRBbGxUaWxlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgdCA9IDAsIGUgPSBfZ2xvYmFsLmRlZmF1bHQuamlzYXdDb3VudDsgdCA8IGU7IHQrKykgdGhpcy5nZXRKaWdzYXdUaWxlc0J5SWR4KHQpO1xuICAgIH07XG4gICAgdC5wcm90b3R5cGUuZ2V0VW5QbGFjZWROdW0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZ2V0QWxsVGlsZXMoKTtcbiAgICAgICAgZm9yICh2YXIgdCA9IHRoaXMuZ2V0Smlnc2F3VGlsZXMoKSwgZSA9IDAsIG8gPSAwLCBuID0gdC5sZW5ndGg7IG8gPCBuOyBvKyspIHtcbiAgICAgICAgICAgIHZhciBpID0gdFtvXTtcbiAgICAgICAgICAgIGlmICghdGhpcy5jaGVja0hhc0ZpbihvKSlcbiAgICAgICAgICAgICAgICBmb3IgKHZhciByID0gMCwgYSA9IGkubGVuZ3RoOyByIDwgYTsgcisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gaVtyXTtcbiAgICAgICAgICAgICAgICAgICAgc1sxXSAhPSBzWzBdICYmIGUrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5zZWVkUmFuZG9tID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNlZWQgPSAoOTMwMSAqIHRoaXMuc2VlZCArIDQ5Mjk3KSAlIDIzMzI4MDtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VlZCAvIDIzMzI4MDtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLnNodWZmbGVBcnJheSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIGZvciAodmFyIGUsIG8gPSB0Lmxlbmd0aCAtIDE7IG8gPiAwOyBvLS0pIHtcbiAgICAgICAgICAgIHZhciBuID0gTWF0aC5mbG9vcih0aGlzLnNlZWRSYW5kb20oKSAqIChvICsgMSkpO1xuICAgICAgICAgICAgZSA9IFt0W25dLCB0W29dXTtcbiAgICAgICAgICAgIHRbb10gPSBlWzBdO1xuICAgICAgICAgICAgdFtuXSA9IGVbMV07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHQucHJvdG90eXBlLmdldEppZ3Nhd1RpbGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdCA9IHRoaXMuc2F2ZVN0cjtcbiAgICAgICAgdmFyIGUgPSBfcEluZm8uZGVmYXVsdC5pbnMuZ2V0SmlnVGlsZXMoKTtcbiAgICAgICAgdmFyIG8gPSB0aGlzLmdldE5ld1NhdmVUaWxlcygpO1xuICAgICAgICB2YXIgbiA9IFtdO1xuICAgICAgICB2YXIgaSA9IG8ubGVuZ3RoO1xuICAgICAgICBpZiAoaSkge1xuICAgICAgICAgICAgLTEgIT0gZVswXSAmJiAob1tlWzBdXSA9IGVbMV0pO1xuICAgICAgICAgICAgZm9yICh2YXIgYSA9IDA7IGEgPCBpOyBhKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgcyA9IG9bYV07XG4gICAgICAgICAgICAgICAgaWYgKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IHRoaXMuZ2V0VGlja2V0UG9vbEJ5SWR4KGEpLCBsID0gW10sIHUgPSAwLCBwID0gcy5sZW5ndGg7IHUgPCBwOyB1KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gY1t1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoID0gc1t1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmID0gW2QsIHQuaW5kZXhPZihoKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBsLnB1c2goZik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbi5wdXNoKGwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICBmb3IgKHZhciBnID0gW10sIHkgPSAoKGEgPSAwKSwgKG4gPSB0aGlzLmdldE9sZFNhdmVUaWxlcygpKS5sZW5ndGgpOyBhIDwgeTsgYSsrKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbSA9IG5bYV0sIHYgPSBcIlwiLCBfID0gKCh1ID0gMCksIG0ubGVuZ3RoKTsgdSA8IF87IHUrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IG1bdV1bMV07XG4gICAgICAgICAgICAgICAgICAgIHZhciB3ID0gXCItXCI7XG4gICAgICAgICAgICAgICAgICAgIC0xICE9IGIgJiYgKHcgPSB0W2JdKTtcbiAgICAgICAgICAgICAgICAgICAgdiArPSB3O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnLnB1c2godik7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXROZXdTYXZlVGlsZXMoZyk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRPbGRTYXZlVGlsZXMoW10pO1xuICAgICAgICAgICAgfVxuICAgICAgICByZXR1cm4gbjtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLmdldE5ld1NhdmVUaWxlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHQgPSB0aGlzLmdldExvY2FsSmlnRGF0YSgpLmppZ1RpbHM7XG4gICAgICAgIHJldHVybiBudWxsID09IHQgPyBbXSA6IHQ7XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5zZXROZXdTYXZlVGlsZXMgPSBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLnNldExvY2FsSmlnRGF0YSh7amlnVGlsczogdH0pO1xuICAgIH07XG4gICAgdC5wcm90b3R5cGUuZ2V0T2xkU2F2ZVRpbGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdCA9IHRoaXMuZ2V0TG9jYWxKaWdEYXRhKCkudGlsZXM7XG4gICAgICAgIHJldHVybiBudWxsID09IHQgPyBbXSA6IHQ7XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5zZXRPbGRTYXZlVGlsZXMgPSBmdW5jdGlvbiAodCkge1xuICAgICAgICB0aGlzLnNldExvY2FsSmlnRGF0YSh7dGlsZXM6IHR9KTtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLnNldExvY2FsSmlnRGF0YSA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHZhciBlID0gdGhpcy5nZXRMb2NhbEppZ0RhdGEoKTtcbiAgICAgICAgdGhpcy5sb2NhbERhdGEgPSBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIGUpLCB0KTtcbiAgICAgICAgX2lkeC5wbGF0Zm9ybS5zZXRTdG9yYWdlKFwiamlnc2F3RGF0YVwiLCB0aGlzLmxvY2FsRGF0YSk7XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5nZXRMb2NhbEppZ0RhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG51bGwgPT0gdGhpcy5sb2NhbERhdGEgJiYgKHRoaXMubG9jYWxEYXRhID0gX2lkeC5wbGF0Zm9ybS5nZXRTdG9yYWdlKFwiamlnc2F3RGF0YVwiKSB8fCB7fSk7XG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsRGF0YTtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLmNoZWNrQ2xlYXJEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfcEluZm8uZGVmYXVsdC5pbnMuZ2V0SXNDbGVhckppZ3Nhd0RhdGEoKSAmJlxuICAgICAgICAgICAgKF9wSW5mby5kZWZhdWx0Lmlucy5zZXRJc0NsZWFySmlnc2F3RGF0YSghMSksIHRoaXMuY2xlYXJKaWdzYXdEYXRhKCkpO1xuICAgIH07XG4gICAgdC5wcm90b3R5cGUuY2xlYXJKaWdzYXdEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmxvY2FsRGF0YSA9IHt9O1xuICAgICAgICBfaWR4LnBsYXRmb3JtLnNldFN0b3JhZ2UoXCJqaWdzYXdEYXRhXCIsIHRoaXMubG9jYWxEYXRhKTtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLmNoZWNrU2V0RmluID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5jaGVja0hhc0Zpbih0KSB8fCB0aGlzLnNldEZpbmZpc2hKaWdzYXcodCk7XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5jaGVja0hhc0ZpbiA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHJldHVybiBfcEluZm8uZGVmYXVsdC5pbnMuZ2V0SGFzRmluSmlnKClbdF0gfHwgITE7XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5zZXRGaW5maXNoSmlnc2F3ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdmFyIGUgPSBfcEluZm8uZGVmYXVsdC5pbnMuZ2V0SGFzRmluSmlnKCk7XG4gICAgICAgIGVbdF0gPSAhMDtcbiAgICAgICAgX3BJbmZvLmRlZmF1bHQuaW5zLnNldEhhc0ZpbkppZyhlKTtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLmNsZWFyRmluSmlnID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdmFyIGUgPSBfcEluZm8uZGVmYXVsdC5pbnMuZ2V0SGFzRmluSmlnKCk7XG4gICAgICAgIGVbdF0gPSAhMTtcbiAgICAgICAgX3BJbmZvLmRlZmF1bHQuaW5zLnNldEhhc0ZpbkppZyhlKTtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLnJlc2V0SmlnQnlJZHggPSBmdW5jdGlvbiAodCkge1xuICAgICAgICBmb3IgKHZhciBlID0gdGhpcy5nZXRKaWdzYXdUaWxlc0J5SWR4KHQpLCBvID0gW10sIG4gPSAwLCBpID0gZS5sZW5ndGg7IG4gPCBpOyBuKyspIHtcbiAgICAgICAgICAgIHZhciByID0gZVtuXTtcbiAgICAgICAgICAgIHJbMV0gPSAtMTtcbiAgICAgICAgICAgIG8ucHVzaChyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldEppZ3Nhd1RpbGVzQnlJZHgodCwgbywgITEpO1xuICAgICAgICB0aGlzLmNsZWFyRmluSmlnKHQpO1xuICAgIH07XG4gICAgcmV0dXJuIHQ7XG59KSgpO1xuZXhwb3J0cy5kZWZhdWx0ID0gcztcbiJdfQ==