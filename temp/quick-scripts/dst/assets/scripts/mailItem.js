
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/mailItem.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'df858t+SihDvZmIzPrVMWvv', 'mailItem');
// scripts/mailItem.js

"use strict";

var n;
Object.defineProperty(exports, "__esModule", {
  value: !0
});

var _time = require("time");

var _mailMgr = require("mailMgr");

var _panelMgr = require("panelMgr");

var l = cc._decorator;
var u = l.ccclass;
var p = l.property;

var d = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.title = null;
    e.content = null;
    e.leftT = null;
    e.goNode = null;
    e.mailSpf = [];
    e.newNode = null;
    e.qNode = null;
    e.rewardedNode = null;
    e.icon = null;
    e.timeBg = null;
    return e;
  }

  __extends(e, t);

  e.prototype.init = function (t, e) {
    this.id = t;
    var o = _mailMgr["default"].ins.serverMail[t];

    if (o) {
      var n = o.title;
      n.length > 8 && (n = n.substring(0, 7) + "...");
      this.title.string = n;
      var i = o.msg;
      i.length > 9 && (i = i.substring(0, 8) + "...");
      this.content.string = i;
      this.temple = o;
      this.updateState(e);
      this.undateTime();
      this.schedule(this.undateTime, 1, cc.macro.REPEAT_FOREVER);
    }
  };

  e.prototype.updateState = function (t) {
    this.state = t;
    t == _mailMgr.mailState.award ? this.icon.spriteFrame = this.mailSpf[1] : this.icon.spriteFrame = this.mailSpf[0];
    this.rewardedNode.active = t == _mailMgr.mailState.award;
    this.newNode.active = t == _mailMgr.mailState.noRead;
  };

  e.prototype.onOperTap = function (t) {
    null == t || t.action;
  };

  e.prototype.undateTime = function () {
    if (this.temple.end_time) {
      var t = this.temple.end_time / 1e3 - _time["default"].ins.serverTime;
      t < 0 ? this.unschedule(this.undateTime) : (this.leftT.string = "剩余" + _time["default"].formatDate2Str(t), this.leftT._forceUpdateRenderData(!0), this.timeBg.node.width = this.leftT.node.width + 20);
    }
  };

  e.prototype.onEnable = function () {
    this.goNode.on("click", this.showMailInfo, this);
  };

  e.prototype.onDisable = function () {
    this.goNode.off("click", this.showMailInfo, this);
    this.unschedule(this.undateTime);
  };

  e.prototype.showMailInfo = function () {
    _mailMgr["default"].ins.serverMail[this.id] && _panelMgr["default"].ins.open("ui/ui_mailInfo", {
      id: this.id
    });
  };

  __decorate([p(cc.Label)], e.prototype, "title", void 0);

  __decorate([p(cc.Label)], e.prototype, "content", void 0);

  __decorate([p(cc.Label)], e.prototype, "leftT", void 0);

  __decorate([p(cc.Node)], e.prototype, "goNode", void 0);

  __decorate([p(cc.SpriteFrame)], e.prototype, "mailSpf", void 0);

  __decorate([p(cc.Node)], e.prototype, "newNode", void 0);

  __decorate([p(cc.Node)], e.prototype, "qNode", void 0);

  __decorate([p(cc.Node)], e.prototype, "rewardedNode", void 0);

  __decorate([p(cc.Sprite)], e.prototype, "icon", void 0);

  __decorate([p(cc.Sprite)], e.prototype, "timeBg", void 0);

  return __decorate([u], e);
}(cc.Component);

exports["default"] = d;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcbWFpbEl0ZW0uanMiXSwibmFtZXMiOlsibiIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiX3RpbWUiLCJyZXF1aXJlIiwiX21haWxNZ3IiLCJfcGFuZWxNZ3IiLCJsIiwiY2MiLCJfZGVjb3JhdG9yIiwidSIsImNjY2xhc3MiLCJwIiwicHJvcGVydHkiLCJkIiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsInRpdGxlIiwiY29udGVudCIsImxlZnRUIiwiZ29Ob2RlIiwibWFpbFNwZiIsIm5ld05vZGUiLCJxTm9kZSIsInJld2FyZGVkTm9kZSIsImljb24iLCJ0aW1lQmciLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJpbml0IiwiaWQiLCJvIiwiaW5zIiwic2VydmVyTWFpbCIsImxlbmd0aCIsInN1YnN0cmluZyIsInN0cmluZyIsImkiLCJtc2ciLCJ0ZW1wbGUiLCJ1cGRhdGVTdGF0ZSIsInVuZGF0ZVRpbWUiLCJzY2hlZHVsZSIsIm1hY3JvIiwiUkVQRUFUX0ZPUkVWRVIiLCJzdGF0ZSIsIm1haWxTdGF0ZSIsImF3YXJkIiwic3ByaXRlRnJhbWUiLCJhY3RpdmUiLCJub1JlYWQiLCJvbk9wZXJUYXAiLCJhY3Rpb24iLCJlbmRfdGltZSIsInNlcnZlclRpbWUiLCJ1bnNjaGVkdWxlIiwiZm9ybWF0RGF0ZTJTdHIiLCJfZm9yY2VVcGRhdGVSZW5kZXJEYXRhIiwibm9kZSIsIndpZHRoIiwib25FbmFibGUiLCJvbiIsInNob3dNYWlsSW5mbyIsIm9uRGlzYWJsZSIsIm9mZiIsIm9wZW4iLCJfX2RlY29yYXRlIiwiTGFiZWwiLCJOb2RlIiwiU3ByaXRlRnJhbWUiLCJTcHJpdGUiLCJDb21wb25lbnQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBSjtBQUNBQyxNQUFNLENBQUNDLGNBQVAsQ0FBc0JDLE9BQXRCLEVBQStCLFlBQS9CLEVBQTZDO0VBQUND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b3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7dmFsdWU6ICEwfSk7XG52YXIgX3RpbWUgPSByZXF1aXJlKFwidGltZVwiKTtcbnZhciBfbWFpbE1nciA9IHJlcXVpcmUoXCJtYWlsTWdyXCIpO1xudmFyIF9wYW5lbE1nciA9IHJlcXVpcmUoXCJwYW5lbE1nclwiKTtcbnZhciBsID0gY2MuX2RlY29yYXRvcjtcbnZhciB1ID0gbC5jY2NsYXNzO1xudmFyIHAgPSBsLnByb3BlcnR5O1xudmFyIGQgPSAoZnVuY3Rpb24gKHQpIHtcbiAgICBmdW5jdGlvbiBlKCkge1xuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcbiAgICAgICAgZS50aXRsZSA9IG51bGw7XG4gICAgICAgIGUuY29udGVudCA9IG51bGw7XG4gICAgICAgIGUubGVmdFQgPSBudWxsO1xuICAgICAgICBlLmdvTm9kZSA9IG51bGw7XG4gICAgICAgIGUubWFpbFNwZiA9IFtdO1xuICAgICAgICBlLm5ld05vZGUgPSBudWxsO1xuICAgICAgICBlLnFOb2RlID0gbnVsbDtcbiAgICAgICAgZS5yZXdhcmRlZE5vZGUgPSBudWxsO1xuICAgICAgICBlLmljb24gPSBudWxsO1xuICAgICAgICBlLnRpbWVCZyA9IG51bGw7XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICBfX2V4dGVuZHMoZSwgdCk7XG4gICAgZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICAgIHRoaXMuaWQgPSB0O1xuICAgICAgICB2YXIgbyA9IF9tYWlsTWdyLmRlZmF1bHQuaW5zLnNlcnZlck1haWxbdF07XG4gICAgICAgIGlmIChvKSB7XG4gICAgICAgICAgICB2YXIgbiA9IG8udGl0bGU7XG4gICAgICAgICAgICBuLmxlbmd0aCA+IDggJiYgKG4gPSBuLnN1YnN0cmluZygwLCA3KSArIFwiLi4uXCIpO1xuICAgICAgICAgICAgdGhpcy50aXRsZS5zdHJpbmcgPSBuO1xuICAgICAgICAgICAgdmFyIGkgPSBvLm1zZztcbiAgICAgICAgICAgIGkubGVuZ3RoID4gOSAmJiAoaSA9IGkuc3Vic3RyaW5nKDAsIDgpICsgXCIuLi5cIik7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQuc3RyaW5nID0gaTtcbiAgICAgICAgICAgIHRoaXMudGVtcGxlID0gbztcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdGUoZSk7XG4gICAgICAgICAgICB0aGlzLnVuZGF0ZVRpbWUoKTtcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGUodGhpcy51bmRhdGVUaW1lLCAxLCBjYy5tYWNyby5SRVBFQVRfRk9SRVZFUik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGUucHJvdG90eXBlLnVwZGF0ZVN0YXRlID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHQ7XG4gICAgICAgIHQgPT0gX21haWxNZ3IubWFpbFN0YXRlLmF3YXJkXG4gICAgICAgICAgICA/ICh0aGlzLmljb24uc3ByaXRlRnJhbWUgPSB0aGlzLm1haWxTcGZbMV0pXG4gICAgICAgICAgICA6ICh0aGlzLmljb24uc3ByaXRlRnJhbWUgPSB0aGlzLm1haWxTcGZbMF0pO1xuICAgICAgICB0aGlzLnJld2FyZGVkTm9kZS5hY3RpdmUgPSB0ID09IF9tYWlsTWdyLm1haWxTdGF0ZS5hd2FyZDtcbiAgICAgICAgdGhpcy5uZXdOb2RlLmFjdGl2ZSA9IHQgPT0gX21haWxNZ3IubWFpbFN0YXRlLm5vUmVhZDtcbiAgICB9O1xuICAgIGUucHJvdG90eXBlLm9uT3BlclRhcCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIG51bGwgPT0gdCB8fCB0LmFjdGlvbjtcbiAgICB9O1xuICAgIGUucHJvdG90eXBlLnVuZGF0ZVRpbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnRlbXBsZS5lbmRfdGltZSkge1xuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLnRlbXBsZS5lbmRfdGltZSAvIDFlMyAtIF90aW1lLmRlZmF1bHQuaW5zLnNlcnZlclRpbWU7XG4gICAgICAgICAgICB0IDwgMFxuICAgICAgICAgICAgICAgID8gdGhpcy51bnNjaGVkdWxlKHRoaXMudW5kYXRlVGltZSlcbiAgICAgICAgICAgICAgICA6ICgodGhpcy5sZWZ0VC5zdHJpbmcgPSBcIuWJqeS9mVwiICsgX3RpbWUuZGVmYXVsdC5mb3JtYXREYXRlMlN0cih0KSksXG4gICAgICAgICAgICAgICAgICB0aGlzLmxlZnRULl9mb3JjZVVwZGF0ZVJlbmRlckRhdGEoITApLFxuICAgICAgICAgICAgICAgICAgKHRoaXMudGltZUJnLm5vZGUud2lkdGggPSB0aGlzLmxlZnRULm5vZGUud2lkdGggKyAyMCkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBlLnByb3RvdHlwZS5vbkVuYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5nb05vZGUub24oXCJjbGlja1wiLCB0aGlzLnNob3dNYWlsSW5mbywgdGhpcyk7XG4gICAgfTtcbiAgICBlLnByb3RvdHlwZS5vbkRpc2FibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZ29Ob2RlLm9mZihcImNsaWNrXCIsIHRoaXMuc2hvd01haWxJbmZvLCB0aGlzKTtcbiAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMudW5kYXRlVGltZSk7XG4gICAgfTtcbiAgICBlLnByb3RvdHlwZS5zaG93TWFpbEluZm8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9tYWlsTWdyLmRlZmF1bHQuaW5zLnNlcnZlck1haWxbdGhpcy5pZF0gJiYgX3BhbmVsTWdyLmRlZmF1bHQuaW5zLm9wZW4oXCJ1aS91aV9tYWlsSW5mb1wiLCB7aWQ6IHRoaXMuaWR9KTtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW3AoY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwidGl0bGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtwKGNjLkxhYmVsKV0sIGUucHJvdG90eXBlLCBcImNvbnRlbnRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtwKGNjLkxhYmVsKV0sIGUucHJvdG90eXBlLCBcImxlZnRUXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbcChjYy5Ob2RlKV0sIGUucHJvdG90eXBlLCBcImdvTm9kZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW3AoY2MuU3ByaXRlRnJhbWUpXSwgZS5wcm90b3R5cGUsIFwibWFpbFNwZlwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW3AoY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJuZXdOb2RlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbcChjYy5Ob2RlKV0sIGUucHJvdG90eXBlLCBcInFOb2RlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbcChjYy5Ob2RlKV0sIGUucHJvdG90eXBlLCBcInJld2FyZGVkTm9kZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW3AoY2MuU3ByaXRlKV0sIGUucHJvdG90eXBlLCBcImljb25cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtwKGNjLlNwcml0ZSldLCBlLnByb3RvdHlwZSwgXCJ0aW1lQmdcIiwgdm9pZCAwKTtcbiAgICByZXR1cm4gX19kZWNvcmF0ZShbdV0sIGUpO1xufSkoY2MuQ29tcG9uZW50KTtcbmV4cG9ydHMuZGVmYXVsdCA9IGQ7XG4iXX0=