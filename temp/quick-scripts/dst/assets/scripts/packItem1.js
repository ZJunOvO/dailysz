
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/packItem1.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '55c3ekMcB9Er61q37vHGQCP', 'packItem1');
// scripts/packItem1.js

"use strict";

var n;
Object.defineProperty(exports, "__esModule", {
  value: !0
});

var _idx = require("idx");

var _item = require("item");

var _bagMgr = require("bagMgr");

var _panelMgr = require("panelMgr");

var _shopMgr = require("shopMgr");

var _tipMgr = require("tipMgr");

var _pInfo = require("pInfo");

var h = cc._decorator;
var f = h.ccclass;
var g = h.property;

var y = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.packName = null;
    e.scrollView = null;
    e.priceLb = null;
    e.rewardItem = null;
    e.finNode = null;
    e.btnNode = null;
    e.adNode = null;
    e.buyNumLb = null;
    e.redNode = null;
    e.discountLb = null;
    e.shopData = null;
    e.isFree = !1;
    e._rewardItems = [];
    return e;
  }

  __extends(e, t);

  e.prototype.onLoad = function () {};

  e.prototype.initItem = function (t) {
    this.shopData = t;
    this.packName.string = (null == t ? void 0 : t.title) || "礼包";
    var e = t.price || 0;
    this.priceLb.string = "¥" + t.price;
    this.isFree = 0 == e;

    var o = _shopMgr["default"].ins.getPackRed();

    o[t.key] ? this.redNode.active = !1 : (this.redNode.active = !0, o[t.key] = 1, _shopMgr["default"].ins.setPackRed(o));
    t.discount ? (this.discountLb.string = t.discount + "折", this.discountLb.node.parent.active = !0) : this.discountLb.node.parent.active = !1;
    this.initReward(t.props);
    this.checkData();
  };

  e.prototype.initReward = function (t) {
    var e = this;

    if (t) {
      var o = 0;
      var n = this.scrollView.content;

      for (var i in n.children.forEach(function (t) {
        e._rewardItems.push(t);
      }), n.removeAllChildren(), t) {
        var r = t[i];

        var a = this._rewardItems.shift();

        a || (a = cc.instantiate(this.rewardItem));
        a.parent = n;
        a.active = !0;
        var c = a.getComponent(_item["default"]);
        c && c.initByData(i, r);
        o++;
      }

      n.setContentSize(93 * o, 100);
    }
  };

  e.prototype.checkData = function () {
    if (this.shopData) {
      var t = this.shopData.key;

      var e = _pInfo["default"].ins.getShopRecord();

      var o = this.shopData.daily_limit_nums || 0;
      var n = e[t] || 0;
      this.btnNode.active = !this.isFree;
      this.adNode.active = this.isFree;
      var i = this.isFree ? this.adNode : this.btnNode;
      var r = n >= o;
      this.finNode.active = r;
      i.active = !r;
      this.buyNumLb.node.active = !r;
      this.buyNumLb.string = "限购:" + n + "/" + o;
    }
  };

  e.prototype.onBtnBuy = function () {
    var t = this;

    if (this.shopData) {
      var e = JSON.stringify(this.shopData.props);

      _idx.platform.payment(this.shopData.key, this.shopData.price, 0, e).then(function () {
        t.getReward();
      })["catch"](function (t) {
        _tipMgr["default"].ins.showTip(t, !0);
      });
    }
  };

  e.prototype.onBtnAd = function () {
    this.shopData && this.getReward();
  };

  e.prototype.getReward = function () {
    var t = this.shopData.props;

    for (var e in t) {
      var o = t[e];

      _bagMgr["default"].ins.addItem(e, o);
    }

    for (var n = this.scrollView.content.children, i = [], r = 0, a = n.length; r < a; r++) {
      var u = n[r];
      var p = u.getComponent(_item["default"]);
      var h = {};
      h.itemId = p.key;
      h.worldPos = u.parent.convertToWorldSpaceAR(u.position);
      h.value = Number(p.count);
      i.push(h);
    }

    _panelMgr["default"].ins.open("ui/ui_flyAni", {
      itemDatas: i
    });

    _pInfo["default"].ins.addShopRecord(this.shopData.key);

    this.checkData();
  };

  __decorate([g(cc.Label)], e.prototype, "packName", void 0);

  __decorate([g(cc.ScrollView)], e.prototype, "scrollView", void 0);

  __decorate([g(cc.Label)], e.prototype, "priceLb", void 0);

  __decorate([g(cc.Node)], e.prototype, "rewardItem", void 0);

  __decorate([g(cc.Node)], e.prototype, "finNode", void 0);

  __decorate([g(cc.Node)], e.prototype, "btnNode", void 0);

  __decorate([g(cc.Node)], e.prototype, "adNode", void 0);

  __decorate([g(cc.Label)], e.prototype, "buyNumLb", void 0);

  __decorate([g(cc.Node)], e.prototype, "redNode", void 0);

  __decorate([g(cc.Label)], e.prototype, "discountLb", void 0);

  return __decorate([f], e);
}(cc.Component);

exports["default"] = y;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xccGFja0l0ZW0xLmpzIl0sIm5hbWVzIjpbIm4iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsIl9pZHgiLCJyZXF1aXJlIiwiX2l0ZW0iLCJfYmFnTWdyIiwiX3BhbmVsTWdyIiwiX3Nob3BNZ3IiLCJfdGlwTWdyIiwiX3BJbmZvIiwiaCIsImNjIiwiX2RlY29yYXRvciIsImYiLCJjY2NsYXNzIiwiZyIsInByb3BlcnR5IiwieSIsInQiLCJlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJwYWNrTmFtZSIsInNjcm9sbFZpZXciLCJwcmljZUxiIiwicmV3YXJkSXRlbSIsImZpbk5vZGUiLCJidG5Ob2RlIiwiYWROb2RlIiwiYnV5TnVtTGIiLCJyZWROb2RlIiwiZGlzY291bnRMYiIsInNob3BEYXRhIiwiaXNGcmVlIiwiX3Jld2FyZEl0ZW1zIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwib25Mb2FkIiwiaW5pdEl0ZW0iLCJzdHJpbmciLCJ0aXRsZSIsInByaWNlIiwibyIsImlucyIsImdldFBhY2tSZWQiLCJrZXkiLCJhY3RpdmUiLCJzZXRQYWNrUmVkIiwiZGlzY291bnQiLCJub2RlIiwicGFyZW50IiwiaW5pdFJld2FyZCIsInByb3BzIiwiY2hlY2tEYXRhIiwiY29udGVudCIsImkiLCJjaGlsZHJlbiIsImZvckVhY2giLCJwdXNoIiwicmVtb3ZlQWxsQ2hpbGRyZW4iLCJyIiwiYSIsInNoaWZ0IiwiaW5zdGFudGlhdGUiLCJjIiwiZ2V0Q29tcG9uZW50IiwiaW5pdEJ5RGF0YSIsInNldENvbnRlbnRTaXplIiwiZ2V0U2hvcFJlY29yZCIsImRhaWx5X2xpbWl0X251bXMiLCJvbkJ0bkJ1eSIsIkpTT04iLCJzdHJpbmdpZnkiLCJwbGF0Zm9ybSIsInBheW1lbnQiLCJ0aGVuIiwiZ2V0UmV3YXJkIiwic2hvd1RpcCIsIm9uQnRuQWQiLCJhZGRJdGVtIiwibGVuZ3RoIiwidSIsInAiLCJpdGVtSWQiLCJ3b3JsZFBvcyIsImNvbnZlcnRUb1dvcmxkU3BhY2VBUiIsInBvc2l0aW9uIiwiTnVtYmVyIiwiY291bnQiLCJvcGVuIiwiaXRlbURhdGFzIiwiYWRkU2hvcFJlY29yZCIsIl9fZGVjb3JhdGUiLCJMYWJlbCIsIlNjcm9sbFZpZXciLCJOb2RlIiwiQ29tcG9uZW50Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7QUFDQUMsTUFBTSxDQUFDQyxjQUFQLENBQXNCQyxPQUF0QixFQUErQixZQUEvQixFQUE2QztFQUFDQyxLQUFLLEVBQUUsQ0FBQztBQUFULENBQTdDOztBQUNBLElBQUlDLElBQUksR0FBR0MsT0FBTyxDQUFDLEtBQUQsQ0FBbEI7O0FBQ0EsSUFBSUMsS0FBSyxHQUFHRCxPQUFPLENBQUMsTUFBRCxDQUFuQjs7QUFDQSxJQUFJRSxPQUFPLEdBQUdGLE9BQU8sQ0FBQyxRQUFELENBQXJCOztBQUNBLElBQUlHLFNBQVMsR0FBR0gsT0FBTyxDQUFDLFVBQUQsQ0FBdkI7O0FBQ0EsSUFBSUksUUFBUSxHQUFHSixPQUFPLENBQUMsU0FBRCxDQUF0Qjs7QUFDQSxJQUFJSyxPQUFPLEdBQUdMLE9BQU8sQ0FBQyxRQUFELENBQXJCOztBQUNBLElBQUlNLE1BQU0sR0FBR04sT0FBTyxDQUFDLE9BQUQsQ0FBcEI7O0FBQ0EsSUFBSU8sQ0FBQyxHQUFHQyxFQUFFLENBQUNDLFVBQVg7QUFDQSxJQUFJQyxDQUFDLEdBQUdILENBQUMsQ0FBQ0ksT0FBVjtBQUNBLElBQUlDLENBQUMsR0FBR0wsQ0FBQyxDQUFDTSxRQUFWOztBQUNBLElBQUlDLENBQUMsR0FBSSxVQUFVQyxDQUFWLEVBQWE7RUFDbEIsU0FBU0MsQ0FBVCxHQUFhO0lBQ1QsSUFBSUEsQ0FBQyxHQUFJLFNBQVNELENBQVQsSUFBY0EsQ0FBQyxDQUFDRSxLQUFGLENBQVEsSUFBUixFQUFjQyxTQUFkLENBQWYsSUFBNEMsSUFBcEQ7SUFDQUYsQ0FBQyxDQUFDRyxRQUFGLEdBQWEsSUFBYjtJQUNBSCxDQUFD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LENBQUNvRixJQUFKLENBQUYsQ0FBRCxFQUFlNUUsQ0FBQyxDQUFDaUIsU0FBakIsRUFBNEIsUUFBNUIsRUFBc0MsS0FBSyxDQUEzQyxDQUFWOztFQUNBd0QsVUFBVSxDQUFDLENBQUM3RSxDQUFDLENBQUNKLEVBQUUsQ0FBQ2tGLEtBQUosQ0FBRixDQUFELEVBQWdCMUUsQ0FBQyxDQUFDaUIsU0FBbEIsRUFBNkIsVUFBN0IsRUFBeUMsS0FBSyxDQUE5QyxDQUFWOztFQUNBd0QsVUFBVSxDQUFDLENBQUM3RSxDQUFDLENBQUNKLEVBQUUsQ0FBQ29GLElBQUosQ0FBRixDQUFELEVBQWU1RSxDQUFDLENBQUNpQixTQUFqQixFQUE0QixTQUE1QixFQUF1QyxLQUFLLENBQTVDLENBQVY7O0VBQ0F3RCxVQUFVLENBQUMsQ0FBQzdFLENBQUMsQ0FBQ0osRUFBRSxDQUFDa0YsS0FBSixDQUFGLENBQUQsRUFBZ0IxRSxDQUFDLENBQUNpQixTQUFsQixFQUE2QixZQUE3QixFQUEyQyxLQUFLLENBQWhELENBQVY7O0VBQ0EsT0FBT3dELFVBQVUsQ0FBQyxDQUFDL0UsQ0FBRCxDQUFELEVBQU1NLENBQU4sQ0FBakI7QUFDSCxDQXpITyxDQXlITFIsRUFBRSxDQUFDcUYsU0F6SEUsQ0FBUjs7QUEwSEFoRyxPQUFPLFdBQVAsR0FBa0JpQixDQUFsQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG47XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHt2YWx1ZTogITB9KTtcbnZhciBfaWR4ID0gcmVxdWlyZShcImlkeFwiKTtcbnZhciBfaXRlbSA9IHJlcXVpcmUoXCJpdGVtXCIpO1xudmFyIF9iYWdNZ3IgPSByZXF1aXJlKFwiYmFnTWdyXCIpO1xudmFyIF9wYW5lbE1nciA9IHJlcXVpcmUoXCJwYW5lbE1nclwiKTtcbnZhciBfc2hvcE1nciA9IHJlcXVpcmUoXCJzaG9wTWdyXCIpO1xudmFyIF90aXBNZ3IgPSByZXF1aXJlKFwidGlwTWdyXCIpO1xudmFyIF9wSW5mbyA9IHJlcXVpcmUoXCJwSW5mb1wiKTtcbnZhciBoID0gY2MuX2RlY29yYXRvcjtcbnZhciBmID0gaC5jY2NsYXNzO1xudmFyIGcgPSBoLnByb3BlcnR5O1xudmFyIHkgPSAoZnVuY3Rpb24gKHQpIHtcbiAgICBmdW5jdGlvbiBlKCkge1xuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcbiAgICAgICAgZS5wYWNrTmFtZSA9IG51bGw7XG4gICAgICAgIGUuc2Nyb2xsVmlldyA9IG51bGw7XG4gICAgICAgIGUucHJpY2VMYiA9IG51bGw7XG4gICAgICAgIGUucmV3YXJkSXRlbSA9IG51bGw7XG4gICAgICAgIGUuZmluTm9kZSA9IG51bGw7XG4gICAgICAgIGUuYnRuTm9kZSA9IG51bGw7XG4gICAgICAgIGUuYWROb2RlID0gbnVsbDtcbiAgICAgICAgZS5idXlOdW1MYiA9IG51bGw7XG4gICAgICAgIGUucmVkTm9kZSA9IG51bGw7XG4gICAgICAgIGUuZGlzY291bnRMYiA9IG51bGw7XG4gICAgICAgIGUuc2hvcERhdGEgPSBudWxsO1xuICAgICAgICBlLmlzRnJlZSA9ICExO1xuICAgICAgICBlLl9yZXdhcmRJdGVtcyA9IFtdO1xuICAgICAgICByZXR1cm4gZTtcbiAgICB9XG4gICAgX19leHRlbmRzKGUsIHQpO1xuICAgIGUucHJvdG90eXBlLm9uTG9hZCA9IGZ1bmN0aW9uICgpIHt9O1xuICAgIGUucHJvdG90eXBlLmluaXRJdGVtID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdGhpcy5zaG9wRGF0YSA9IHQ7XG4gICAgICAgIHRoaXMucGFja05hbWUuc3RyaW5nID0gKG51bGwgPT0gdCA/IHZvaWQgMCA6IHQudGl0bGUpIHx8IFwi56S85YyFXCI7XG4gICAgICAgIHZhciBlID0gdC5wcmljZSB8fCAwO1xuICAgICAgICB0aGlzLnByaWNlTGIuc3RyaW5nID0gXCLCpVwiICsgdC5wcmljZTtcbiAgICAgICAgdGhpcy5pc0ZyZWUgPSAwID09IGU7XG4gICAgICAgIHZhciBvID0gX3Nob3BNZ3IuZGVmYXVsdC5pbnMuZ2V0UGFja1JlZCgpO1xuICAgICAgICBvW3Qua2V5XVxuICAgICAgICAgICAgPyAodGhpcy5yZWROb2RlLmFjdGl2ZSA9ICExKVxuICAgICAgICAgICAgOiAoKHRoaXMucmVkTm9kZS5hY3RpdmUgPSAhMCksIChvW3Qua2V5XSA9IDEpLCBfc2hvcE1nci5kZWZhdWx0Lmlucy5zZXRQYWNrUmVkKG8pKTtcbiAgICAgICAgdC5kaXNjb3VudFxuICAgICAgICAgICAgPyAoKHRoaXMuZGlzY291bnRMYi5zdHJpbmcgPSB0LmRpc2NvdW50ICsgXCLmiphcIiksICh0aGlzLmRpc2NvdW50TGIubm9kZS5wYXJlbnQuYWN0aXZlID0gITApKVxuICAgICAgICAgICAgOiAodGhpcy5kaXNjb3VudExiLm5vZGUucGFyZW50LmFjdGl2ZSA9ICExKTtcbiAgICAgICAgdGhpcy5pbml0UmV3YXJkKHQucHJvcHMpO1xuICAgICAgICB0aGlzLmNoZWNrRGF0YSgpO1xuICAgIH07XG4gICAgZS5wcm90b3R5cGUuaW5pdFJld2FyZCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHZhciBlID0gdGhpcztcbiAgICAgICAgaWYgKHQpIHtcbiAgICAgICAgICAgIHZhciBvID0gMDtcbiAgICAgICAgICAgIHZhciBuID0gdGhpcy5zY3JvbGxWaWV3LmNvbnRlbnQ7XG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIChuLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgICAgICBlLl9yZXdhcmRJdGVtcy5wdXNoKHQpO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBuLnJlbW92ZUFsbENoaWxkcmVuKCksXG4gICAgICAgICAgICB0KSkge1xuICAgICAgICAgICAgICAgIHZhciByID0gdFtpXTtcbiAgICAgICAgICAgICAgICB2YXIgYSA9IHRoaXMuX3Jld2FyZEl0ZW1zLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgYSB8fCAoYSA9IGNjLmluc3RhbnRpYXRlKHRoaXMucmV3YXJkSXRlbSkpO1xuICAgICAgICAgICAgICAgIGEucGFyZW50ID0gbjtcbiAgICAgICAgICAgICAgICBhLmFjdGl2ZSA9ICEwO1xuICAgICAgICAgICAgICAgIHZhciBjID0gYS5nZXRDb21wb25lbnQoX2l0ZW0uZGVmYXVsdCk7XG4gICAgICAgICAgICAgICAgYyAmJiBjLmluaXRCeURhdGEoaSwgcik7XG4gICAgICAgICAgICAgICAgbysrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbi5zZXRDb250ZW50U2l6ZSg5MyAqIG8sIDEwMCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGUucHJvdG90eXBlLmNoZWNrRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuc2hvcERhdGEpIHtcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcy5zaG9wRGF0YS5rZXk7XG4gICAgICAgICAgICB2YXIgZSA9IF9wSW5mby5kZWZhdWx0Lmlucy5nZXRTaG9wUmVjb3JkKCk7XG4gICAgICAgICAgICB2YXIgbyA9IHRoaXMuc2hvcERhdGEuZGFpbHlfbGltaXRfbnVtcyB8fCAwO1xuICAgICAgICAgICAgdmFyIG4gPSBlW3RdIHx8IDA7XG4gICAgICAgICAgICB0aGlzLmJ0bk5vZGUuYWN0aXZlID0gIXRoaXMuaXNGcmVlO1xuICAgICAgICAgICAgdGhpcy5hZE5vZGUuYWN0aXZlID0gdGhpcy5pc0ZyZWU7XG4gICAgICAgICAgICB2YXIgaSA9IHRoaXMuaXNGcmVlID8gdGhpcy5hZE5vZGUgOiB0aGlzLmJ0bk5vZGU7XG4gICAgICAgICAgICB2YXIgciA9IG4gPj0gbztcbiAgICAgICAgICAgIHRoaXMuZmluTm9kZS5hY3RpdmUgPSByO1xuICAgICAgICAgICAgaS5hY3RpdmUgPSAhcjtcbiAgICAgICAgICAgIHRoaXMuYnV5TnVtTGIubm9kZS5hY3RpdmUgPSAhcjtcbiAgICAgICAgICAgIHRoaXMuYnV5TnVtTGIuc3RyaW5nID0gXCLpmZDotK06XCIgKyBuICsgXCIvXCIgKyBvO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBlLnByb3RvdHlwZS5vbkJ0bkJ1eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5zaG9wRGF0YSkge1xuICAgICAgICAgICAgdmFyIGUgPSBKU09OLnN0cmluZ2lmeSh0aGlzLnNob3BEYXRhLnByb3BzKTtcbiAgICAgICAgICAgIF9pZHgucGxhdGZvcm1cbiAgICAgICAgICAgICAgICAucGF5bWVudCh0aGlzLnNob3BEYXRhLmtleSwgdGhpcy5zaG9wRGF0YS5wcmljZSwgMCwgZSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHQuZ2V0UmV3YXJkKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RpcE1nci5kZWZhdWx0Lmlucy5zaG93VGlwKHQsICEwKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgZS5wcm90b3R5cGUub25CdG5BZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zaG9wRGF0YSAmJiB0aGlzLmdldFJld2FyZCgpO1xuICAgIH07XG4gICAgZS5wcm90b3R5cGUuZ2V0UmV3YXJkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdCA9IHRoaXMuc2hvcERhdGEucHJvcHM7XG4gICAgICAgIGZvciAodmFyIGUgaW4gdCkge1xuICAgICAgICAgICAgdmFyIG8gPSB0W2VdO1xuICAgICAgICAgICAgX2JhZ01nci5kZWZhdWx0Lmlucy5hZGRJdGVtKGUsIG8pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIG4gPSB0aGlzLnNjcm9sbFZpZXcuY29udGVudC5jaGlsZHJlbiwgaSA9IFtdLCByID0gMCwgYSA9IG4ubGVuZ3RoOyByIDwgYTsgcisrKSB7XG4gICAgICAgICAgICB2YXIgdSA9IG5bcl07XG4gICAgICAgICAgICB2YXIgcCA9IHUuZ2V0Q29tcG9uZW50KF9pdGVtLmRlZmF1bHQpO1xuICAgICAgICAgICAgdmFyIGggPSB7fTtcbiAgICAgICAgICAgIGguaXRlbUlkID0gcC5rZXk7XG4gICAgICAgICAgICBoLndvcmxkUG9zID0gdS5wYXJlbnQuY29udmVydFRvV29ybGRTcGFjZUFSKHUucG9zaXRpb24pO1xuICAgICAgICAgICAgaC52YWx1ZSA9IE51bWJlcihwLmNvdW50KTtcbiAgICAgICAgICAgIGkucHVzaChoKTtcbiAgICAgICAgfVxuICAgICAgICBfcGFuZWxNZ3IuZGVmYXVsdC5pbnMub3BlbihcInVpL3VpX2ZseUFuaVwiLCB7aXRlbURhdGFzOiBpfSk7XG4gICAgICAgIF9wSW5mby5kZWZhdWx0Lmlucy5hZGRTaG9wUmVjb3JkKHRoaXMuc2hvcERhdGEua2V5KTtcbiAgICAgICAgdGhpcy5jaGVja0RhdGEoKTtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW2coY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwicGFja05hbWVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtnKGNjLlNjcm9sbFZpZXcpXSwgZS5wcm90b3R5cGUsIFwic2Nyb2xsVmlld1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW2coY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwicHJpY2VMYlwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW2coY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJyZXdhcmRJdGVtXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbZyhjYy5Ob2RlKV0sIGUucHJvdG90eXBlLCBcImZpbk5vZGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtnKGNjLk5vZGUpXSwgZS5wcm90b3R5cGUsIFwiYnRuTm9kZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW2coY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJhZE5vZGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtnKGNjLkxhYmVsKV0sIGUucHJvdG90eXBlLCBcImJ1eU51bUxiXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbZyhjYy5Ob2RlKV0sIGUucHJvdG90eXBlLCBcInJlZE5vZGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtnKGNjLkxhYmVsKV0sIGUucHJvdG90eXBlLCBcImRpc2NvdW50TGJcIiwgdm9pZCAwKTtcbiAgICByZXR1cm4gX19kZWNvcmF0ZShbZl0sIGUpO1xufSkoY2MuQ29tcG9uZW50KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHk7XG4iXX0=