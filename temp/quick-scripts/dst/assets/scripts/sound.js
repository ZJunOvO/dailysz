
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/sound.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '9e58fSpOr5KX6wp5ukpL3BX', 'sound');
// scripts/sound.js

"use strict";

Object.defineProperty(exports, "__esModule", {
  value: !0
});

var _pInfo = require("pInfo");

var _c = require("c");

var _evts = require("evts");

var _uData = require("uData");

var l = function () {
  function t() {
    this.isSharing = !1;
    this.isHiding = !1;
    this.delayID = 0;
    this.clips = {};

    _evts["default"].plE.on(function (e) {
      e.onShow ? (t.ins.isHiding = !1, t.ins.onSoundChange()) : e.onHide && (t.ins.isHiding = !0, t.ins.onSoundChange());
    });

    _evts["default"].adE.on(function (e) {
      t.ins.isSharing = e == _c.ADE.SHARE || e == _c.ADE.VIDEO;
      t.ins.onSoundChange();
    });
  }

  Object.defineProperty(t, "ins", {
    get: function get() {
      this._ins || (this._ins = new t());
      return this._ins;
    },
    enumerable: !1,
    configurable: !0
  });
  Object.defineProperty(t.prototype, "bgmVolume", {
    get: function get() {
      void 0 === this._bgmVolume && (this._bgmVolume = _uData["default"].ins.getSetting().bgmVolume);
      return this._bgmVolume;
    },
    set: function set(t) {
      cc.audioEngine.setMusicVolume(t);
      this._bgmVolume = t;
    },
    enumerable: !1,
    configurable: !0
  });
  Object.defineProperty(t.prototype, "effectVolume", {
    get: function get() {
      void 0 === this._effectVolume && (this._effectVolume = _uData["default"].ins.getSetting().effectVolume);
      return this._effectVolume;
    },
    set: function set(t) {
      this._effectVolume = t;
    },
    enumerable: !1,
    configurable: !0
  });

  t.prototype.onSoundChange = function () {
    clearTimeout(this.delayID);
    this.delayID = setTimeout(function () {
      clearTimeout(t.ins.delayID);
      t.ins.delayID = 0;
      t.ins.isSharing || t.ins.isHiding ? t.ins.stopAll() : t.ins.resumeAll();
    }, 100);
  };

  t.prototype.stopAllEffects = function () {
    cc.audioEngine.stopAllEffects();
  };

  t.prototype.resumeAll = function () {
    cc.audioEngine.resumeMusic();
    cc.audioEngine.resumeAllEffects();
  };

  t.prototype.stopAll = function () {
    cc.audioEngine.stopMusic();
    cc.audioEngine.stopAllEffects();
  };

  t.prototype.play = function (t, e) {
    void 0 === e && (e = 0);
    return __awaiter(this, void 0, void 0, function () {
      var o;
      var n;
      var r;
      return __generator(this, function (i) {
        switch (i.label) {
          case 0:
            return !1 !== _uData["default"].ins.getSetting().effectSound && null != t ? [3, 1] : [2];

          case 1:
            return e = Math.max(1, Math.min(0, e)), t instanceof cc.AudioClip ? (o = t, [3, 5]) : [3, 2];

          case 2:
            return null != this.clips[t] ? [3, 4] : (n = this.clips, r = t, [4, new Promise(function (e) {
              cc.assetManager.loadBundle("sound", function (o, n) {
                o ? e(o) : n.load(t, cc.AudioClip, function (t, o) {
                  e(t ? null : o);
                });
              });
            })]);

          case 3:
            return o = n[r] = i.sent(), [3, 5];

          case 4:
            o = this.clips[t], i.label = 5;

          case 5:
            return o ? (cc.audioEngine.playEffect(o, !1), cc.audioEngine.setEffectsVolume(e * this.effectVolume), [2, o.duration]) : [2];

          case 6:
            return [2];
        }
      });
    });
  };

  t.prototype.playBGM = function () {
    return __awaiter(this, void 0, void 0, function () {
      var e;
      var o;
      var n = this;
      return __generator(this, function () {
        return 0 == (e = _uData["default"].ins.getSetting().bgmSound) ? [2] : (o = _pInfo.ROOT == _pInfo.sceneType.game || _pInfo.ROOT == _pInfo.sceneType.guide ? "Game" : "Main", cc.assetManager.loadBundle("sound", function (i, r) {
          i || r.load(t.BGM + o, cc.AudioClip, function (t, i) {
            if (!t) {
              var r = cc.audioEngine;
              n.curBg == o && r.isMusicPlaying() || !e || (n.curBg = o, r.playMusic(i, !0), r.setMusicVolume(n.bgmVolume));
            }
          });
        }), [2]);
      });
    });
  };

  t.prototype.stopBGM = function (t) {
    return __awaiter(this, void 0, void 0, function () {
      return __generator(this, function () {
        return _uData["default"].ins.getSetting().bgmSound && !t ? [2] : (cc.audioEngine.stopMusic(), [2]);
      });
    });
  };

  t.CLICK = "click";
  t.BGM = "BGM";
  t.WIN = "win";
  t.LOSE = "lose";
  t.RIGHT = "right";
  t.ERROR = "error";
  t.SHOVEL = "shovel";
  t.ROCKETLAUNCH = "rocketLaunch";
  t.ROCKETATTACK = "rocketAttack";
  t.TIME = "time";
  t.FINISH_PUZZLE = "finish_puzzle";
  return t;
}();

exports["default"] = l;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcc291bmQuanMiXSwibmFtZXMiOlsiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJfcEluZm8iLCJyZXF1aXJlIiwiX2MiLCJfZXZ0cyIsIl91RGF0YSIsImwiLCJ0IiwiaXNTaGFyaW5nIiwiaXNIaWRpbmciLCJkZWxheUlEIiwiY2xpcHMiLCJwbEUiLCJvbiIsImUiLCJvblNob3ciLCJpbnMiLCJvblNvdW5kQ2hhbmdlIiwib25IaWRlIiwiYWRFIiwiQURFIiwiU0hBUkUiLCJWSURFTyIsImdldCIsIl9pbnMiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwicHJvdG90eXBlIiwiX2JnbVZvbHVtZSIsImdldFNldHRpbmciLCJiZ21Wb2x1bWUiLCJzZXQiLCJjYyIsImF1ZGlvRW5naW5lIiwic2V0TXVzaWNWb2x1bWUiLCJfZWZmZWN0Vm9sdW1lIiwiZWZmZWN0Vm9sdW1lIiwiY2xlYXJUaW1lb3V0Iiwic2V0VGltZW91dCIsInN0b3BBbGwiLCJyZXN1bWVBbGwiLCJzdG9wQWxsRWZmZWN0cyIsInJlc3VtZU11c2ljIiwicmVzdW1lQWxsRWZmZWN0cyIsInN0b3BNdXNpYyIsInBsYXkiLCJfX2F3YWl0ZXIiLCJvIiwibiIsInIiLCJfX2dlbmVyYXRvciIsImkiLCJsYWJlbCIsImVmZmVjdFNvdW5kIiwiTWF0aCIsIm1heCIsIm1pbiIsIkF1ZGlvQ2xpcCIsIlByb21pc2UiLCJhc3NldE1hbmFnZXIiLCJsb2FkQnVuZGxlIiwibG9hZCIsInNlbnQiLCJwbGF5RWZmZWN0Iiwic2V0RWZmZWN0c1ZvbHVtZSIsImR1cmF0aW9uIiwicGxheUJHTSIsImJnbVNvdW5kIiwiUk9PVCIsInNjZW5lVHlwZSIsImdhbWUiLCJndWlkZSIsIkJHTSIsImN1ckJnIiwiaXNNdXNpY1BsYXlpbmciLCJwbGF5TXVzaWMiLCJzdG9wQkdNIiwiQ0xJQ0siLCJXSU4iLCJMT1NFIiwiUklHSFQiLCJFUlJPUiIsIlNI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QUM0RSxZQUFGLEdBQWlCLGNBQWpCO0VBQ0E1RSxDQUFDLENBQUM2RSxZQUFGLEdBQWlCLGNBQWpCO0VBQ0E3RSxDQUFDLENBQUM4RSxJQUFGLEdBQVMsTUFBVDtFQUNBOUUsQ0FBQyxDQUFDK0UsYUFBRixHQUFrQixlQUFsQjtFQUNBLE9BQU8vRSxDQUFQO0FBQ0gsQ0EvSk8sRUFBUjs7QUFnS0FSLE9BQU8sV0FBUCxHQUFrQk8sQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge3ZhbHVlOiAhMH0pO1xudmFyIF9wSW5mbyA9IHJlcXVpcmUoXCJwSW5mb1wiKTtcbnZhciBfYyA9IHJlcXVpcmUoXCJjXCIpO1xudmFyIF9ldnRzID0gcmVxdWlyZShcImV2dHNcIik7XG52YXIgX3VEYXRhID0gcmVxdWlyZShcInVEYXRhXCIpO1xudmFyIGwgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIHQoKSB7XG4gICAgICAgIHRoaXMuaXNTaGFyaW5nID0gITE7XG4gICAgICAgIHRoaXMuaXNIaWRpbmcgPSAhMTtcbiAgICAgICAgdGhpcy5kZWxheUlEID0gMDtcbiAgICAgICAgdGhpcy5jbGlwcyA9IHt9O1xuICAgICAgICBfZXZ0cy5kZWZhdWx0LnBsRS5vbihmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5vblNob3dcbiAgICAgICAgICAgICAgICA/ICgodC5pbnMuaXNIaWRpbmcgPSAhMSksIHQuaW5zLm9uU291bmRDaGFuZ2UoKSlcbiAgICAgICAgICAgICAgICA6IGUub25IaWRlICYmICgodC5pbnMuaXNIaWRpbmcgPSAhMCksIHQuaW5zLm9uU291bmRDaGFuZ2UoKSk7XG4gICAgICAgIH0pO1xuICAgICAgICBfZXZ0cy5kZWZhdWx0LmFkRS5vbihmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdC5pbnMuaXNTaGFyaW5nID0gZSA9PSBfYy5BREUuU0hBUkUgfHwgZSA9PSBfYy5BREUuVklERU87XG4gICAgICAgICAgICB0Lmlucy5vblNvdW5kQ2hhbmdlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgXCJpbnNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuX2lucyB8fCAodGhpcy5faW5zID0gbmV3IHQoKSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faW5zO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiAhMSxcbiAgICAgICAgY29uZmlndXJhYmxlOiAhMFxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LnByb3RvdHlwZSwgXCJiZ21Wb2x1bWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZvaWQgMCA9PT0gdGhpcy5fYmdtVm9sdW1lICYmICh0aGlzLl9iZ21Wb2x1bWUgPSBfdURhdGEuZGVmYXVsdC5pbnMuZ2V0U2V0dGluZygpLmJnbVZvbHVtZSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYmdtVm9sdW1lO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5zZXRNdXNpY1ZvbHVtZSh0KTtcbiAgICAgICAgICAgIHRoaXMuX2JnbVZvbHVtZSA9IHQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6ICExLFxuICAgICAgICBjb25maWd1cmFibGU6ICEwXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQucHJvdG90eXBlLCBcImVmZmVjdFZvbHVtZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdm9pZCAwID09PSB0aGlzLl9lZmZlY3RWb2x1bWUgJiYgKHRoaXMuX2VmZmVjdFZvbHVtZSA9IF91RGF0YS5kZWZhdWx0Lmlucy5nZXRTZXR0aW5nKCkuZWZmZWN0Vm9sdW1lKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9lZmZlY3RWb2x1bWU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgIHRoaXMuX2VmZmVjdFZvbHVtZSA9IHQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6ICExLFxuICAgICAgICBjb25maWd1cmFibGU6ICEwXG4gICAgfSk7XG4gICAgdC5wcm90b3R5cGUub25Tb3VuZENoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuZGVsYXlJRCk7XG4gICAgICAgIHRoaXMuZGVsYXlJRCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHQuaW5zLmRlbGF5SUQpO1xuICAgICAgICAgICAgdC5pbnMuZGVsYXlJRCA9IDA7XG4gICAgICAgICAgICB0Lmlucy5pc1NoYXJpbmcgfHwgdC5pbnMuaXNIaWRpbmcgPyB0Lmlucy5zdG9wQWxsKCkgOiB0Lmlucy5yZXN1bWVBbGwoKTtcbiAgICAgICAgfSwgMTAwKTtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLnN0b3BBbGxFZmZlY3RzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjYy5hdWRpb0VuZ2luZS5zdG9wQWxsRWZmZWN0cygpO1xuICAgIH07XG4gICAgdC5wcm90b3R5cGUucmVzdW1lQWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjYy5hdWRpb0VuZ2luZS5yZXN1bWVNdXNpYygpO1xuICAgICAgICBjYy5hdWRpb0VuZ2luZS5yZXN1bWVBbGxFZmZlY3RzKCk7XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5zdG9wQWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjYy5hdWRpb0VuZ2luZS5zdG9wTXVzaWMoKTtcbiAgICAgICAgY2MuYXVkaW9FbmdpbmUuc3RvcEFsbEVmZmVjdHMoKTtcbiAgICB9O1xuICAgIHQucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbiAodCwgZSkge1xuICAgICAgICB2b2lkIDAgPT09IGUgJiYgKGUgPSAwKTtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG87XG4gICAgICAgICAgICB2YXIgbjtcbiAgICAgICAgICAgIHZhciByO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChpLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhMSAhPT0gX3VEYXRhLmRlZmF1bHQuaW5zLmdldFNldHRpbmcoKS5lZmZlY3RTb3VuZCAmJiBudWxsICE9IHQgPyBbMywgMV0gOiBbMl07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGUgPSBNYXRoLm1heCgxLCBNYXRoLm1pbigwLCBlKSkpLCB0IGluc3RhbmNlb2YgY2MuQXVkaW9DbGlwID8gKChvID0gdCksIFszLCA1XSkgOiBbMywgMl1cbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsICE9IHRoaXMuY2xpcHNbdF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFszLCA0XVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKChuID0gdGhpcy5jbGlwcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAociA9IHQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2MuYXNzZXRNYW5hZ2VyLmxvYWRCdW5kbGUoXCJzb3VuZFwiLCBmdW5jdGlvbiAobywgbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gZShvKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbi5sb2FkKHQsIGNjLkF1ZGlvQ2xpcCwgZnVuY3Rpb24gKHQsIG8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlKHQgPyBudWxsIDogbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKG8gPSBuW3JdID0gaS5zZW50KCkpLCBbMywgNV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIChvID0gdGhpcy5jbGlwc1t0XSksIChpLmxhYmVsID0gNSk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAoY2MuYXVkaW9FbmdpbmUucGxheUVmZmVjdChvLCAhMSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5zZXRFZmZlY3RzVm9sdW1lKGUgKiB0aGlzLmVmZmVjdFZvbHVtZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMiwgby5kdXJhdGlvbl0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBbMl07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMl07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgdC5wcm90b3R5cGUucGxheUJHTSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGU7XG4gICAgICAgICAgICB2YXIgbztcbiAgICAgICAgICAgIHZhciBuID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDAgPT0gKGUgPSBfdURhdGEuZGVmYXVsdC5pbnMuZ2V0U2V0dGluZygpLmJnbVNvdW5kKVxuICAgICAgICAgICAgICAgICAgICA/IFsyXVxuICAgICAgICAgICAgICAgICAgICA6ICgobyA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIF9wSW5mby5ST09UID09IF9wSW5mby5zY2VuZVR5cGUuZ2FtZSB8fCBfcEluZm8uUk9PVCA9PSBfcEluZm8uc2NlbmVUeXBlLmd1aWRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IFwiR2FtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiTWFpblwiKSxcbiAgICAgICAgICAgICAgICAgICAgICBjYy5hc3NldE1hbmFnZXIubG9hZEJ1bmRsZShcInNvdW5kXCIsIGZ1bmN0aW9uIChpLCByKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIubG9hZCh0LkJHTSArIG8sIGNjLkF1ZGlvQ2xpcCwgZnVuY3Rpb24gKHQsIGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBjYy5hdWRpb0VuZ2luZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG4uY3VyQmcgPT0gbyAmJiByLmlzTXVzaWNQbGF5aW5nKCkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhZSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKChuLmN1ckJnID0gbyksIHIucGxheU11c2ljKGksICEwKSwgci5zZXRNdXNpY1ZvbHVtZShuLmJnbVZvbHVtZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgIFsyXSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICB0LnByb3RvdHlwZS5zdG9wQkdNID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX3VEYXRhLmRlZmF1bHQuaW5zLmdldFNldHRpbmcoKS5iZ21Tb3VuZCAmJiAhdCA/IFsyXSA6IChjYy5hdWRpb0VuZ2luZS5zdG9wTXVzaWMoKSwgWzJdKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHQuQ0xJQ0sgPSBcImNsaWNrXCI7XG4gICAgdC5CR00gPSBcIkJHTVwiO1xuICAgIHQuV0lOID0gXCJ3aW5cIjtcbiAgICB0LkxPU0UgPSBcImxvc2VcIjtcbiAgICB0LlJJR0hUID0gXCJyaWdodFwiO1xuICAgIHQuRVJST1IgPSBcImVycm9yXCI7XG4gICAgdC5TSE9WRUwgPSBcInNob3ZlbFwiO1xuICAgIHQuUk9DS0VUTEFVTkNIID0gXCJyb2NrZXRMYXVuY2hcIjtcbiAgICB0LlJPQ0tFVEFUVEFDSyA9IFwicm9ja2V0QXR0YWNrXCI7XG4gICAgdC5USU1FID0gXCJ0aW1lXCI7XG4gICAgdC5GSU5JU0hfUFVaWkxFID0gXCJmaW5pc2hfcHV6emxlXCI7XG4gICAgcmV0dXJuIHQ7XG59KSgpO1xuZXhwb3J0cy5kZWZhdWx0ID0gbDtcbiJdfQ==