
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/ui_deskReward.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '8ad3bzV0+JPOLqI0/63veUG', 'ui_deskReward');
// scripts/ui_deskReward.js

"use strict";

var n;
Object.defineProperty(exports, "__esModule", {
  value: !0
});

var _evts = require("evts");

var _idx = require("idx");

var _pConst = require("pConst");

var _res = require("res");

var _cfgMgr = require("cfgMgr");

var _panelMgr = require("panelMgr");

var _pInfo = require("pInfo");

var _baseUI = require("baseUI");

var f = cc._decorator;
var g = f.ccclass;
var y = f.property;

var m = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.iconSpr = null;
    e.deskSpr = null;
    e.numLb = null;
    e.infoLb = null;
    return e;
  }

  __extends(e, t);

  e.prototype.onLoad = function () {
    _evts["default"].opE.on(this.onOperTap.bind(this));
  };

  e.prototype.onOperTap = function (t) {
    var e = null == t ? void 0 : t.action;
    if (e) switch (e) {
      case _evts["default"].ADD_DESKTOP:
        this.addDesktopCb(t.data);
    }
  };

  e.prototype.init = function () {
    var t;
    var e;
    var o = this;

    _res["default"].ins.l("pages/page_level/zhuxian_07_3", cc.SpriteFrame, "resSps").then(function (t) {
      o.node && o.node.isValid && (o.deskSpr.spriteFrame = t);
    })["catch"](function () {
      console.error("getResSpErr");
    });

    var n = (null === (e = null === (t = _cfgMgr["default"].serverCfg.add_desktop) || void 0 === t ? void 0 : t.rules) || void 0 === e ? void 0 : e.times) || 50;
    this.numLb.string = "+" + n;
  };

  e.prototype.hideThis = function () {
    this.hide();
  };

  e.prototype.onBtnAdd = function () {
    switch (_idx.platform.string()) {
      case _pConst.PFCode.Bytedance:
        _idx.platform.addShortcut();

    }
  };

  e.prototype.addDesktopCb = function (t) {
    var e;
    var o;

    var n = _pInfo["default"].ins.getAddDesk();

    if (t && !n) {
      _pInfo["default"].ins.setAddDesk(!0);

      var i = (null === (o = null === (e = _cfgMgr["default"].serverCfg.add_desktop) || void 0 === e ? void 0 : e.rules) || void 0 === o ? void 0 : o.times) || 50;

      _pInfo["default"].ins.addPower(i);

      var r = this.numLb.node;
      var a = r.parent.convertToWorldSpaceAR(r.position);

      _panelMgr["default"].ins.open("ui/ui_flyAni", {
        itemDatas: [{
          itemId: "times",
          worldPos: a,
          value: i
        }]
      });

      this.hideThis();
    }
  };

  e.prototype.onDestroy = function () {
    cc.assetManager.releaseAsset(this.iconSpr.spriteFrame);
  };

  __decorate([y(cc.Sprite)], e.prototype, "iconSpr", void 0);

  __decorate([y(cc.Sprite)], e.prototype, "deskSpr", void 0);

  __decorate([y(cc.Label)], e.prototype, "numLb", void 0);

  __decorate([y(cc.Label)], e.prototype, "infoLb", void 0);

  return __decorate([g], e);
}(_baseUI["default"]);

exports["default"] = m;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcdWlfZGVza1Jld2FyZC5qcyJdLCJuYW1lcyI6WyJuIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJfZXZ0cyIsInJlcXVpcmUiLCJfaWR4IiwiX3BDb25zdCIsIl9yZXMiLCJfY2ZnTWdyIiwiX3BhbmVsTWdyIiwiX3BJbmZvIiwiX2Jhc2VVSSIsImYiLCJjYyIsIl9kZWNvcmF0b3IiLCJnIiwiY2NjbGFzcyIsInkiLCJwcm9wZXJ0eSIsIm0iLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiaWNvblNwciIsImRlc2tTcHIiLCJudW1MYiIsImluZm9MYiIsIl9fZXh0ZW5kcyIsInByb3RvdHlwZSIsIm9uTG9hZCIsIm9wRSIsIm9uIiwib25PcGVyVGFwIiwiYmluZCIsImFjdGlvbiIsIkFERF9ERVNLVE9QIiwiYWRkRGVza3RvcENiIiwiZGF0YSIsImluaXQiLCJvIiwiaW5zIiwibCIsIlNwcml0ZUZyYW1lIiwidGhlbiIsIm5vZGUiLCJpc1ZhbGlkIiwic3ByaXRlRnJhbWUiLCJjb25zb2xlIiwiZXJyb3IiLCJzZXJ2ZXJDZmciLCJhZGRfZGVza3RvcCIsInJ1bGVzIiwidGltZXMiLCJzdHJpbmciLCJoaWRlVGhpcyIsImhpZGUiLCJvbkJ0bkFkZCIsInBsYXRmb3JtIiwiUEZDb2RlIiwiQnl0ZWRhbmNlIiwiYWRkU2hvcnRjdXQiLCJnZXRBZGREZXNrIiwic2V0QWRkRGVzayIsImkiLCJhZGRQb3dlciIsInIiLCJhIiwicGFyZW50IiwiY29udmVydFRvV29ybGRTcGFjZUFSIiwicG9zaXRpb24iLCJvcGVuIiwiaXRlbURhdGFzIiwiaXRlbUlkIiwid29ybGRQb3MiLCJvbkRlc3Ryb3kiLCJhc3NldE1hbmFnZXIiLCJyZWxlYXNlQXNzZXQiLCJfX2RlY29yYXRlIiwiU3ByaXRlIiwiTGFiZWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBSjtBQUNB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QUE2QixPQUE3QixFQUFzQyxLQUFLLENBQTNDLENBQVY7O0VBQ0FpRCxVQUFVLENBQUMsQ0FBQzdELENBQUMsQ0FBQ0osRUFBRSxDQUFDbUUsS0FBSixDQUFGLENBQUQsRUFBZ0IzRCxDQUFDLENBQUNRLFNBQWxCLEVBQTZCLFFBQTdCLEVBQXVDLEtBQUssQ0FBNUMsQ0FBVjs7RUFDQSxPQUFPaUQsVUFBVSxDQUFDLENBQUMvRCxDQUFELENBQUQsRUFBTU0sQ0FBTixDQUFqQjtBQUNILENBNUVPLENBNEVMVixPQUFPLFdBNUVGLENBQVI7O0FBNkVBVixPQUFPLFdBQVAsR0FBa0JrQixDQUFsQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG47XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHt2YWx1ZTogITB9KTtcbnZhciBfZXZ0cyA9IHJlcXVpcmUoXCJldnRzXCIpO1xudmFyIF9pZHggPSByZXF1aXJlKFwiaWR4XCIpO1xudmFyIF9wQ29uc3QgPSByZXF1aXJlKFwicENvbnN0XCIpO1xudmFyIF9yZXMgPSByZXF1aXJlKFwicmVzXCIpO1xudmFyIF9jZmdNZ3IgPSByZXF1aXJlKFwiY2ZnTWdyXCIpO1xudmFyIF9wYW5lbE1nciA9IHJlcXVpcmUoXCJwYW5lbE1nclwiKTtcbnZhciBfcEluZm8gPSByZXF1aXJlKFwicEluZm9cIik7XG52YXIgX2Jhc2VVSSA9IHJlcXVpcmUoXCJiYXNlVUlcIik7XG52YXIgZiA9IGNjLl9kZWNvcmF0b3I7XG52YXIgZyA9IGYuY2NjbGFzcztcbnZhciB5ID0gZi5wcm9wZXJ0eTtcbnZhciBtID0gKGZ1bmN0aW9uICh0KSB7XG4gICAgZnVuY3Rpb24gZSgpIHtcbiAgICAgICAgdmFyIGUgPSAobnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIHx8IHRoaXM7XG4gICAgICAgIGUuaWNvblNwciA9IG51bGw7XG4gICAgICAgIGUuZGVza1NwciA9IG51bGw7XG4gICAgICAgIGUubnVtTGIgPSBudWxsO1xuICAgICAgICBlLmluZm9MYiA9IG51bGw7XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICBfX2V4dGVuZHMoZSwgdCk7XG4gICAgZS5wcm90b3R5cGUub25Mb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfZXZ0cy5kZWZhdWx0Lm9wRS5vbih0aGlzLm9uT3BlclRhcC5iaW5kKHRoaXMpKTtcbiAgICB9O1xuICAgIGUucHJvdG90eXBlLm9uT3BlclRhcCA9IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHZhciBlID0gbnVsbCA9PSB0ID8gdm9pZCAwIDogdC5hY3Rpb247XG4gICAgICAgIGlmIChlKVxuICAgICAgICAgICAgc3dpdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBfZXZ0cy5kZWZhdWx0LkFERF9ERVNLVE9QOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZERlc2t0b3BDYih0LmRhdGEpO1xuICAgICAgICAgICAgfVxuICAgIH07XG4gICAgZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHQ7XG4gICAgICAgIHZhciBlO1xuICAgICAgICB2YXIgbyA9IHRoaXM7XG4gICAgICAgIF9yZXMuZGVmYXVsdC5pbnNcbiAgICAgICAgICAgIC5sKFwicGFnZXMvcGFnZV9sZXZlbC96aHV4aWFuXzA3XzNcIiwgY2MuU3ByaXRlRnJhbWUsIFwicmVzU3BzXCIpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodCkge1xuICAgICAgICAgICAgICAgIG8ubm9kZSAmJiBvLm5vZGUuaXNWYWxpZCAmJiAoby5kZXNrU3ByLnNwcml0ZUZyYW1lID0gdCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiZ2V0UmVzU3BFcnJcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgdmFyIG4gPVxuICAgICAgICAgICAgKG51bGwgPT09IChlID0gbnVsbCA9PT0gKHQgPSBfY2ZnTWdyLmRlZmF1bHQuc2VydmVyQ2ZnLmFkZF9kZXNrdG9wKSB8fCB2b2lkIDAgPT09IHQgPyB2b2lkIDAgOiB0LnJ1bGVzKSB8fFxuICAgICAgICAgICAgdm9pZCAwID09PSBlXG4gICAgICAgICAgICAgICAgPyB2b2lkIDBcbiAgICAgICAgICAgICAgICA6IGUudGltZXMpIHx8IDUwO1xuICAgICAgICB0aGlzLm51bUxiLnN0cmluZyA9IFwiK1wiICsgbjtcbiAgICB9O1xuICAgIGUucHJvdG90eXBlLmhpZGVUaGlzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICB9O1xuICAgIGUucHJvdG90eXBlLm9uQnRuQWRkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBzd2l0Y2ggKF9pZHgucGxhdGZvcm0uc3RyaW5nKCkpIHtcbiAgICAgICAgICAgIGNhc2UgX3BDb25zdC5QRkNvZGUuQnl0ZWRhbmNlOlxuICAgICAgICAgICAgICAgIF9pZHgucGxhdGZvcm0uYWRkU2hvcnRjdXQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgZS5wcm90b3R5cGUuYWRkRGVza3RvcENiID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdmFyIGU7XG4gICAgICAgIHZhciBvO1xuICAgICAgICB2YXIgbiA9IF9wSW5mby5kZWZhdWx0Lmlucy5nZXRBZGREZXNrKCk7XG4gICAgICAgIGlmICh0ICYmICFuKSB7XG4gICAgICAgICAgICBfcEluZm8uZGVmYXVsdC5pbnMuc2V0QWRkRGVzayghMCk7XG4gICAgICAgICAgICB2YXIgaSA9XG4gICAgICAgICAgICAgICAgKG51bGwgPT09XG4gICAgICAgICAgICAgICAgICAgIChvID0gbnVsbCA9PT0gKGUgPSBfY2ZnTWdyLmRlZmF1bHQuc2VydmVyQ2ZnLmFkZF9kZXNrdG9wKSB8fCB2b2lkIDAgPT09IGUgPyB2b2lkIDAgOiBlLnJ1bGVzKSB8fFxuICAgICAgICAgICAgICAgIHZvaWQgMCA9PT0gb1xuICAgICAgICAgICAgICAgICAgICA/IHZvaWQgMFxuICAgICAgICAgICAgICAgICAgICA6IG8udGltZXMpIHx8IDUwO1xuICAgICAgICAgICAgX3BJbmZvLmRlZmF1bHQuaW5zLmFkZFBvd2VyKGkpO1xuICAgICAgICAgICAgdmFyIHIgPSB0aGlzLm51bUxiLm5vZGU7XG4gICAgICAgICAgICB2YXIgYSA9IHIucGFyZW50LmNvbnZlcnRUb1dvcmxkU3BhY2VBUihyLnBvc2l0aW9uKTtcbiAgICAgICAgICAgIF9wYW5lbE1nci5kZWZhdWx0Lmlucy5vcGVuKFwidWkvdWlfZmx5QW5pXCIsIHtpdGVtRGF0YXM6IFt7aXRlbUlkOiBcInRpbWVzXCIsIHdvcmxkUG9zOiBhLCB2YWx1ZTogaX1dfSk7XG4gICAgICAgICAgICB0aGlzLmhpZGVUaGlzKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGUucHJvdG90eXBlLm9uRGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2MuYXNzZXRNYW5hZ2VyLnJlbGVhc2VBc3NldCh0aGlzLmljb25TcHIuc3ByaXRlRnJhbWUpO1xuICAgIH07XG4gICAgX19kZWNvcmF0ZShbeShjYy5TcHJpdGUpXSwgZS5wcm90b3R5cGUsIFwiaWNvblNwclwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW3koY2MuU3ByaXRlKV0sIGUucHJvdG90eXBlLCBcImRlc2tTcHJcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFt5KGNjLkxhYmVsKV0sIGUucHJvdG90eXBlLCBcIm51bUxiXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbeShjYy5MYWJlbCldLCBlLnByb3RvdHlwZSwgXCJpbmZvTGJcIiwgdm9pZCAwKTtcbiAgICByZXR1cm4gX19kZWNvcmF0ZShbZ10sIGUpO1xufSkoX2Jhc2VVSS5kZWZhdWx0KTtcbmV4cG9ydHMuZGVmYXVsdCA9IG07XG4iXX0=