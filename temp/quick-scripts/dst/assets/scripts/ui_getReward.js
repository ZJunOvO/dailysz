
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/ui_getReward.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'e7f52YMQ3lPSrhdMRaASNUv', 'ui_getReward');
// scripts/ui_getReward.js

"use strict";

var n;
Object.defineProperty(exports, "__esModule", {
  value: !0
});

var _res = require("res");

var _bagMgr = require("bagMgr");

var _festivalMgr = require("festivalMgr");

var _levelMgr = require("levelMgr");

var _panelMgr = require("panelMgr");

var _pInfo = require("pInfo");

var _game = require("game");

var _baseUI = require("baseUI");

var _rewardMgr = require("rewardMgr"); // 💝 现金奖励管理器


var f = cc._decorator;
var g = f.ccclass;
var y = f.property;

var m = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.rew1Lbl = null;
    e.rew2Lbl = null;
    e.rew3Lbl = null;
    e.rew4Lbl = null;
    e.adGetBtn = null;
    e.typeSps = []; // 💝 现金奖励状态（复用原有UI结构）

    e.hasCashReward = false; // 是否有现金奖励

    return e;
  }

  __extends(e, t);

  e.prototype.init = function (t) {
    var e = this;
    var o = t.gold;
    this.goldNum = o;
    var n = this.pieceNum = 1; // 💝 添加空指针保护和错误捕获

    try {
      console.log("🔍 开始Label检查...");
      if (this.rew1Lbl) this.rew1Lbl.string = "x" + o;
      if (this.rew2Lbl) this.rew2Lbl.string = "x" + n;
      if (this.rew3Lbl) this.rew3Lbl.string = "x" + 10 * o;

      if (this.rew4Lbl) {
        this.rew4Lbl.string = "x" + 10 * n;
      } else {
        console.log("ℹ️ rew4Lbl不存在（用户已改为现金奖励单一显示）");
      }

      console.log("✅ Label设置完成 - rew1:", !!this.rew1Lbl, "rew2:", !!this.rew2Lbl, "rew3:", !!this.rew3Lbl, "rew4:", !!this.rew4Lbl);
    } catch (error) {
      console.log("❌ Label设置失败:", error);
      console.log("🔍 Label状态:", {
        rew1: !!this.rew1Lbl,
        rew2: !!this.rew2Lbl,
        rew3: !!this.rew3Lbl,
        rew4: !!this.rew4Lbl
      });
    }

    this.initAdDotEvent(); // 💝 检查并设置现金奖励显示

    this.setupCashReward();
    var i;
    var r = _game["default"].type;
    i = r !== _pInfo.gameType.festival || _festivalMgr["default"].ins.isJigsawMax() ? "puzzle_pieces" : "newYear_pieces";

    _res["default"].ins.getBundleByString("resSps").then(function (t) {
      t.load("item/" + i, cc.SpriteFrame, function (t, o) {
        !t && e.node && e.node.isValid && e.typeSps.forEach(function (t) {
          if (t && t.spriteFrame !== undefined) {
            t.spriteFrame = o;
          }
        });
      });
    })["catch"](function (t) {
      console.error("RTool.ins.getBundleByString('resSps')", t);
    });
  };

  e.prototype.tempGet = function (t) {
    var e = t ? 10 : 1;

    var o = _pInfo["default"].ins.getCoin();

    _pInfo["default"].ins.addCoin(this.goldNum * e);

    var n;
    n = _game["default"].type !== _pInfo.gameType.festival || _festivalMgr["default"].ins.isJigsawMax() ? "puzzle_pieces" : "newYear_pieces";

    _bagMgr["default"].ins.addItem(n, e);

    var i = this.goldNum * e;
    var r = e;
    var a = this.rew1Lbl.node;
    var h = this.rew2Lbl.node;
    var f = this.node;
    var g = f.convertToWorldSpaceAR(a.position);
    var y = f.convertToWorldSpaceAR(h.position);

    _panelMgr["default"].ins.open("ui/ui_flyAni", {
      itemDatas: [{
        itemId: "coin",
        worldPos: g,
        value: i
      }, {
        itemId: n,
        worldPos: y,
        value: r
      }],
      hideCb: function hideCb() {
        _pInfo.chgScene(_pInfo.sceneType.main, {
          cb: _levelMgr["default"].ins.updJigAndPop
        });
      },
      showCoin: o
    });

    this.hideThis();
  };

  e.prototype.hideThis = function () {
    this.hide();
  };

  e.prototype.onGet = function () {
    // 💝 检查是否为现金奖励模式
    if (this.hasCashReward) {
      // 现金奖励模式下，单倍也是领取现金
      console.log("💰 领取单倍现金奖励: ¥" + this.cashAmount); // 💝 现金在游戏完成时已经添加了，这里只是确认领取

      try {
        if (typeof window !== 'undefined' && window.alert) {
          window.alert("💝 卷卷领取了￥" + this.cashAmount + "现金奖励！棒棒哒！");
        }
      } catch (alertError) {
        console.log("Alert显示失败:", alertError);
      }

      _rewardMgr["default"].showLoveSupportMessage();

      _rewardMgr["default"].clearCashRewardFlag();

      this.hideThis();
    } else {
      // 💝 如果不是现金奖励但有待处理标记，也要清除
      if (_rewardMgr["default"].hasPendingCashReward()) {
        _rewardMgr["default"].clearCashRewardFlag();
      }

      this.tempGet(!1);
    }
  };

  e.prototype.onAdGet = function () {
    console.log("🔘 点击领取奖金按钮");
    console.log("🔍 当前hasCashReward状态:", this.hasCashReward);
    console.log("🔍 当前cashAmount:", this.cashAmount); // 💝 检查是否为现金奖励模式

    if (this.hasCashReward) {
      console.log("💰 执行现金奖励逻辑");
      this.onGetCashReward();
    } else {
      console.log("🎮 执行游戏道具奖励逻辑");
      this.tempGet(!0);
    }
  };

  e.prototype.initAdDotEvent = function () {
    _game["default"].type !== _pInfo.gameType.festival || _festivalMgr["default"].ins.isJigsawMax() ? this.adGetBtn.node.adDotData = "主线十倍奖励" : this.adGetBtn.node.adDotData = "活动十倍奖励";
  }; // 💝 设置现金奖励显示（复用原有UI结构）


  e.prototype.setupCashReward = function () {
    try {
      console.log("🔍 开始检查现金奖励..."); // 检查是否刚刚获得了现金奖励

      var hasRecentReward = _rewardMgr["default"].getLastRewardInfo();

      console.log("🎯 getLastRewardInfo返回:", hasRecentReward);

      if (hasRecentReward) {
        console.log("💰 检测到现金奖励: ¥" + hasRecentReward.amount); // 设置现金奖励状态

        this.hasCashReward = true;
        this.cashAmount = hasRecentReward.amount; // 修改现金奖励显示（用户已将右侧改为单一现金奖励显示）

        if (this.rew3Lbl) {
          this.rew3Lbl.string = "+¥" + hasRecentReward.amount;
          console.log("💰 rew3Lbl设置为现金奖励: +¥" + hasRecentReward.amount);
        } // rew4Lbl已删除，不再设置


        console.log("✅ 现金奖励UI已设置: " + (this.rew3Lbl ? this.rew3Lbl.string : "rew3Lbl未绑定"));
        console.log("✅ hasCashReward状态:", this.hasCashReward);
        console.log("✅ cashAmount:", this.cashAmount);
      } else {
        console.log("💰 无现金奖励，使用原有逻辑");
        this.hasCashReward = false; // 恢复原有的游戏道具显示逻辑已经在init中处理了
      }
    } catch (error) {
      console.log("❌ 设置现金奖励失败:", error);
      this.hasCashReward = false;
    }
  }; // 💝 领取现金奖励


  e.prototype.onGetCashReward = function () {
    try {
      console.log("💰 点击领取现金奖励: ¥" + this.cashAmount); // 💝 现金在游戏完成时已经添加了，这里只是确认领取
      // 显示奖励领取成功提示

      try {
        if (typeof window !== 'undefined' && window.alert) {
          window.alert("🎉 恭喜卷卷！￥" + this.cashAmount + "现金奖励已成功领取！");
        } else {
          var _tipMgr = require("tipMgr");

          _tipMgr["default"].ins.showTip("卷卷获得￥" + this.cashAmount + "奖励！", false);
        }
      } catch (tipError) {
        console.log("提示显示失败:", tipError);
      } // 显示菌子支持消息


      _rewardMgr["default"].showLoveSupportMessage(); // 💝 清除现金奖励标记，防止第二次弹窗


      _rewardMgr["default"].clearCashRewardFlag(); // 关闭弹窗


      this.hideThis();
      console.log("🎉 现金奖励确认完成！（余额已在游戏完成时更新）");
    } catch (error) {
      console.log("❌ 领取现金奖励失败:", error);
    }
  };

  __decorate([y(cc.Label)], e.prototype, "rew1Lbl", void 0);

  __decorate([y(cc.Label)], e.prototype, "rew2Lbl", void 0);

  __decorate([y(cc.Label)], e.prototype, "rew3Lbl", void 0);

  __decorate([y(cc.Label)], e.prototype, "rew4Lbl", void 0);

  __decorate([y(cc.Button)], e.prototype, "adGetBtn", void 0);

  __decorate([y([cc.Sprite])], e.prototype, "typeSps", void 0);

  return __decorate([g], e);
}(_baseUI["default"]);

exports["default"] = m;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcdWlfZ2V0UmV3YXJkLmpzIl0sIm5hbWVzIjpbIm4iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsIl9yZXMiLCJyZXF1aXJlIiwiX2JhZ01nciIsIl9mZXN0aXZhbE1nciIsIl9sZXZlbE1nciIsIl9wYW5lbE1nciIsIl9wSW5mbyIsIl9nYW1lIiwiX2Jhc2VVSSIsIl9yZXdhcmRNZ3IiLCJmIiwiY2MiLCJfZGVjb3JhdG9yIiwiZyIsImNjY2xhc3MiLCJ5IiwicHJvcGVydHkiLCJtIiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsInJldzFMYmwiLCJyZXcyTGJsIiwicmV3M0xibCIsInJldzRMYmwiLCJhZEdldEJ0biIsInR5cGVTcHMiLCJoYXNDYXNoUmV3YXJkIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwiaW5pdCIsIm8iLCJnb2xkIiwiZ29sZE51bSIsInBpZWNlTnVtIiwiY29uc29sZSIsImxvZyIsInN0cmluZyIsImVycm9yIiwicmV3MSIsInJldzIiLCJyZXczIiwicmV3NCIsImluaXRBZERvdEV2ZW50Iiwic2V0dXBDYXNoUmV3YXJkIiwiaSIsInIiLCJ0eXBlIiwiZ2FtZVR5cGUiLCJmZXN0aXZhbCIsImlucyIsImlzSmlnc2F3TWF4IiwiZ2V0QnVuZGxlQnlTdHJpbmciLCJ0aGVuIiwibG9hZCIsIlNwcml0ZUZyYW1lIiwibm9kZSIsImlzVmFsaWQiLCJmb3JFYWNoIiwic3ByaXRlRnJhbWUiLCJ1bmRlZmluZWQiLCJ0ZW1wR2V0IiwiZ2V0Q29pbiIsImFkZENvaW4iLCJhZGRJdGVtIiwiYSIsImgiLCJjb252ZXJ0VG9Xb3JsZFNwYWNlQVIiLCJwb3NpdGlvbiIsIm9wZW4iLCJpdGVtRGF0YXMiLCJpdGVtSWQiLCJ3b3JsZFBvcyIsImhpZGVDYiIsImNoZ1NjZW5lIiwic2NlbmVUeXBlIiwibWFpbiIsImNiIiwidXBkSmlnQW5kUG9wIiwic2hvd0NvaW4iLCJoaWRlVGhpcyIsImhpZGUiLCJvbkdldCIsImNhc2hBbW91bnQiLCJ3aW5kb3ciLCJhbGVydCIsImFsZXJ0RXJyb3IiLCJzaG93TG92ZVN1cHBvcnRNZXNzYWdlIiwiY2xlYXJDYXNoUmV3YXJkRmxhZyIsImhhc1BlbmRpbmdDYXNoUmV3YXJkIiwib25BZEdldCIsIm9uR2V0Q2FzaFJld2FyZCIsImFkRG90RGF0YSIsImhhc1JlY2VudFJld2FyZCIsImdldExhc3RSZXdhcmRJbmZvIiwiYW1vdW50IiwiX3RpcE1nciIsInNob3dUaXAiLCJ0aXBFcnJvciIsIl9fZGVjb3JhdGUiLCJMYWJlbCIsIkJ1dHRvbiIsIlNwcml0ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKO0FBQ0FDLE1BQU0sQ0FBQ0MsY0FBUCxDQUFzQkMsT0FBdEIsRUFBK0IsWUFBL0IsRUFBNkM7RUFBQ0MsS0FBSyxFQUFFLENBQUM7QUFBVCxDQUE3Qzs7QUFDQSxJQUFJQyxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxLQUFELENBQWxCOztBQUNBLElBQUlDLE9BQU8sR0FBR0QsT0FBTyxDQUFDLFFBQUQsQ0FBckI7O0FBQ0EsSUFBSUUsWUFBWSxHQUFHRixPQUFPLENBQUMsYUFBRCxDQUExQjs7QUFDQSxJQUFJRyxTQUFTLEdBQUdILE9BQU8sQ0FBQyxVQUFELENBQXZCOztBQUNBLElBQUlJLFNBQVMsR0FBR0osT0FBTyxDQUFDLFVBQUQsQ0FBdkI7O0FBQ0EsSUFBSUssTUFBTSxHQUFHTCxPQUFPLENBQUMsT0FBRCxDQUFwQjs7QUFDQSxJQUFJTSxLQUFLLEdBQUdOLE9BQU8sQ0FBQyxNQUFELENBQW5COztBQUNBLElBQUlPLE9BQU8sR0FBR1AsT0FBTyxDQUFDLFFBQUQsQ0FBckI7O0FBQ0EsSUFBSVEsVUFBVSxHQUFHUixPQUFPLENBQUMsV0FBRCxDQUF4QixFQUF3Qzs7O0FBQ3hDLElBQUlTLENBQUMsR0FBR0MsRUFBRSxDQUFDQyxVQUFYO0FBQ0EsSUFBSUMsQ0FBQyxHQUFHSCxDQUFDLENBQUNJLE9BQVY7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QUFWOztFQUNBc0UsVUFBVSxDQUFDLENBQUNyRixDQUFDLENBQUNKLEVBQUUsQ0FBQzJGLE1BQUosQ0FBRixDQUFELEVBQWlCbkYsQ0FBQyxDQUFDVyxTQUFuQixFQUE4QixVQUE5QixFQUEwQyxLQUFLLENBQS9DLENBQVY7O0VBQ0FzRSxVQUFVLENBQUMsQ0FBQ3JGLENBQUMsQ0FBQyxDQUFDSixFQUFFLENBQUM0RixNQUFKLENBQUQsQ0FBRixDQUFELEVBQW1CcEYsQ0FBQyxDQUFDVyxTQUFyQixFQUFnQyxTQUFoQyxFQUEyQyxLQUFLLENBQWhELENBQVY7O0VBQ0EsT0FBT3NFLFVBQVUsQ0FBQyxDQUFDdkYsQ0FBRCxDQUFELEVBQU1NLENBQU4sQ0FBakI7QUFDSCxDQWpPTyxDQWlPTFgsT0FBTyxXQWpPRixDQUFSOztBQWtPQVYsT0FBTyxXQUFQLEdBQWtCbUIsQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBuO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7dmFsdWU6ICEwfSk7XG52YXIgX3JlcyA9IHJlcXVpcmUoXCJyZXNcIik7XG52YXIgX2JhZ01nciA9IHJlcXVpcmUoXCJiYWdNZ3JcIik7XG52YXIgX2Zlc3RpdmFsTWdyID0gcmVxdWlyZShcImZlc3RpdmFsTWdyXCIpO1xudmFyIF9sZXZlbE1nciA9IHJlcXVpcmUoXCJsZXZlbE1nclwiKTtcbnZhciBfcGFuZWxNZ3IgPSByZXF1aXJlKFwicGFuZWxNZ3JcIik7XG52YXIgX3BJbmZvID0gcmVxdWlyZShcInBJbmZvXCIpO1xudmFyIF9nYW1lID0gcmVxdWlyZShcImdhbWVcIik7XG52YXIgX2Jhc2VVSSA9IHJlcXVpcmUoXCJiYXNlVUlcIik7XG52YXIgX3Jld2FyZE1nciA9IHJlcXVpcmUoXCJyZXdhcmRNZ3JcIik7ICAvLyDwn5KdIOeOsOmHkeWlluWKseeuoeeQhuWZqFxudmFyIGYgPSBjYy5fZGVjb3JhdG9yO1xudmFyIGcgPSBmLmNjY2xhc3M7XG52YXIgeSA9IGYucHJvcGVydHk7XG52YXIgbSA9IChmdW5jdGlvbiAodCkge1xuICAgIGZ1bmN0aW9uIGUoKSB7XG4gICAgICAgIHZhciBlID0gKG51bGwgIT09IHQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB8fCB0aGlzO1xuICAgICAgICBlLnJldzFMYmwgPSBudWxsO1xuICAgICAgICBlLnJldzJMYmwgPSBudWxsO1xuICAgICAgICBlLnJldzNMYmwgPSBudWxsO1xuICAgICAgICBlLnJldzRMYmwgPSBudWxsO1xuICAgICAgICBlLmFkR2V0QnRuID0gbnVsbDtcbiAgICAgICAgZS50eXBlU3BzID0gW107XG4gICAgICAgIC8vIPCfkp0g546w6YeR5aWW5Yqx54q25oCB77yI5aSN55So5Y6f5pyJVUnnu5PmnoTvvIlcbiAgICAgICAgZS5oYXNDYXNoUmV3YXJkID0gZmFsc2U7ICAvLyDmmK/lkKbmnInnjrDph5HlpZblirFcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcbiAgICBlLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdmFyIGUgPSB0aGlzO1xuICAgICAgICB2YXIgbyA9IHQuZ29sZDtcbiAgICAgICAgdGhpcy5nb2xkTnVtID0gbztcbiAgICAgICAgdmFyIG4gPSAodGhpcy5waWVjZU51bSA9IDEpO1xuICAgICAgICBcbiAgICAgICAgLy8g8J+SnSDmt7vliqDnqbrmjIfpkojkv53miqTlkozplJnor6/mjZXojrdcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi8J+UjSDlvIDlp4tMYWJlbOajgOafpS4uLlwiKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnJldzFMYmwpIHRoaXMucmV3MUxibC5zdHJpbmcgPSBcInhcIiArIG87XG4gICAgICAgICAgICBpZiAodGhpcy5yZXcyTGJsKSB0aGlzLnJldzJMYmwuc3RyaW5nID0gXCJ4XCIgKyBuOyAgXG4gICAgICAgICAgICBpZiAodGhpcy5yZXczTGJsKSB0aGlzLnJldzNMYmwuc3RyaW5nID0gXCJ4XCIgKyAxMCAqIG87XG4gICAgICAgICAgICBpZiAodGhpcy5yZXc0TGJsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXc0TGJsLnN0cmluZyA9IFwieFwiICsgMTAgKiBuO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuKEue+4jyByZXc0TGJs5LiN5a2Y5Zyo77yI55So5oi35bey5pS55Li6546w6YeR5aWW5Yqx5Y2V5LiA5pi+56S677yJXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLinIUgTGFiZWzorr7nva7lrozmiJAgLSByZXcxOlwiLCAhIXRoaXMucmV3MUxibCwgXCJyZXcyOlwiLCAhIXRoaXMucmV3MkxibCwgXCJyZXczOlwiLCAhIXRoaXMucmV3M0xibCwgXCJyZXc0OlwiLCAhIXRoaXMucmV3NExibCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIuKdjCBMYWJlbOiuvue9ruWksei0pTpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCLwn5SNIExhYmVs54q25oCBOlwiLCB7XG4gICAgICAgICAgICAgICAgcmV3MTogISF0aGlzLnJldzFMYmwsXG4gICAgICAgICAgICAgICAgcmV3MjogISF0aGlzLnJldzJMYmwsIFxuICAgICAgICAgICAgICAgIHJldzM6ICEhdGhpcy5yZXczTGJsLFxuICAgICAgICAgICAgICAgIHJldzQ6ICEhdGhpcy5yZXc0TGJsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5pbml0QWREb3RFdmVudCgpO1xuICAgICAgICBcbiAgICAgICAgLy8g8J+SnSDmo4Dmn6Xlubborr7nva7njrDph5HlpZblirHmmL7npLpcbiAgICAgICAgdGhpcy5zZXR1cENhc2hSZXdhcmQoKTtcbiAgICAgICAgdmFyIGk7XG4gICAgICAgIHZhciByID0gX2dhbWUuZGVmYXVsdC50eXBlO1xuICAgICAgICBpID1cbiAgICAgICAgICAgIHIgIT09IF9wSW5mby5nYW1lVHlwZS5mZXN0aXZhbCB8fCBfZmVzdGl2YWxNZ3IuZGVmYXVsdC5pbnMuaXNKaWdzYXdNYXgoKVxuICAgICAgICAgICAgICAgID8gXCJwdXp6bGVfcGllY2VzXCJcbiAgICAgICAgICAgICAgICA6IFwibmV3WWVhcl9waWVjZXNcIjtcbiAgICAgICAgX3Jlcy5kZWZhdWx0Lmluc1xuICAgICAgICAgICAgLmdldEJ1bmRsZUJ5U3RyaW5nKFwicmVzU3BzXCIpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodCkge1xuICAgICAgICAgICAgICAgIHQubG9hZChcIml0ZW0vXCIgKyBpLCBjYy5TcHJpdGVGcmFtZSwgZnVuY3Rpb24gKHQsIG8pIHtcbiAgICAgICAgICAgICAgICAgICAgIXQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGUubm9kZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgZS5ub2RlLmlzVmFsaWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGUudHlwZVNwcy5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgdC5zcHJpdGVGcmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuc3ByaXRlRnJhbWUgPSBvO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAodCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJSVG9vbC5pbnMuZ2V0QnVuZGxlQnlTdHJpbmcoJ3Jlc1NwcycpXCIsIHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgfTtcbiAgICBlLnByb3RvdHlwZS50ZW1wR2V0ID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdmFyIGUgPSB0ID8gMTAgOiAxO1xuICAgICAgICB2YXIgbyA9IF9wSW5mby5kZWZhdWx0Lmlucy5nZXRDb2luKCk7XG4gICAgICAgIF9wSW5mby5kZWZhdWx0Lmlucy5hZGRDb2luKHRoaXMuZ29sZE51bSAqIGUpO1xuICAgICAgICB2YXIgbjtcbiAgICAgICAgbiA9XG4gICAgICAgICAgICBfZ2FtZS5kZWZhdWx0LnR5cGUgIT09IF9wSW5mby5nYW1lVHlwZS5mZXN0aXZhbCB8fCBfZmVzdGl2YWxNZ3IuZGVmYXVsdC5pbnMuaXNKaWdzYXdNYXgoKVxuICAgICAgICAgICAgICAgID8gXCJwdXp6bGVfcGllY2VzXCJcbiAgICAgICAgICAgICAgICA6IFwibmV3WWVhcl9waWVjZXNcIjtcbiAgICAgICAgX2JhZ01nci5kZWZhdWx0Lmlucy5hZGRJdGVtKG4sIGUpO1xuICAgICAgICB2YXIgaSA9IHRoaXMuZ29sZE51bSAqIGU7XG4gICAgICAgIHZhciByID0gZTtcbiAgICAgICAgdmFyIGEgPSB0aGlzLnJldzFMYmwubm9kZTtcbiAgICAgICAgdmFyIGggPSB0aGlzLnJldzJMYmwubm9kZTtcbiAgICAgICAgdmFyIGYgPSB0aGlzLm5vZGU7XG4gICAgICAgIHZhciBnID0gZi5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIoYS5wb3NpdGlvbik7XG4gICAgICAgIHZhciB5ID0gZi5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIoaC5wb3NpdGlvbik7XG4gICAgICAgIF9wYW5lbE1nci5kZWZhdWx0Lmlucy5vcGVuKFwidWkvdWlfZmx5QW5pXCIsIHtcbiAgICAgICAgICAgIGl0ZW1EYXRhczogW1xuICAgICAgICAgICAgICAgIHtpdGVtSWQ6IFwiY29pblwiLCB3b3JsZFBvczogZywgdmFsdWU6IGl9LFxuICAgICAgICAgICAgICAgIHtpdGVtSWQ6IG4sIHdvcmxkUG9zOiB5LCB2YWx1ZTogcn1cbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBoaWRlQ2I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfcEluZm8uY2hnU2NlbmUoX3BJbmZvLnNjZW5lVHlwZS5tYWluLCB7Y2I6IF9sZXZlbE1nci5kZWZhdWx0Lmlucy51cGRKaWdBbmRQb3B9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzaG93Q29pbjogb1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5oaWRlVGhpcygpO1xuICAgIH07XG4gICAgZS5wcm90b3R5cGUuaGlkZVRoaXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaGlkZSgpO1xuICAgIH07XG4gICAgZS5wcm90b3R5cGUub25HZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIPCfkp0g5qOA5p+l5piv5ZCm5Li6546w6YeR5aWW5Yqx5qih5byPXG4gICAgICAgIGlmICh0aGlzLmhhc0Nhc2hSZXdhcmQpIHtcbiAgICAgICAgICAgIC8vIOeOsOmHkeWlluWKseaooeW8j+S4i++8jOWNleWAjeS5n+aYr+mihuWPlueOsOmHkVxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLwn5KwIOmihuWPluWNleWAjeeOsOmHkeWlluWKsTogwqVcIiArIHRoaXMuY2FzaEFtb3VudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIPCfkp0g546w6YeR5Zyo5ri45oiP5a6M5oiQ5pe25bey57uP5re75Yqg5LqG77yM6L+Z6YeM5Y+q5piv56Gu6K6k6aKG5Y+WXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuYWxlcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFsZXJ0KFwi8J+SnSDljbfljbfpooblj5bkuobvv6VcIiArIHRoaXMuY2FzaEFtb3VudCArIFwi546w6YeR5aWW5Yqx77yB5qOS5qOS5ZOS77yBXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGFsZXJ0RXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFsZXJ05pi+56S65aSx6LSlOlwiLCBhbGVydEVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgX3Jld2FyZE1nci5kZWZhdWx0LnNob3dMb3ZlU3VwcG9ydE1lc3NhZ2UoKTtcbiAgICAgICAgICAgIF9yZXdhcmRNZ3IuZGVmYXVsdC5jbGVhckNhc2hSZXdhcmRGbGFnKCk7XG4gICAgICAgICAgICB0aGlzLmhpZGVUaGlzKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyDwn5KdIOWmguaenOS4jeaYr+eOsOmHkeWlluWKseS9huacieW+heWkhOeQhuagh+iusO+8jOS5n+imgea4hemZpFxuICAgICAgICAgICAgaWYgKF9yZXdhcmRNZ3IuZGVmYXVsdC5oYXNQZW5kaW5nQ2FzaFJld2FyZCgpKSB7XG4gICAgICAgICAgICAgICAgX3Jld2FyZE1nci5kZWZhdWx0LmNsZWFyQ2FzaFJld2FyZEZsYWcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudGVtcEdldCghMSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGUucHJvdG90eXBlLm9uQWRHZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwi8J+UmCDngrnlh7vpooblj5blpZbph5HmjInpkq5cIik7XG4gICAgICAgIGNvbnNvbGUubG9nKFwi8J+UjSDlvZPliY1oYXNDYXNoUmV3YXJk54q25oCBOlwiLCB0aGlzLmhhc0Nhc2hSZXdhcmQpO1xuICAgICAgICBjb25zb2xlLmxvZyhcIvCflI0g5b2T5YmNY2FzaEFtb3VudDpcIiwgdGhpcy5jYXNoQW1vdW50KTtcbiAgICAgICAgXG4gICAgICAgIC8vIPCfkp0g5qOA5p+l5piv5ZCm5Li6546w6YeR5aWW5Yqx5qih5byPXG4gICAgICAgIGlmICh0aGlzLmhhc0Nhc2hSZXdhcmQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi8J+SsCDmiafooYznjrDph5HlpZblirHpgLvovpFcIik7XG4gICAgICAgICAgICB0aGlzLm9uR2V0Q2FzaFJld2FyZCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCLwn46uIOaJp+ihjOa4uOaIj+mBk+WFt+WlluWKsemAu+i+kVwiKTtcbiAgICAgICAgICAgIHRoaXMudGVtcEdldCghMCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGUucHJvdG90eXBlLmluaXRBZERvdEV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfZ2FtZS5kZWZhdWx0LnR5cGUgIT09IF9wSW5mby5nYW1lVHlwZS5mZXN0aXZhbCB8fCBfZmVzdGl2YWxNZ3IuZGVmYXVsdC5pbnMuaXNKaWdzYXdNYXgoKVxuICAgICAgICAgICAgPyAodGhpcy5hZEdldEJ0bi5ub2RlLmFkRG90RGF0YSA9IFwi5Li757q/5Y2B5YCN5aWW5YqxXCIpXG4gICAgICAgICAgICA6ICh0aGlzLmFkR2V0QnRuLm5vZGUuYWREb3REYXRhID0gXCLmtLvliqjljYHlgI3lpZblirFcIik7XG4gICAgfTtcblxuICAgIC8vIPCfkp0g6K6+572u546w6YeR5aWW5Yqx5pi+56S677yI5aSN55So5Y6f5pyJVUnnu5PmnoTvvIlcbiAgICBlLnByb3RvdHlwZS5zZXR1cENhc2hSZXdhcmQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi8J+UjSDlvIDlp4vmo4Dmn6XnjrDph5HlpZblirEuLi5cIik7XG4gICAgICAgICAgICAvLyDmo4Dmn6XmmK/lkKbliJrliJrojrflvpfkuobnjrDph5HlpZblirFcbiAgICAgICAgICAgIHZhciBoYXNSZWNlbnRSZXdhcmQgPSBfcmV3YXJkTWdyLmRlZmF1bHQuZ2V0TGFzdFJld2FyZEluZm8oKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi8J+OryBnZXRMYXN0UmV3YXJkSW5mb+i/lOWbnjpcIiwgaGFzUmVjZW50UmV3YXJkKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGhhc1JlY2VudFJld2FyZCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi8J+SsCDmo4DmtYvliLDnjrDph5HlpZblirE6IMKlXCIgKyBoYXNSZWNlbnRSZXdhcmQuYW1vdW50KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyDorr7nva7njrDph5HlpZblirHnirbmgIFcbiAgICAgICAgICAgICAgICB0aGlzLmhhc0Nhc2hSZXdhcmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuY2FzaEFtb3VudCA9IGhhc1JlY2VudFJld2FyZC5hbW91bnQ7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8g5L+u5pS5546w6YeR5aWW5Yqx5pi+56S677yI55So5oi35bey5bCG5Y+z5L6n5pS55Li65Y2V5LiA546w6YeR5aWW5Yqx5pi+56S677yJXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmV3M0xibCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJldzNMYmwuc3RyaW5nID0gXCIrwqVcIiArIGhhc1JlY2VudFJld2FyZC5hbW91bnQ7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi8J+SsCByZXczTGJs6K6+572u5Li6546w6YeR5aWW5YqxOiArwqVcIiArIGhhc1JlY2VudFJld2FyZC5hbW91bnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyByZXc0TGJs5bey5Yig6Zmk77yM5LiN5YaN6K6+572uXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLinIUg546w6YeR5aWW5YqxVUnlt7Lorr7nva46IFwiICsgKHRoaXMucmV3M0xibCA/IHRoaXMucmV3M0xibC5zdHJpbmcgOiBcInJldzNMYmzmnKrnu5HlrppcIikpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi4pyFIGhhc0Nhc2hSZXdhcmTnirbmgIE6XCIsIHRoaXMuaGFzQ2FzaFJld2FyZCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLinIUgY2FzaEFtb3VudDpcIiwgdGhpcy5jYXNoQW1vdW50KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLwn5KwIOaXoOeOsOmHkeWlluWKse+8jOS9v+eUqOWOn+aciemAu+i+kVwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhhc0Nhc2hSZXdhcmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvLyDmgaLlpI3ljp/mnInnmoTmuLjmiI/pgZPlhbfmmL7npLrpgLvovpHlt7Lnu4/lnKhpbml05Lit5aSE55CG5LqGXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIuKdjCDorr7nva7njrDph5HlpZblirHlpLHotKU6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIHRoaXMuaGFzQ2FzaFJld2FyZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8vIPCfkp0g6aKG5Y+W546w6YeR5aWW5YqxXG4gICAgZS5wcm90b3R5cGUub25HZXRDYXNoUmV3YXJkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIvCfkrAg54K55Ye76aKG5Y+W546w6YeR5aWW5YqxOiDCpVwiICsgdGhpcy5jYXNoQW1vdW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8g8J+SnSDnjrDph5HlnKjmuLjmiI/lrozmiJDml7blt7Lnu4/mt7vliqDkuobvvIzov5nph4zlj6rmmK/noa7orqTpooblj5ZcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8g5pi+56S65aWW5Yqx6aKG5Y+W5oiQ5Yqf5o+Q56S6XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuYWxlcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFsZXJ0KFwi8J+OiSDmga3llpzljbfljbfvvIHvv6VcIiArIHRoaXMuY2FzaEFtb3VudCArIFwi546w6YeR5aWW5Yqx5bey5oiQ5Yqf6aKG5Y+W77yBXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfdGlwTWdyID0gcmVxdWlyZShcInRpcE1nclwiKTtcbiAgICAgICAgICAgICAgICAgICAgX3RpcE1nci5kZWZhdWx0Lmlucy5zaG93VGlwKFwi5Y235Y236I635b6X77+lXCIgKyB0aGlzLmNhc2hBbW91bnQgKyBcIuWlluWKse+8gVwiLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAodGlwRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuaPkOekuuaYvuekuuWksei0pTpcIiwgdGlwRXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyDmmL7npLroj4zlrZDmlK/mjIHmtojmga9cbiAgICAgICAgICAgIF9yZXdhcmRNZ3IuZGVmYXVsdC5zaG93TG92ZVN1cHBvcnRNZXNzYWdlKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIPCfkp0g5riF6Zmk546w6YeR5aWW5Yqx5qCH6K6w77yM6Ziy5q2i56ys5LqM5qyh5by556qXXG4gICAgICAgICAgICBfcmV3YXJkTWdyLmRlZmF1bHQuY2xlYXJDYXNoUmV3YXJkRmxhZygpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyDlhbPpl63lvLnnqpdcbiAgICAgICAgICAgIHRoaXMuaGlkZVRoaXMoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLwn46JIOeOsOmHkeWlluWKseehruiupOWujOaIkO+8ge+8iOS9memineW3suWcqOa4uOaIj+WujOaIkOaXtuabtOaWsO+8iVwiKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCLinYwg6aKG5Y+W546w6YeR5aWW5Yqx5aSx6LSlOlwiLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW3koY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwicmV3MUxibFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW3koY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwicmV3MkxibFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW3koY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwicmV3M0xibFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW3koY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwicmV3NExibFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW3koY2MuQnV0dG9uKV0sIGUucHJvdG90eXBlLCBcImFkR2V0QnRuXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbeShbY2MuU3ByaXRlXSldLCBlLnByb3RvdHlwZSwgXCJ0eXBlU3BzXCIsIHZvaWQgMCk7XG4gICAgcmV0dXJuIF9fZGVjb3JhdGUoW2ddLCBlKTtcbn0pKF9iYXNlVUkuZGVmYXVsdCk7XG5leHBvcnRzLmRlZmF1bHQgPSBtO1xuIl19