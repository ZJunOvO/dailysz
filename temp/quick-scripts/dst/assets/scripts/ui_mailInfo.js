
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/ui_mailInfo.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '9f5988cQTZGpqvbdBk5aXo1', 'ui_mailInfo');
// scripts/ui_mailInfo.js

"use strict";

var n;
Object.defineProperty(exports, "__esModule", {
  value: !0
});

var _evts = require("evts");

var _item1 = require("item1");

var _mailMgr = require("mailMgr");

var _panelMgr = require("panelMgr");

var _baseUI = require("baseUI");

var p = cc._decorator;
var d = p.ccclass;
var h = p.property;

var f = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.scrollView = null;
    e.title = null;
    e.cont = null;
    e.itemPfb = null;
    e.awardNode = null;
    e.deleteNode = null;
    e._mailItem = [];
    return e;
  }

  __extends(e, t);

  e.prototype.start = function () {};

  e.prototype.init = function () {
    for (var t = [], e = 0; e < arguments.length; e++) {
      t[e] = arguments[e];
    }

    var o = t[0].id;
    this.mailId = o;
    var n = _mailMgr["default"].ins.serverMail;
    this.title.string = n[o].title;
    this.cont.string = n[o].msg;
    this.updateItem();
  };

  e.prototype.updateItem = function (t) {
    var e = this;
    void 0 === t && (t = !0);
    var o = _mailMgr["default"].ins.mailInfo.mail[this.mailId];
    var n = _mailMgr["default"].ins.serverMail;
    var i = JSON.parse(n[this.mailId].props);

    if (t) {
      for (var r in this.scrollView.content.children.forEach(function (t) {
        e._mailItem.push(t);
      }), this.scrollView.content.removeAllChildren(), i) {
        if (i.hasOwnProperty(r)) {
          var a = this._mailItem.shift() || cc.instantiate(this.itemPfb);
          this.scrollView.content.addChild(a);
          a.getComponent(_item1["default"]).init(r, i[r], o);
        }
      }

      if (this.scrollView.content.childrenCount) {
        var l = (this.scrollView.content.children[0].width + 5.5) * this.scrollView.content.childrenCount;
        this.scrollView.node.x = l > this.scrollView.node.width ? -209 : (this.scrollView.node.width - l) / 2 - 209;
        l = Math.min(l, 360);
        this.scrollView.node.width = l;
        this.scrollView.scrollToLeft();
      }
    }

    var u = Object.keys(i).length > 0;
    this.awardNode.active = u && o != _mailMgr.mailState.award;
    this.deleteNode.active = !this.awardNode.active;
  };

  e.prototype.updMail = function () {};

  e.prototype.getAward = function () {
    if (_mailMgr["default"].ins.getAward(this.mailId)) {
      for (var t = [], e = this.scrollView.content.childrenCount - 1; e >= 0; e--) {
        var o = this.scrollView.content.children[e];
        var n = o.parent.convertToWorldSpaceAR(o.position);
        var i = {};
        i.itemId = o.getComponent(_item1["default"]).key;
        i.worldPos = n;
        i.value = o.getComponent(_item1["default"]).countStr;
        t.push(i);
      }

      _panelMgr["default"].ins.open("ui/ui_flyAni", {
        itemDatas: t
      });

      this.updateItem(!1);
    }
  };

  e.prototype["delete"] = function () {
    _mailMgr["default"].ins.deleteMail(this.mailId);

    this.hideThis();

    _evts["default"].opE.emit({
      action: _evts["default"].UPDMAIL,
      data: {
        type: "delete",
        id: this.mailId
      }
    });
  };

  e.prototype.changereadState = function () {
    _mailMgr["default"].ins.readMail(this.mailId) && _evts["default"].opE.emit({
      action: _evts["default"].UPDMAIL,
      data: {
        type: "read",
        id: this.mailId
      }
    });
  };

  e.prototype.hideThis = function () {
    this.hide();
  };

  e.prototype.onHide = function () {
    this.changereadState();
  };

  __decorate([h(cc.ScrollView)], e.prototype, "scrollView", void 0);

  __decorate([h(cc.Label)], e.prototype, "title", void 0);

  __decorate([h(cc.Label)], e.prototype, "cont", void 0);

  __decorate([h(cc.Prefab)], e.prototype, "itemPfb", void 0);

  __decorate([h(cc.Node)], e.prototype, "awardNode", void 0);

  __decorate([h(cc.Node)], e.prototype, "deleteNode", void 0);

  return __decorate([d], e);
}(_baseUI["default"]);

exports["default"] = f;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcdWlfbWFpbEluZm8uanMiXSwibmFtZXMiOlsibiIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiX2V2dHMiLCJyZXF1aXJlIiwiX2l0ZW0xIiwiX21haWxNZ3IiLCJfcGFuZWxNZ3IiLCJfYmFzZVVJIiwicCIsImNjIiwiX2RlY29yYXRvciIsImQiLCJjY2NsYXNzIiwiaCIsInByb3BlcnR5IiwiZiIsInQiLCJlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJzY3JvbGxWaWV3IiwidGl0bGUiLCJjb250IiwiaXRlbVBmYiIsImF3YXJkTm9kZSIsImRlbGV0ZU5vZGUiLCJfbWFpbEl0ZW0iLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJzdGFydCIsImluaXQiLCJsZW5ndGgiLCJvIiwiaWQiLCJtYWlsSWQiLCJpbnMiLCJzZXJ2ZXJNYWlsIiwic3RyaW5nIiwibXNnIiwidXBkYXRlSXRlbSIsIm1haWxJbmZvIiwibWFpbCIsImkiLCJKU09OIiwicGFyc2UiLCJwcm9wcyIsInIiLCJjb250ZW50IiwiY2hpbGRyZW4iLCJmb3JFYWNoIiwicHVzaCIsInJlbW92ZUFsbENoaWxkcmVuIiwiaGFzT3duUHJvcGVydHkiLCJhIiwic2hpZnQiLCJpbnN0YW50aWF0ZSIsImFkZENoaWxkIiwiZ2V0Q29tcG9uZW50IiwiY2hpbGRyZW5Db3VudCIsImwiLCJ3aWR0aCIsIm5vZGUiLCJ4IiwiTWF0aCIsIm1pbiIsInNjcm9sbFRvTGVmdCIsInUiLCJrZXlzIiwiYWN0aXZlIiwibWFpbFN0YXRlIiwiYXdhcmQiLCJ1cGRNYWlsIiwiZ2V0QXdhcmQiLCJwYXJlbnQiLCJjb252ZXJ0VG9Xb3JsZFNwYWNlQVIiLCJwb3NpdGlvbiIsIml0ZW1JZCIsImtleSIsIndvcmxkUG9zIiwiY291bnRTdHIiLCJvcGVuIiwiaXRlbURhdGFzIiwiZGVsZXRlTWFpbCIsImhpZGVUaGlzIiwib3BFIiwiZW1pdCIsImFjdGlvbiIsIlVQRE1BSUwiLCJkYXRhIiwidHlwZSIsImNoYW5nZXJlYWRTdGF0ZSIsInJlYWRNYWlsIiwiaGlkZSIsIm9uSGlkZSIsIl9fZGVjb3JhdGUiLCJTY3JvbGxWaWV3IiwiTGFiZWwiLCJQcmVmYWIiLCJOb2RlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7QUFDQUMsTUFBTSxDQUFDQyxjQUFQLENBQXNCQyxPQUF0QixFQUErQixZQUEvQixFQUE2QztFQUFDQyxLQUFLLEVBQUUsQ0FBQztBQUFULENBQTdDOztBQUNBLElBQUlDLEtBQUssR0FBR0MsT0FBTyxDQUFDLE1BQUQsQ0FBbkI7O0FBQ0EsSUFBSUMsTUFBTSxHQUFHRCxPQUFPLENBQUMsT0FBRCxDQUFwQjs7QUFDQSxJQUFJRSxRQUFRLEdBQUdGLE9BQU8sQ0FBQyxTQUFELENBQXRCOztBQUNBLElBQUlHLFNBQVMsR0FBR0gsT0FBTyxDQUFDLFVBQUQsQ0FBdkI7O0FBQ0EsSUFBSUksT0FBTyxHQUFHSixPQUFPLENBQUMsUUFBRCxDQUFyQjs7QUFDQSxJQUFJSyxDQUFDLEdBQUdDLEVBQUUsQ0FBQ0MsVUFBWDtBQUNBLElBQUlDLENBQUMsR0FBR0gsQ0FBQyxDQUFDSSxPQUFWO0FBQ0EsSUFBSUMsQ0FBQyxHQUFHTCxDQUFDLENBQUNNLFFBQVY7O0FBQ0EsSUFBSUMsQ0FBQyxHQUFJLFVBQVVDLENBQVYsRUFBYTtFQUNsQixTQUFTQyxDQUFULEdBQWE7SUFDVCxJQUFJQSxDQUFDLEdBQUksU0FBU0QsQ0FBVCxJQUFjQSxDQUFDLENBQUNFLEtBQUYsQ0FBUSxJQUFSLEVBQWNDLFNBQWQsQ0FBZixJQUE0QyxJQUFwRDtJQUNBRixDQUFDLENBQUNHLFVBQUYsR0FBZSxJQUFmO0lBQ0FILENBQUMsQ0FBQ0ksS0FBRixHQUFVLElBQVY7SUFDQUosQ0FBQyxDQUFDSyxJQUFGLEdBQVMsSUFBVDtJQUNBTCxDQUFDLENBQUNNLE9BQUYsR0FBWSxJQUFaO0lBQ0FOLENBQUMsQ0FBQ08sU0FBRixHQUFjLElBQWQ7SUFDQVAs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RSxDQUFDd0YsTUFBSixDQUFGLENBQUQsRUFBaUJoRixDQUFDLENBQUNXLFNBQW5CLEVBQThCLFNBQTlCLEVBQXlDLEtBQUssQ0FBOUMsQ0FBVjs7RUFDQWtFLFVBQVUsQ0FBQyxDQUFDakYsQ0FBQyxDQUFDSixFQUFFLENBQUN5RixJQUFKLENBQUYsQ0FBRCxFQUFlakYsQ0FBQyxDQUFDVyxTQUFqQixFQUE0QixXQUE1QixFQUF5QyxLQUFLLENBQTlDLENBQVY7O0VBQ0FrRSxVQUFVLENBQUMsQ0FBQ2pGLENBQUMsQ0FBQ0osRUFBRSxDQUFDeUYsSUFBSixDQUFGLENBQUQsRUFBZWpGLENBQUMsQ0FBQ1csU0FBakIsRUFBNEIsWUFBNUIsRUFBMEMsS0FBSyxDQUEvQyxDQUFWOztFQUNBLE9BQU9rRSxVQUFVLENBQUMsQ0FBQ25GLENBQUQsQ0FBRCxFQUFNTSxDQUFOLENBQWpCO0FBQ0gsQ0EzRk8sQ0EyRkxWLE9BQU8sV0EzRkYsQ0FBUjs7QUE0RkFQLE9BQU8sV0FBUCxHQUFrQmUsQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBuO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7dmFsdWU6ICEwfSk7XG52YXIgX2V2dHMgPSByZXF1aXJlKFwiZXZ0c1wiKTtcbnZhciBfaXRlbTEgPSByZXF1aXJlKFwiaXRlbTFcIik7XG52YXIgX21haWxNZ3IgPSByZXF1aXJlKFwibWFpbE1nclwiKTtcbnZhciBfcGFuZWxNZ3IgPSByZXF1aXJlKFwicGFuZWxNZ3JcIik7XG52YXIgX2Jhc2VVSSA9IHJlcXVpcmUoXCJiYXNlVUlcIik7XG52YXIgcCA9IGNjLl9kZWNvcmF0b3I7XG52YXIgZCA9IHAuY2NjbGFzcztcbnZhciBoID0gcC5wcm9wZXJ0eTtcbnZhciBmID0gKGZ1bmN0aW9uICh0KSB7XG4gICAgZnVuY3Rpb24gZSgpIHtcbiAgICAgICAgdmFyIGUgPSAobnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIHx8IHRoaXM7XG4gICAgICAgIGUuc2Nyb2xsVmlldyA9IG51bGw7XG4gICAgICAgIGUudGl0bGUgPSBudWxsO1xuICAgICAgICBlLmNvbnQgPSBudWxsO1xuICAgICAgICBlLml0ZW1QZmIgPSBudWxsO1xuICAgICAgICBlLmF3YXJkTm9kZSA9IG51bGw7XG4gICAgICAgIGUuZGVsZXRlTm9kZSA9IG51bGw7XG4gICAgICAgIGUuX21haWxJdGVtID0gW107XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICBfX2V4dGVuZHMoZSwgdCk7XG4gICAgZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7fTtcbiAgICBlLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciB0ID0gW10sIGUgPSAwOyBlIDwgYXJndW1lbnRzLmxlbmd0aDsgZSsrKSB0W2VdID0gYXJndW1lbnRzW2VdO1xuICAgICAgICB2YXIgbyA9IHRbMF0uaWQ7XG4gICAgICAgIHRoaXMubWFpbElkID0gbztcbiAgICAgICAgdmFyIG4gPSBfbWFpbE1nci5kZWZhdWx0Lmlucy5zZXJ2ZXJNYWlsO1xuICAgICAgICB0aGlzLnRpdGxlLnN0cmluZyA9IG5bb10udGl0bGU7XG4gICAgICAgIHRoaXMuY29udC5zdHJpbmcgPSBuW29dLm1zZztcbiAgICAgICAgdGhpcy51cGRhdGVJdGVtKCk7XG4gICAgfTtcbiAgICBlLnByb3RvdHlwZS51cGRhdGVJdGVtID0gZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgdmFyIGUgPSB0aGlzO1xuICAgICAgICB2b2lkIDAgPT09IHQgJiYgKHQgPSAhMCk7XG4gICAgICAgIHZhciBvID0gX21haWxNZ3IuZGVmYXVsdC5pbnMubWFpbEluZm8ubWFpbFt0aGlzLm1haWxJZF07XG4gICAgICAgIHZhciBuID0gX21haWxNZ3IuZGVmYXVsdC5pbnMuc2VydmVyTWFpbDtcbiAgICAgICAgdmFyIGkgPSBKU09OLnBhcnNlKG5bdGhpcy5tYWlsSWRdLnByb3BzKTtcbiAgICAgICAgaWYgKHQpIHtcbiAgICAgICAgICAgIGZvciAodmFyIHIgaW4gKHRoaXMuc2Nyb2xsVmlldy5jb250ZW50LmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgICAgICBlLl9tYWlsSXRlbS5wdXNoKHQpO1xuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB0aGlzLnNjcm9sbFZpZXcuY29udGVudC5yZW1vdmVBbGxDaGlsZHJlbigpLFxuICAgICAgICAgICAgaSkpXG4gICAgICAgICAgICAgICAgaWYgKGkuaGFzT3duUHJvcGVydHkocikpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLl9tYWlsSXRlbS5zaGlmdCgpIHx8IGNjLmluc3RhbnRpYXRlKHRoaXMuaXRlbVBmYik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsVmlldy5jb250ZW50LmFkZENoaWxkKGEpO1xuICAgICAgICAgICAgICAgICAgICBhLmdldENvbXBvbmVudChfaXRlbTEuZGVmYXVsdCkuaW5pdChyLCBpW3JdLCBvKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5zY3JvbGxWaWV3LmNvbnRlbnQuY2hpbGRyZW5Db3VudCkge1xuICAgICAgICAgICAgICAgIHZhciBsID0gKHRoaXMuc2Nyb2xsVmlldy5jb250ZW50LmNoaWxkcmVuWzBdLndpZHRoICsgNS41KSAqIHRoaXMuc2Nyb2xsVmlldy5jb250ZW50LmNoaWxkcmVuQ291bnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxWaWV3Lm5vZGUueCA9XG4gICAgICAgICAgICAgICAgICAgIGwgPiB0aGlzLnNjcm9sbFZpZXcubm9kZS53aWR0aCA/IC0yMDkgOiAodGhpcy5zY3JvbGxWaWV3Lm5vZGUud2lkdGggLSBsKSAvIDIgLSAyMDk7XG4gICAgICAgICAgICAgICAgbCA9IE1hdGgubWluKGwsIDM2MCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxWaWV3Lm5vZGUud2lkdGggPSBsO1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsVmlldy5zY3JvbGxUb0xlZnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgdSA9IE9iamVjdC5rZXlzKGkpLmxlbmd0aCA+IDA7XG4gICAgICAgIHRoaXMuYXdhcmROb2RlLmFjdGl2ZSA9IHUgJiYgbyAhPSBfbWFpbE1nci5tYWlsU3RhdGUuYXdhcmQ7XG4gICAgICAgIHRoaXMuZGVsZXRlTm9kZS5hY3RpdmUgPSAhdGhpcy5hd2FyZE5vZGUuYWN0aXZlO1xuICAgIH07XG4gICAgZS5wcm90b3R5cGUudXBkTWFpbCA9IGZ1bmN0aW9uICgpIHt9O1xuICAgIGUucHJvdG90eXBlLmdldEF3YXJkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoX21haWxNZ3IuZGVmYXVsdC5pbnMuZ2V0QXdhcmQodGhpcy5tYWlsSWQpKSB7XG4gICAgICAgICAgICBmb3IgKHZhciB0ID0gW10sIGUgPSB0aGlzLnNjcm9sbFZpZXcuY29udGVudC5jaGlsZHJlbkNvdW50IC0gMTsgZSA+PSAwOyBlLS0pIHtcbiAgICAgICAgICAgICAgICB2YXIgbyA9IHRoaXMuc2Nyb2xsVmlldy5jb250ZW50LmNoaWxkcmVuW2VdO1xuICAgICAgICAgICAgICAgIHZhciBuID0gby5wYXJlbnQuY29udmVydFRvV29ybGRTcGFjZUFSKG8ucG9zaXRpb24pO1xuICAgICAgICAgICAgICAgIHZhciBpID0ge307XG4gICAgICAgICAgICAgICAgaS5pdGVtSWQgPSBvLmdldENvbXBvbmVudChfaXRlbTEuZGVmYXVsdCkua2V5O1xuICAgICAgICAgICAgICAgIGkud29ybGRQb3MgPSBuO1xuICAgICAgICAgICAgICAgIGkudmFsdWUgPSBvLmdldENvbXBvbmVudChfaXRlbTEuZGVmYXVsdCkuY291bnRTdHI7XG4gICAgICAgICAgICAgICAgdC5wdXNoKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3BhbmVsTWdyLmRlZmF1bHQuaW5zLm9wZW4oXCJ1aS91aV9mbHlBbmlcIiwge2l0ZW1EYXRhczogdH0pO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVJdGVtKCExKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgZS5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfbWFpbE1nci5kZWZhdWx0Lmlucy5kZWxldGVNYWlsKHRoaXMubWFpbElkKTtcbiAgICAgICAgdGhpcy5oaWRlVGhpcygpO1xuICAgICAgICBfZXZ0cy5kZWZhdWx0Lm9wRS5lbWl0KHthY3Rpb246IF9ldnRzLmRlZmF1bHQuVVBETUFJTCwgZGF0YToge3R5cGU6IFwiZGVsZXRlXCIsIGlkOiB0aGlzLm1haWxJZH19KTtcbiAgICB9O1xuICAgIGUucHJvdG90eXBlLmNoYW5nZXJlYWRTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX21haWxNZ3IuZGVmYXVsdC5pbnMucmVhZE1haWwodGhpcy5tYWlsSWQpICYmXG4gICAgICAgICAgICBfZXZ0cy5kZWZhdWx0Lm9wRS5lbWl0KHthY3Rpb246IF9ldnRzLmRlZmF1bHQuVVBETUFJTCwgZGF0YToge3R5cGU6IFwicmVhZFwiLCBpZDogdGhpcy5tYWlsSWR9fSk7XG4gICAgfTtcbiAgICBlLnByb3RvdHlwZS5oaWRlVGhpcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5oaWRlKCk7XG4gICAgfTtcbiAgICBlLnByb3RvdHlwZS5vbkhpZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlcmVhZFN0YXRlKCk7XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtoKGNjLlNjcm9sbFZpZXcpXSwgZS5wcm90b3R5cGUsIFwic2Nyb2xsVmlld1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW2goY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwidGl0bGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtoKGNjLkxhYmVsKV0sIGUucHJvdG90eXBlLCBcImNvbnRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtoKGNjLlByZWZhYildLCBlLnByb3RvdHlwZSwgXCJpdGVtUGZiXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbaChjYy5Ob2RlKV0sIGUucHJvdG90eXBlLCBcImF3YXJkTm9kZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW2goY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJkZWxldGVOb2RlXCIsIHZvaWQgMCk7XG4gICAgcmV0dXJuIF9fZGVjb3JhdGUoW2RdLCBlKTtcbn0pKF9iYXNlVUkuZGVmYXVsdCk7XG5leHBvcnRzLmRlZmF1bHQgPSBmO1xuIl19