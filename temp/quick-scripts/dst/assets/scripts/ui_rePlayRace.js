
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/ui_rePlayRace.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'c4091qoo9VDMa2r6HVCvPb+', 'ui_rePlayRace');
// scripts/ui_rePlayRace.js

"use strict";

var n;
Object.defineProperty(exports, "__esModule", {
  value: !0
});

var _uData = require("uData");

var _lang = require("lang");

var _rankMgr = require("rankMgr");

var _raceRankItem = require("raceRankItem");

var _ui_rePlay = require("ui_rePlay");

var h = cc._decorator;
var f = h.ccclass;
var g = h.property;

var y = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.scrollRank = null;
    e.selfRank = null;
    e.idxIconArr = [];
    e.rankLb = null;
    e.rankItem = null;
    e.rankLength = 10;
    return e;
  }

  __extends(e, t);

  e.prototype.onLoad = function () {
    t.prototype.onLoad.call(this);
    this.rankLb.string = _lang.lang[40003];
    this.rankItem = this.scrollRank.content.children[0];
  };

  e.prototype.init = function (e) {
    var o = e.curScore;
    var n = e.continueCb;
    return __awaiter(this, void 0, void 0, function () {
      var e;
      var i;
      var r;
      var a;
      var l;
      var d;
      var h;
      var f;
      var g;
      var y;
      var m;
      var v;

      var _;

      var b;
      var w = this;
      return __generator(this, function (s) {
        switch (s.label) {
          case 0:
            return t.prototype.init.call(this, {
              curScore: o,
              continueCb: n
            }), [4, _rankMgr["default"].ins.getYdayRaceData()];

          case 1:
            for (e = s.sent(), i = [], e.data && (i = [].concat(e.data)), r = this.rankLength - 1, a = this.getRandomScoreArr(), l = [], d = _uData["default"].ins, h = {
              nick: d.getName(),
              score: o,
              idx: "",
              headUrl: d.getHeadImg()
            }, i.sort(function () {
              return Math.random() - 0.5;
            }), f = 0, g = 0; g < i.length && !(g >= r); g++) {
              y = i[g], m = d.getUid(), y.game_uid != m && (f++, l.push({
                nick: y.nickname,
                score: a[g].toString(),
                idx: "",
                headUrl: y.avatar
              }));
            }

            if (l.length < r) for (v = r - l.length, _ = 0; _ < v; _++) {
              b = "卷卷大王" + this.getRandString(), l.push({
                nick: b,
                score: a[f + _].toString(),
                idx: "",
                headUrl: ""
              });
            }
            return l.push(h), l.sort(function (t, e) {
              return parseInt(e.score) - parseInt(t.score);
            }), l.forEach(function (t, e) {
              t.idx = (e + 1).toString();
              var o = null;
              w.scrollRank.content.childrenCount > e ? o = w.scrollRank.content.children[e] : (o = cc.instantiate(w.rankItem), w.scrollRank.content.addChild(o));
              o.x = (cc.winSize.width + o.width) / 2;
              w.scheduleOnce(function () {
                w.showLoadAni(o);
              }, 0.05 * e);
              o.getComponent(_raceRankItem["default"]).initItem(t, w.idxIconArr[e]);
            }), this.selfRank.getComponent(_raceRankItem["default"]).initItem(h, this.idxIconArr[h.idx]), [2];
        }
      });
    });
  };

  e.prototype.showLoadAni = function (t) {
    cc.tween(t).to(0.5, {
      x: 0
    }, {
      easing: "backInOut"
    }).start();
  };

  e.prototype.getRandomScoreArr = function () {
    for (var t = [], e = this.rankLength - 1, o = 0; o < e; o++) {
      var n = void 0;
      var i = void 0;
      o < 7 ? (n = 100 * (7 - o), i = 100 * (8 - o)) : o >= 7 && o <= 8 && (n = -20 * (o - 8), i = -80 * o + 660);
      var r = Math.floor(Math.random() * (i - n)) + n;
      t.push(r);
    }

    return t;
  };

  e.prototype.getRandString = function () {
    for (var t = [], e = 0; e < 4; e++) {
      var o;
      var n = Math.floor(3 * Math.random());
      o = 0 === n ? Math.floor(26 * Math.random()) + 65 : 1 === n ? Math.floor(26 * Math.random()) + 97 : Math.floor(10 * Math.random()) + 48;
      t.push(o);
    }

    return String.fromCharCode.apply(String, t);
  };

  __decorate([g(cc.ScrollView)], e.prototype, "scrollRank", void 0);

  __decorate([g(_raceRankItem["default"])], e.prototype, "selfRank", void 0);

  __decorate([g([cc.SpriteFrame])], e.prototype, "idxIconArr", void 0);

  __decorate([g(cc.Label)], e.prototype, "rankLb", void 0);

  return __decorate([f], e);
}(_ui_rePlay["default"]);

exports["default"] = y;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcdWlfcmVQbGF5UmFjZS5qcyJdLCJuYW1lcyI6WyJuIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJfdURhdGEiLCJyZXF1aXJlIiwiX2xhbmciLCJfcmFua01nciIsIl9yYWNlUmFua0l0ZW0iLCJfdWlfcmVQbGF5IiwiaCIsImNjIiwiX2RlY29yYXRvciIsImYiLCJjY2NsYXNzIiwiZyIsInByb3BlcnR5IiwieSIsInQiLCJlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJzY3JvbGxSYW5rIiwic2VsZlJhbmsiLCJpZHhJY29uQXJyIiwicmFua0xiIiwicmFua0l0ZW0iLCJyYW5rTGVuZ3RoIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwib25Mb2FkIiwiY2FsbCIsInN0cmluZyIsImxhbmciLCJjb250ZW50IiwiY2hpbGRyZW4iLCJpbml0IiwibyIsImN1clNjb3JlIiwiY29udGludWVDYiIsIl9fYXdhaXRlciIsImkiLCJyIiwiYSIsImwiLCJkIiwibSIsInYiLCJfIiwiYiIsInciLCJfX2dlbmVyYXRvciIsInMiLCJsYWJlbCIsImlucyIsImdldFlkYXlSYWNlRGF0YSIsInNlbnQiLCJkYXRhIiwiY29uY2F0IiwiZ2V0UmFuZG9tU2NvcmVBcnIiLCJuaWNrIiwiZ2V0TmFtZSIsInNjb3JlIiwiaWR4IiwiaGVhZFVybCIsImdldEhlYWRJbWciLCJzb3J0IiwiTWF0aCIsInJhbmRvbSIsImxlbmd0aCIsImdldFVpZCIsImdhbWVfdWlkIiwicHVzaCIsIm5pY2tuYW1lIiwidG9TdHJpbmciLCJhdmF0YXIiLCJnZXRSYW5kU3RyaW5nIiwicGFyc2VJbnQiLCJmb3JFYWNoIiwiY2hpbGRyZW5Db3VudCIsImluc3RhbnRpYXRlIiwiYWRkQ2hpbGQiLCJ4Iiwid2luU2l6ZSIsIndpZHRoIiwic2NoZWR1bGVPbmNlIiwic2hvd0xvYWRBbmkiLCJnZXRDb21wb25lbnQiLCJpbml0SXRlbSIsInR3ZWVuIiwidG8iLCJlYXNpbmciLCJzdGFydCIsImZsb29yIiwiU3RyaW5nIiwiZnJvbUNoYXJDb2RlIiwiX19kZWNvcmF0ZSIsIlNjcm9sbFZpZXciLCJTcHJpdGVGcmFtZSIsIkxhYmVsIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7QUFDQUMsTUFBTSxDQUFDQyxjQUFQLENBQXNCQyxPQUF0QixFQUErQixZQUEvQixFQUE2QztFQUFDQyxLQUFLLEVBQUUsQ0FBQztBQUFULENBQTdDOztBQUNBLElBQUlDLE1BQU0sR0FBR0MsT0FBTyxDQUFDLE9BQUQsQ0FBcEI7O0FBQ0EsSUFBSUMsS0FBSyxHQUFHRCxPQUFPLENBQUMsTUFBRCxDQUFuQjs7QUFDQSxJQUFJRSxRQUFRLEdBQUdGLE9BQU8sQ0FBQyxTQUFELENBQXRCOztBQUNBLElBQUlHLGFBQWEsR0FBR0gsT0FBTyxDQUFDLGNBQUQsQ0FBM0I7O0FBQ0EsSUFBSUksVUFBVSxHQUFHSixPQUFPLENBQUMsV0FBRCxDQUF4Qjs7QUFDQSxJQUFJSyxDQUFDLEdBQUdDLEVBQUUsQ0FBQ0MsVUFBWDtBQUNBLElBQUlDLENBQUMsR0FBR0gsQ0FBQyxDQUFDSSxPQUFWO0FBQ0EsSUFBSUMsQ0FBQyxHQUFHTCxDQUFDLENBQUNNLFFBQVY7O0FBQ0EsSUFBSUMsQ0FBQyxHQUFJLFVBQVVDLENBQVYsRUFBYTtFQUNsQixTQUFTQyxDQUFULEdBQWE7SUFDVCxJQUFJQSxDQUFDLEdBQUksU0FBU0QsQ0FBVCxJQUFjQSxDQUFDLENBQUNFLEtBQUYsQ0FBUSxJQUFSLEVBQWNDLFNBQWQsQ0FBZixJQUE0QyxJQUFwRDtJQUNBRixDQUFDLENBQUNHLFVBQUYsR0FBZSxJQUFmO0lBQ0FILENBQUMsQ0FBQ0ksUUFBRixHQUFhLElBQWI7SUFDQUosQ0FBQyxDQUFDSyxVQUFGLEdBQWUsRUFBZjtJQUNBTCxDQUFDLENBQUNNLE1BQUYsR0FBVyxJQUFYO0lBQ0FOLENBQUMsQ0FBQ08sUUFBRixHQUFhLElBQWI7SUFDQVAsQ0FBQyxDQUFDUSxV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QW1FLFVBQVUsQ0FBQyxDQUFDakYsQ0FBQyxDQUFDLENBQUNKLEVBQUUsQ0FBQ3VGLFdBQUosQ0FBRCxDQUFGLENBQUQsRUFBd0IvRSxDQUFDLENBQUNVLFNBQTFCLEVBQXFDLFlBQXJDLEVBQW1ELEtBQUssQ0FBeEQsQ0FBVjs7RUFDQW1FLFVBQVUsQ0FBQyxDQUFDakYsQ0FBQyxDQUFDSixFQUFFLENBQUN3RixLQUFKLENBQUYsQ0FBRCxFQUFnQmhGLENBQUMsQ0FBQ1UsU0FBbEIsRUFBNkIsUUFBN0IsRUFBdUMsS0FBSyxDQUE1QyxDQUFWOztFQUNBLE9BQU9tRSxVQUFVLENBQUMsQ0FBQ25GLENBQUQsQ0FBRCxFQUFNTSxDQUFOLENBQWpCO0FBQ0gsQ0FoSU8sQ0FnSUxWLFVBQVUsV0FoSUwsQ0FBUjs7QUFpSUFQLE9BQU8sV0FBUCxHQUFrQmUsQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBuO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7dmFsdWU6ICEwfSk7XG52YXIgX3VEYXRhID0gcmVxdWlyZShcInVEYXRhXCIpO1xudmFyIF9sYW5nID0gcmVxdWlyZShcImxhbmdcIik7XG52YXIgX3JhbmtNZ3IgPSByZXF1aXJlKFwicmFua01nclwiKTtcbnZhciBfcmFjZVJhbmtJdGVtID0gcmVxdWlyZShcInJhY2VSYW5rSXRlbVwiKTtcbnZhciBfdWlfcmVQbGF5ID0gcmVxdWlyZShcInVpX3JlUGxheVwiKTtcbnZhciBoID0gY2MuX2RlY29yYXRvcjtcbnZhciBmID0gaC5jY2NsYXNzO1xudmFyIGcgPSBoLnByb3BlcnR5O1xudmFyIHkgPSAoZnVuY3Rpb24gKHQpIHtcbiAgICBmdW5jdGlvbiBlKCkge1xuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcbiAgICAgICAgZS5zY3JvbGxSYW5rID0gbnVsbDtcbiAgICAgICAgZS5zZWxmUmFuayA9IG51bGw7XG4gICAgICAgIGUuaWR4SWNvbkFyciA9IFtdO1xuICAgICAgICBlLnJhbmtMYiA9IG51bGw7XG4gICAgICAgIGUucmFua0l0ZW0gPSBudWxsO1xuICAgICAgICBlLnJhbmtMZW5ndGggPSAxMDtcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcbiAgICBlLnByb3RvdHlwZS5vbkxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHQucHJvdG90eXBlLm9uTG9hZC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLnJhbmtMYi5zdHJpbmcgPSBfbGFuZy5sYW5nWzQwMDAzXTtcbiAgICAgICAgdGhpcy5yYW5rSXRlbSA9IHRoaXMuc2Nyb2xsUmFuay5jb250ZW50LmNoaWxkcmVuWzBdO1xuICAgIH07XG4gICAgZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBvID0gZS5jdXJTY29yZTtcbiAgICAgICAgdmFyIG4gPSBlLmNvbnRpbnVlQ2I7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBlO1xuICAgICAgICAgICAgdmFyIGk7XG4gICAgICAgICAgICB2YXIgcjtcbiAgICAgICAgICAgIHZhciBhO1xuICAgICAgICAgICAgdmFyIGw7XG4gICAgICAgICAgICB2YXIgZDtcbiAgICAgICAgICAgIHZhciBoO1xuICAgICAgICAgICAgdmFyIGY7XG4gICAgICAgICAgICB2YXIgZztcbiAgICAgICAgICAgIHZhciB5O1xuICAgICAgICAgICAgdmFyIG07XG4gICAgICAgICAgICB2YXIgdjtcbiAgICAgICAgICAgIHZhciBfO1xuICAgICAgICAgICAgdmFyIGI7XG4gICAgICAgICAgICB2YXIgdyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHMubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnByb3RvdHlwZS5pbml0LmNhbGwodGhpcywge2N1clNjb3JlOiBvLCBjb250aW51ZUNiOiBufSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgWzQsIF9yYW5rTWdyLmRlZmF1bHQuaW5zLmdldFlkYXlSYWNlRGF0YSgpXVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gcy5zZW50KCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5kYXRhICYmIChpID0gW10uY29uY2F0KGUuZGF0YSkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gdGhpcy5yYW5rTGVuZ3RoIC0gMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IHRoaXMuZ2V0UmFuZG9tU2NvcmVBcnIoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbCA9IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkID0gX3VEYXRhLmRlZmF1bHQuaW5zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0ge25pY2s6IGQuZ2V0TmFtZSgpLCBzY29yZTogbywgaWR4OiBcIlwiLCBoZWFkVXJsOiBkLmdldEhlYWRJbWcoKX0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuc29ydChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5yYW5kb20oKSAtIDAuNTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnIDwgaS5sZW5ndGggJiYgIShnID49IHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcrK1xuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICh5ID0gaVtnXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChtID0gZC5nZXRVaWQoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkuZ2FtZV91aWQgIT0gbSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGYrKyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwucHVzaCh7bmljazogeS5uaWNrbmFtZSwgc2NvcmU6IGFbZ10udG9TdHJpbmcoKSwgaWR4OiBcIlwiLCBoZWFkVXJsOiB5LmF2YXRhcn0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsLmxlbmd0aCA8IHIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2ID0gciAtIGwubGVuZ3RoLCBfID0gMDsgXyA8IHY7IF8rKylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGIgPSBcIuWNt+WNt+Wkp+eOi1wiICsgdGhpcy5nZXRSYW5kU3RyaW5nKCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbC5wdXNoKHtuaWNrOiBiLCBzY29yZTogYVtmICsgX10udG9TdHJpbmcoKSwgaWR4OiBcIlwiLCBoZWFkVXJsOiBcIlwifSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwucHVzaChoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsLnNvcnQoZnVuY3Rpb24gKHQsIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KGUuc2NvcmUpIC0gcGFyc2VJbnQodC5zY29yZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbC5mb3JFYWNoKGZ1bmN0aW9uICh0LCBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuaWR4ID0gKGUgKyAxKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbyA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHcuc2Nyb2xsUmFuay5jb250ZW50LmNoaWxkcmVuQ291bnQgPiBlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IChvID0gdy5zY3JvbGxSYW5rLmNvbnRlbnQuY2hpbGRyZW5bZV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICgobyA9IGNjLmluc3RhbnRpYXRlKHcucmFua0l0ZW0pKSwgdy5zY3JvbGxSYW5rLmNvbnRlbnQuYWRkQ2hpbGQobykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLnggPSAoY2Mud2luU2l6ZS53aWR0aCArIG8ud2lkdGgpIC8gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdy5zaG93TG9hZEFuaShvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMC4wNSAqIGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLmdldENvbXBvbmVudChfcmFjZVJhbmtJdGVtLmRlZmF1bHQpLmluaXRJdGVtKHQsIHcuaWR4SWNvbkFycltlXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxmUmFuay5nZXRDb21wb25lbnQoX3JhY2VSYW5rSXRlbS5kZWZhdWx0KS5pbml0SXRlbShoLCB0aGlzLmlkeEljb25BcnJbaC5pZHhdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMl1cbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgZS5wcm90b3R5cGUuc2hvd0xvYWRBbmkgPSBmdW5jdGlvbiAodCkge1xuICAgICAgICBjYy50d2Vlbih0KS50bygwLjUsIHt4OiAwfSwge2Vhc2luZzogXCJiYWNrSW5PdXRcIn0pLnN0YXJ0KCk7XG4gICAgfTtcbiAgICBlLnByb3RvdHlwZS5nZXRSYW5kb21TY29yZUFyciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgdCA9IFtdLCBlID0gdGhpcy5yYW5rTGVuZ3RoIC0gMSwgbyA9IDA7IG8gPCBlOyBvKyspIHtcbiAgICAgICAgICAgIHZhciBuID0gdm9pZCAwO1xuICAgICAgICAgICAgdmFyIGkgPSB2b2lkIDA7XG4gICAgICAgICAgICBvIDwgN1xuICAgICAgICAgICAgICAgID8gKChuID0gMTAwICogKDcgLSBvKSksIChpID0gMTAwICogKDggLSBvKSkpXG4gICAgICAgICAgICAgICAgOiBvID49IDcgJiYgbyA8PSA4ICYmICgobiA9IC0yMCAqIChvIC0gOCkpLCAoaSA9IC04MCAqIG8gKyA2NjApKTtcbiAgICAgICAgICAgIHZhciByID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKGkgLSBuKSkgKyBuO1xuICAgICAgICAgICAgdC5wdXNoKHIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0O1xuICAgIH07XG4gICAgZS5wcm90b3R5cGUuZ2V0UmFuZFN0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgdCA9IFtdLCBlID0gMDsgZSA8IDQ7IGUrKykge1xuICAgICAgICAgICAgdmFyIG87XG4gICAgICAgICAgICB2YXIgbiA9IE1hdGguZmxvb3IoMyAqIE1hdGgucmFuZG9tKCkpO1xuICAgICAgICAgICAgbyA9XG4gICAgICAgICAgICAgICAgMCA9PT0gblxuICAgICAgICAgICAgICAgICAgICA/IE1hdGguZmxvb3IoMjYgKiBNYXRoLnJhbmRvbSgpKSArIDY1XG4gICAgICAgICAgICAgICAgICAgIDogMSA9PT0gblxuICAgICAgICAgICAgICAgICAgICA/IE1hdGguZmxvb3IoMjYgKiBNYXRoLnJhbmRvbSgpKSArIDk3XG4gICAgICAgICAgICAgICAgICAgIDogTWF0aC5mbG9vcigxMCAqIE1hdGgucmFuZG9tKCkpICsgNDg7XG4gICAgICAgICAgICB0LnB1c2gobyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoU3RyaW5nLCB0KTtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW2coY2MuU2Nyb2xsVmlldyldLCBlLnByb3RvdHlwZSwgXCJzY3JvbGxSYW5rXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbZyhfcmFjZVJhbmtJdGVtLmRlZmF1bHQpXSwgZS5wcm90b3R5cGUsIFwic2VsZlJhbmtcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtnKFtjYy5TcHJpdGVGcmFtZV0pXSwgZS5wcm90b3R5cGUsIFwiaWR4SWNvbkFyclwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW2coY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwicmFua0xiXCIsIHZvaWQgMCk7XG4gICAgcmV0dXJuIF9fZGVjb3JhdGUoW2ZdLCBlKTtcbn0pKF91aV9yZVBsYXkuZGVmYXVsdCk7XG5leHBvcnRzLmRlZmF1bHQgPSB5O1xuIl19