{"version":3,"sources":["assets\\scripts\\chapterItem.js"],"names":["n","Object","defineProperty","exports","value","_evts","require","_idx","_global","_levelMgr","_panelMgr","_pInfo","d","cc","_decorator","h","ccclass","f","property","g","t","e","apply","arguments","nameLbl","pro","proLbl","goBtn","pics","grayMater","normalMater","__extends","prototype","init","o","posObj","_chapter","string","ins","getPuzzleLvl","progress","i","levelDone","r","Math","floor","getchapterBunder","then","getJigsawIcon","spriteFrame","setMaterial","console","error","updPro","tween","to","start","unuse","reuse","onEnable","onDisable","onGoBtn","platform","showLoading","levelTmp","updateTmpData","hideLoading","closeAllPanel","opE","emit","action","UPDATA_LEVEL_TMP","onDestroy","assetManager","releaseAsset","get","SpriteFrame","__decorate","Label","ProgressBar","Button","Sprite","Material","Component"],"mappings":"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","sourceRoot":"/","sourcesContent":["var n;\nObject.defineProperty(exports, \"__esModule\", {value: !0});\nvar _evts = require(\"evts\");\nvar _idx = require(\"idx\");\nvar _global = require(\"global\");\nvar _levelMgr = require(\"levelMgr\");\nvar _panelMgr = require(\"panelMgr\");\nvar _pInfo = require(\"pInfo\");\nvar d = cc._decorator;\nvar h = d.ccclass;\nvar f = d.property;\nvar g = (function (t) {\n    function e() {\n        var e = (null !== t && t.apply(this, arguments)) || this;\n        e.nameLbl = null;\n        e.pro = null;\n        e.proLbl = null;\n        e.goBtn = null;\n        e.pics = [];\n        e.grayMater = null;\n        e.normalMater = null;\n        return e;\n    }\n    __extends(e, t);\n    e.prototype.init = function (t, e) {\n        var o = this;\n        this.posObj = e;\n        this._chapter = t;\n        this.nameLbl.string = \"第\" + t + \"章\";\n        var n = _pInfo.default.ins.getPuzzleLvl();\n        this.pro.progress = 0;\n        var i = n - (54 * (this._chapter - 1) + 1);\n        i = i < 0 ? 0 : i;\n        _global.default.levelDone && (i = 54);\n        var r = 0;\n        i > 0 && (r = Math.floor(i / 9));\n        n > 54 * this._chapter && ((r = 6), (i = 54));\n        _levelMgr.default.ins\n            .getchapterBunder()\n            .then(function () {\n                for (\n                    var t = \"\" + (100 + o._chapter),\n                        e = function (e) {\n                            _levelMgr.default.ins\n                                .getJigsawIcon(e, t)\n                                .then(function (t) {\n                                    t &&\n                                        ((o.pics[e - 1].spriteFrame = t),\n                                        e <= r\n                                            ? o.pics[e - 1].setMaterial(0, o.normalMater)\n                                            : o.pics[e - 1].setMaterial(0, o.grayMater));\n                                })\n                                .catch(function () {\n                                    console.error(\"getJigsawIconErr\");\n                                });\n                        },\n                        n = 1;\n                    n <= 6;\n                    n++\n                )\n                    e(n);\n            })\n            .catch(function () {\n                console.error(\"getChapterBundleErr\");\n            });\n        this.updPro();\n    };\n    e.prototype.updPro = function () {\n        if (this._chapter) {\n            var t = _pInfo.default.ins.getPuzzleLvl();\n            this.pro.progress = 0;\n            var e = t - (54 * (this._chapter - 1) + 1);\n            e = (e = e < 0 ? 0 : e) > 54 ? 54 : e;\n            cc.tween(this.pro)\n                .to(0.5, {progress: e / 54})\n                .start();\n            this.proLbl.string = e + \"/54\";\n        }\n    };\n    e.prototype.unuse = function () {};\n    e.prototype.reuse = function () {};\n    e.prototype.onEnable = function () {};\n    e.prototype.onDisable = function () {};\n    e.prototype.onGoBtn = function () {\n        _idx.platform.showLoading();\n        var t = (_global.default.levelTmp = this._chapter);\n        _levelMgr.default.ins.updateTmpData(t).then(function () {\n            _idx.platform.hideLoading();\n            _panelMgr.default.ins.closeAllPanel();\n            _evts.default.opE.emit({action: _evts.default.UPDATA_LEVEL_TMP});\n        });\n    };\n    e.prototype.onDestroy = function () {\n        var t = \"\" + (100 + this._chapter);\n        _levelMgr.default.ins\n            .getchapterBunder()\n            .then(function (e) {\n                cc.assetManager.releaseAsset(e.get(t + \"/chapter\", cc.SpriteFrame));\n            })\n            .catch(function () {\n                console.error(\"getBundleErr\");\n            });\n    };\n    __decorate([f(cc.Label)], e.prototype, \"nameLbl\", void 0);\n    __decorate([f(cc.ProgressBar)], e.prototype, \"pro\", void 0);\n    __decorate([f(cc.Label)], e.prototype, \"proLbl\", void 0);\n    __decorate([f(cc.Button)], e.prototype, \"goBtn\", void 0);\n    __decorate([f([cc.Sprite])], e.prototype, \"pics\", void 0);\n    __decorate([f(cc.Material)], e.prototype, \"grayMater\", void 0);\n    __decorate([f(cc.Material)], e.prototype, \"normalMater\", void 0);\n    return __decorate([h], e);\n})(cc.Component);\nexports.default = g;\n"]}