{"version":3,"sources":["assets\\scripts\\levelMgr.js"],"names":["Object","defineProperty","exports","value","_evts","require","_res","_uData","_cfgMgr","_global","_pInfo","d","cc","_decorator","h","ccclass","f","property","t","_bgId","oneChapLvlCount","e","get","_ins","enumerable","configurable","prototype","getBgId","init","Promise","all","updateData","updatePracticeData","ins","getPuzzleLvl","o","Math","ceil","bundleId","bundle","releaseAll","_setLocalAndCloudData","n","floor","isNaN","assetManager","loadBundle","padScale","load","SpriteFrame","i","bundleName","r","BufferAsset","data","Uint32Array","_buffer","loadRemote","OssConfig","levelUrl","a","practiceData","updateTmpData","tmpBundleId","tmpBundleName","tmpBundle","tmpData","getPracticeData","getBundleByString","then","console","error","getPracticeId","practiceId","getPuzzleLvlCount","clearPrcitceId","getPuzzleSprFrame","getPracitceSprfFrame","getPuzzleDiff","getPuzzleInfo","diff","id","type","size","getPuzzleData","s","c","pow","l","u","g","y","getJigsawIcon","chapterUrl","packable","getchapterBunder","releaseJigsawIcon","getBundle","releaseAsset","updateJigsaw","setTimeout","opE","emit","action","UPDJIGSAW","updJigAndPop","FINISH_PUZZLELV","popFestival","POP_FESTIVAL","__awaiter","__generator","label","sent","getLevelCost","serverCfg","difficulty_rules","rules","Number","times_val","getLevelDiffStr","title","slice","__decorate"],"mappings":"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","sourceRoot":"/","sourcesContent":["Object.defineProperty(exports, \"__esModule\", {value: !0});\nvar _evts = require(\"evts\");\nvar _res = require(\"res\");\nvar _uData = require(\"uData\");\nvar _cfgMgr = require(\"cfgMgr\");\nvar _global = require(\"global\");\nvar _pInfo = require(\"pInfo\");\nvar d = cc._decorator;\nvar h = d.ccclass;\nvar f =\n    (d.property,\n    (function () {\n        function t() {\n            this._bgId = 0;\n            this.oneChapLvlCount = 54;\n        }\n        var e;\n        e = t;\n        Object.defineProperty(t, \"ins\", {\n            get: function () {\n                return this._ins || (this._ins = new e());\n            },\n            enumerable: !1,\n            configurable: !0\n        });\n        t.prototype.getBgId = function () {\n            return 0;\n        };\n        t.prototype.init = function () {\n            return Promise.all([this.updateData(), this.updatePracticeData()]);\n        };\n        t.prototype.updateData = function () {\n            var t = this;\n            var e = _pInfo.default.ins.getPuzzleLvl();\n            var o = Math.ceil(e / this.oneChapLvlCount);\n            if (o != this.bundleId) {\n                this.bundleId = o;\n                this.bundle && (this.bundle.releaseAll(), _uData.default.ins._setLocalAndCloudData());\n                var n = Math.floor(((e - 1) / 54) % 4);\n                (isNaN(n) || n < 0 || n > 3) && (n = 0);\n                this._bgId = n;\n                cc.assetManager.loadBundle(\"resSps\", function (t, e) {\n                    var o = _global.default.padScale ? \"ipad/\" : \"\";\n                    !t && e.load(\"pages/page_level/\" + o + \"bg\" + n, cc.SpriteFrame);\n                });\n                var i = (this.bundleName = 100 + this.bundleId + \"\");\n                return new Promise(function (e, n) {\n                    var r = function () {\n                        cc.assetManager.loadBundle(i, function (o, i) {\n                            o\n                                ? n()\n                                : ((t.bundle = i),\n                                  i.load(\"data\", cc.BufferAsset, function (o, i) {\n                                      o && n();\n                                      t.data = new Uint32Array(i._buffer);\n                                      e(1);\n                                  }));\n                        });\n                    };\n                    o > 18\n                        ? cc.assetManager.loadRemote(\n                              _global.OssConfig.levelUrl + i + \"/data.bin\",\n                              cc.BufferAsset,\n                              function (n, a) {\n                                  n\n                                      ? t.data || ((i = 101 + ((o - 1) % 18) + \"\"), r())\n                                      : ((t.data = new Uint32Array(a._buffer)), e(1));\n                              }\n                          )\n                        : r();\n                });\n            }\n        };\n        t.prototype.updatePracticeData = function () {\n            var t = this;\n            return new Promise(function (e, o) {\n                cc.assetManager.loadBundle(\"practice\", function (n, i) {\n                    n\n                        ? o()\n                        : (i.load(\"data\", cc.BufferAsset, function (e, n) {\n                              e && o();\n                              t.practiceData = new Uint32Array(n._buffer);\n                          }),\n                          e(i));\n                });\n            });\n        };\n        t.prototype.updateTmpData = function (t) {\n            var e = this;\n            this.tmpBundleId = t;\n            var o = (this.tmpBundleName = 100 + t + \"\");\n            return new Promise(function (n, i) {\n                var r = function () {\n                    cc.assetManager.loadBundle(o, function (t, o) {\n                        t\n                            ? i()\n                            : ((e.tmpBundle = o),\n                              o.load(\"data\", cc.BufferAsset, function (t, o) {\n                                  t && i();\n                                  e.tmpData = new Uint32Array(o._buffer);\n                                  n(1);\n                              }));\n                    });\n                };\n                t > 18\n                    ? cc.assetManager.loadRemote(\n                          _global.OssConfig.levelUrl + o + \"/data.bin\",\n                          cc.BufferAsset,\n                          function (i, a) {\n                              i\n                                  ? e.tmpData || ((o = 101 + ((t - 1) % 18) + \"\"), r())\n                                  : ((e.tmpData = new Uint32Array(a._buffer)), n(1));\n                          }\n                      )\n                    : r();\n            });\n        };\n        t.prototype.getPracticeData = function () {\n            var t = this;\n            this.practiceData ||\n                _res.default.ins\n                    .getBundleByString(\"practice\")\n                    .then(function (e) {\n                        var o = e.get(\"data\", cc.BufferAsset);\n                        t.practiceData = new Uint32Array(o._buffer);\n                    })\n                    .catch(function (t) {\n                        console.error(\"RTool.ins.getBundleByString('practice')\", t);\n                    });\n            return this.practiceData;\n        };\n        t.prototype.getPracticeId = function () {\n            this.practiceId\n                ? (this.practiceId++, this.practiceId > this.getPuzzleLvlCount(!0) && (this.practiceId = 2))\n                : (this.practiceId = 2);\n            return this.practiceId;\n        };\n        t.prototype.clearPrcitceId = function () {\n            this.practiceId = null;\n        };\n        t.prototype.getPuzzleSprFrame = function (t) {\n            var e = this;\n            return new Promise(function (o, n) {\n                var i = t;\n                var r = ((i - 1) % e.oneChapLvlCount) + 1 + \"\";\n                i > 972\n                    ? cc.assetManager.loadRemote(\n                          _global.OssConfig.levelUrl + (100 + e.bundleId + \"/\") + r + \".png\",\n                          cc.SpriteFrame,\n                          function (t, e) {\n                              t ? n() : o(new cc.SpriteFrame(e));\n                          }\n                      )\n                    : e.bundle.load(r, cc.SpriteFrame, function (t, e) {\n                          t ? n() : o(e);\n                      });\n            });\n        };\n        t.prototype.getPracitceSprfFrame = function (t) {\n            return new Promise(function (e, o) {\n                _res.default.ins\n                    .getBundleByString(\"practice\")\n                    .then(function (n) {\n                        n.load(t + \"\", cc.SpriteFrame, function (t, n) {\n                            t ? o() : e(n);\n                        });\n                    })\n                    .catch(function (t) {\n                        console.error(\"RTool.ins.getBundleByString('resSps')\", t);\n                    });\n            });\n        };\n        t.prototype.getPuzzleDiff = function () {\n            return this.getPuzzleInfo().diff;\n        };\n        t.prototype.getPuzzleLvlCount = function (t) {\n            return t ? this.getPracticeData()[1] : this.oneChapLvlCount;\n        };\n        t.prototype.getPuzzleInfo = function (t, e) {\n            var o = t ? this.getPracticeData() : this.data;\n            var n = o[0];\n            var i = o[1];\n            var r = t && e ? e - 1 : (_pInfo.default.ins.getPuzzleLvl() - 1) % this.oneChapLvlCount;\n            var a = o[2 + i + (0 == r ? 0 : o[2 + r - 1] + r)];\n            return {id: r, type: n, size: 255 & a, diff: (a >> 8) & 255};\n        };\n        t.prototype.getPuzzleData = function (t, e) {\n            for (\n                var o = t ? this.getPracticeData() : this.data,\n                    n = o[1],\n                    i = t && e ? e - 1 : (_pInfo.default.ins.getPuzzleLvl() - 1) % this.oneChapLvlCount,\n                    r = 0 == i ? 0 : o[2 + i - 1] + i,\n                    a = o[2 + i] + i,\n                    s = o[2 + n + r],\n                    c = Math.pow(255 & s, 2),\n                    l = 2 + n + a + 1,\n                    u = [],\n                    d = 0,\n                    h = 2 + n + r + 1;\n                h < l;\n                h++\n            ) {\n                for (var f = o[h], g = 0; g < 32; g++) {\n                    var y = (1 << g) & 4294967295;\n                    if (((u[d++] = (f & y) == y ? 1 : 0), d == c)) break;\n                }\n                if (d == c) break;\n            }\n            return u;\n        };\n        Object.defineProperty(t.prototype, \"levelBundle\", {\n            get: function () {\n                return this.bundle;\n            },\n            enumerable: !1,\n            configurable: !0\n        });\n        t.prototype.getJigsawIcon = function (t, e) {\n            var o = this;\n            void 0 === e && (e = this.bundleName);\n            return new Promise(function (n, i) {\n                e > \"118\"\n                    ? cc.assetManager.loadRemote(\n                          _global.OssConfig.chapterUrl + (e + \"/\") + t + \".jpg\",\n                          cc.SpriteFrame,\n                          function (t, e) {\n                              t ? i() : ((e.packable = !1), n(new cc.SpriteFrame(e)));\n                          }\n                      )\n                    : o\n                          .getchapterBunder()\n                          .then(function (o) {\n                              o.load(e + \"/\" + t, cc.SpriteFrame, function (t, e) {\n                                  t ? i() : n(e);\n                              });\n                          })\n                          .catch(function (t) {\n                              console.error(\"getchapterBunderErr\", t);\n                          });\n            });\n        };\n        t.prototype.releaseJigsawIcon = function (t, e) {\n            if ((void 0 === e && (e = this.bundleName), !(e > \"118\"))) {\n                var o = cc.assetManager.getBundle(\"chapter\");\n                if (o) {\n                    var n = o.get(e + \"/\" + t, cc.SpriteFrame);\n                    n && cc.assetManager.releaseAsset(n);\n                }\n            }\n        };\n        t.prototype.updateJigsaw = function (t) {\n            setTimeout(function () {\n                _evts.default.opE.emit({action: _evts.default.UPDJIGSAW});\n            }, t);\n        };\n        t.prototype.updJigAndPop = function (t) {\n            setTimeout(function () {\n                _evts.default.opE.emit({action: _evts.default.FINISH_PUZZLELV});\n            }, t);\n        };\n        t.prototype.popFestival = function (t) {\n            setTimeout(function () {\n                _evts.default.opE.emit({action: _evts.default.POP_FESTIVAL});\n            }, t);\n        };\n        t.prototype.getchapterBunder = function () {\n            return __awaiter(this, void 0, void 0, function () {\n                var t;\n                return __generator(this, function (e) {\n                    switch (e.label) {\n                        case 0:\n                            return (t = cc.assetManager.getBundle(\"chapter\"))\n                                ? [3, 2]\n                                : [\n                                      4,\n                                      new Promise(function (t, e) {\n                                          cc.assetManager.loadBundle(\"chapter\", function (o, n) {\n                                              o ? e() : t(n);\n                                          });\n                                      })\n                                  ];\n                        case 1:\n                            return [2, e.sent()];\n                        case 2:\n                            return [2, t];\n                    }\n                });\n            });\n        };\n        t.prototype.getLevelCost = function () {\n            var t = e.ins.getPuzzleDiff();\n            var o = _cfgMgr.default.serverCfg.difficulty_rules.rules;\n            var n = 10;\n            var i = 1;\n            for (var r in o) {\n                var a = o[r];\n                if (((n = Number(a.times_val)), i === t)) break;\n                i++;\n            }\n            return n;\n        };\n        t.prototype.getLevelDiffStr = function () {\n            var t = e.ins.getPuzzleDiff();\n            var o = _cfgMgr.default.serverCfg.difficulty_rules.rules;\n            var n = \"入门难度\";\n            var i = 1;\n            for (var r in o) {\n                if (((n = o[r].title), i === t)) break;\n                i++;\n            }\n            return n.slice(0, -2);\n        };\n        return (e = __decorate([h], t));\n    })());\nexports.default = f;\n"]}