{"version":3,"sources":["assets\\scripts\\rankMgr.js"],"names":["Object","defineProperty","exports","value","rankSortType","rankType","rankTag","n","i","r","_idx","require","_request","_time","_pInfo","t","mainScore","dailyScore","mainWin","dailyWin","raceScore","Total","Today","Desc","Asc","u","lastRequestTime","lastReqRaceTime","ttMScore","ttDScore","ttMWin","ttDWin","tdMScore","tdDScore","tdMWin","tdDWin","tdRScore","localData","get","_ins","enumerable","configurable","prototype","uploadRankData","e","uploadRankDataByTag","o","ins","JSON","parse","stringify","getLastUploadRankData","getValueAndKeyByTag","a","c","p","Number","d","getRankDataByType","then","data","sort","sort_value","l","uSkin","getUsingSkin","rank_tag","sort_type","extra_data","uploadRank","console","error","setLastUploadRankData","assign","getRecordData","main","tPoints","daily","heWins","getTodayMainScore","getTodayDailyScore","getTodayMainWin","getTodayDailyWin","uploadRaceData","getTodayRaceData","getTodayRaceScore","h","f","g","serverTime","Math","floor","Date","getTime","clearData","getCachedDataByType","getRank","setCachedDataByType","getMyRankDataByTag","getYdayRaceData","getYdayRaceRankData","length","Promise","resolve","getMyRaceTodayData","getMyRaceYdayData","getYdayRaceScore","getLocalRaceRankData","ydayRRData","setYdayRaceRankData","setLocalRaceRankData","platform","setStorage","getStorage"],"mappings":";;;;;;AAAAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;EAACC,KAAK,EAAE,CAAC;AAAT,CAA7C;AACAD,OAAO,CAACE,YAAR,GAAuBF,OAAO,CAACG,QAAR,GAAmBH,OAAO,CAACI,OAAR,GAAkB,KAAK,CAAjE;AACA,IAAIC,CAAJ;AACA,IAAIC,CAAJ;AACA,IAAIC,CAAJ;;AACA,IAAIC,IAAI,GAAGC,OAAO,CAAC,KAAD,CAAlB;;AACA,IAAIC,QAAQ,GAAGD,OAAO,CAAC,SAAD,CAAtB;;AACA,IAAIE,KAAK,GAAGF,OAAO,CAAC,MAAD,CAAnB;;AACA,IAAIG,MAAM,GAAGH,OAAO,CAAC,OAAD,CAApB;;AACA,CAAC,UAAUI,CAAV,EAAa;EACTA,CAAC,CAACC,SAAF,GAAc,YAAf,EACKD,CAAC,CAACE,UAAF,GAAe,aADpB,EAEKF,CAAC,CAACG,OAAF,GAAY,UAFjB,EAGKH,CAAC,CAACI,QAAF,GAAa,WAHlB,EAIKJ,CAAC,CAACK,SAAF,GAAc,YAJnB;AAKH,CAND,EAMIb,CAAC,GAAGL,OAAO,CAACI,OAAR,KAAoBJ,OAAO,CAACI,OAAR,GAAkB,EAAtC,CANR;;AAOA,CAAC,UAAUS,CAAV,EAAa;EACTA,CAAC,CAACM,KAAF,GAAU,OAAX,EAAsBN,CAAC,CAACO,KAAF,GAAU,OAAhC;AACH,CAFD,EAEId,CAAC,GAAGN,OAAO,CAACG,QAAR,KAAqBH,OAAO,CAACG,QAAR,GAAmB,EAAxC,CAFR;;AAGA,CAAC,UAAUU,CAAV,EAAa;EACVA,CAAC,CAACQ,IAAF,GAAS,MAAT;EACAR,CAAC,CAACS,GAAF,GAAQ,KAAR;AACH,CAHD,EAGIf,CAAC,GAAGP,OAAO,CAACE,YAAR,KAAyBF,OAAO,CAACE,YAAR,GAAuB,EAAhD,CAHR;;AAIA,IAAIqB,CAAC,GAAI,YAAY;EACjB,SAASV,CAAT,GAAa;IACT,KAAKW,eAAL,GAAuB,CAAvB;IACA,KAAKC,eAAL,GAAuB,CAAvB;IACA,KAAKC,QAAL,GAAgB,IAAhB;IACA,KAAKC,QAAL,GAAgB,IAAhB;IACA,KAAKC,MAAL,GAAc,IAAd;IACA,KAAKC,MAAL,GAAc,IAAd;IACA,KAAKC,QAAL,GAAgB,IAAhB;IACA,KAAKC,QAAL,GAAgB,IAAhB;IACA,KAAKC,MAAL,GAAc,IAAd;IACA,KAAKC,MAAL,GAAc,IAAd;IACA,KAAKC,QAAL,GAAgB,IAAhB;IACA,KAAKC,SAAL,GAAiB,IAAjB;EACH;;EACDrC,MAAM,CAACC,cAAP,CAAsBc,CAAtB,EAAyB,KAAzB,EAAgC;IAC5BuB,GAAG,EAAE,eAAY;MACb,OAAO,KAAKC,IAAL,KAAc,KAAKA,IAAL,GAAY,IAAIxB,CAAJ,EAA1B,CAAP;IACH,CAH2B;IAI5ByB,UAAU,EAAE,CAAC,CAJe;IAK5BC,YAAY,EAAE,CAAC;EALa,CAAhC;;EAOA1B,CAAC,CAAC2B,SAAF,CAAYC,cAAZ,GAA6B,YAAY;IACrC,IAAI5B,CAAC,GAAGP,CAAC,CAACa,KAAV;IACA,IAAIuB,CAAC,GAAGrC,CAAC,CAACS,SAAV;IACA,KAAK6B,mBAAL,CAAyBD,CAAzB,EAA4B7B,CAA5B;IACA6B,CAAC,GAAGrC,CAAC,CAACW,OAAN;IACA,KAAK2B,mBAAL,CAAyBD,CAAzB,EAA4B7B,CAA5B;IACA6B,CAAC,GAAGrC,CAAC,CAACU,UAAN;IACA,KAAK4B,mBAAL,CAAyBD,CAAzB,EAA4B7B,CAA5B;IACA6B,CAAC,GAAGrC,CAAC,CAACY,QAAN;IACA,KAAK0B,mBAAL,CAAyBD,CAAzB,EAA4B7B,CAA5B;IACAA,CAAC,GAAGP,CAAC,CAACc,KAAN;IACAsB,CAAC,GAAGrC,CAAC,CAACS,SAAN;IACA,KAAK6B,mBAAL,CAAyBD,CAAzB,EAA4B7B,CAA5B;IACA6B,CAAC,GAAGrC,CAAC,CAACU,UAAN;IACA,KAAK4B,mBAAL,CAAyBD,CAAzB,EAA4B7B,CAA5B;IACA6B,CAAC,GAAGrC,CAAC,CAACW,OAAN;IACA,KAAK2B,mBAAL,CAAyBD,CAAzB,EAA4B7B,CAA5B;IACA6B,CAAC,GAAGrC,CAAC,CAACY,QAAN;IACA,KAAK0B,mBAAL,CAAyBD,CAAzB,EAA4B7B,CAA5B;EACH,CAnBD;;EAoBAA,CAAC,CAAC2B,SAAF,CAAYG,mBAAZ,GAAkC,UAAU9B,CAAV,EAAa6B,CAAb,EAAgB;IAC9C,IAAIE,CAAC,GAAGhC,MAAM,WAAN,CAAeiC,GAAvB;IACA,IAAIxC,CAAC,GAAGyC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeJ,CAAC,CAACK,qBAAF,EAAf,CAAX,CAAR;IACA,IAAI3C,CAAC,GAAG,KAAK4C,mBAAL,CAAyBrC,CAAzB,EAA4B6B,CAA5B,CAAR;IACA,IAAIS,CAAC,GAAG7C,CAAC,CAAC,CAAD,CAAT;IACA,IAAI8C,CAAC,GAAG9C,CAAC,CAAC,CAAD,CAAT;IACA,IAAIiB,CAAC,GAAGlB,CAAC,CAAC+C,CAAD,CAAT;IACA,IAAIC,CAAC,GAAGC,MAAM,CAACH,CAAD,CAAd;;IACA,IAAIE,CAAC,GAAGC,MAAM,CAAC/B,CAAD,CAAd,EAAmB;MACf,IAAIgC,CAAC,GAAG,KAAKC,iBAAL,CAAuB3C,CAAvB,EAA0B6B,CAA1B,CAAR;MACArC,CAAC,CAAC+C,CAAD,CAAD,GAAOD,CAAP;MACAI,CAAC,CAACE,IAAF,CAAO,UAAUpD,CAAV,EAAa;QAChB,IAAIC,CAAC,GAAGD,CAAC,CAACqD,IAAV;QACA,IAAIP,CAAC,GAAG,CAAR;;QACA,IAAI7C,CAAJ,EAAO;UACHA,CAAC,CAACqD,IAAF,CAAO,UAAU9C,CAAV,EAAa6B,CAAb,EAAgB;YACnB,OAAOA,CAAC,CAACkB,UAAF,GAAe/C,CAAC,CAAC+C,UAAxB;UACH,CAFD;UAGA,IAAIR,CAAC,GAAG9C,CAAC,CAAC,EAAD,CAAT;UACA8C,CAAC,KAAKD,CAAC,GAAGC,CAAC,CAACQ,UAAX,CAAD;QACH;;QACD,IAAIP,CAAC,GAAGC,MAAM,CAACH,CAAD,CAAd,EAAmB;UACf,IAAIU,CAAC,GAAG,EAAR;UACAA,CAAC,CAACC,KAAF,GAAUlB,CAAC,CAACmB,YAAF,EAAV;UACA,IAAIxC,CAAC,GAAG;YAACyC,QAAQ,EAAEnD,CAAX;YAAc+C,UAAU,EAAEP,CAA1B;YAA6BY,SAAS,EAAE1D,CAAC,CAACc,IAA1C;YAAgD6C,UAAU,EAAEL;UAA5D,CAAR;;UACAnD,QAAQ,WAAR,CAAiBmC,GAAjB,CAAqBsB,UAArB,CAAgC5C,CAAhC,EAAmCmB,CAAnC;QACH;MACJ,CAhBD,WAgBS,YAAY;QACjB0B,OAAO,CAACC,KAAR,CAAc,gBAAd;MACH,CAlBD;MAmBAzB,CAAC,CAAC0B,qBAAF,CAAwBjE,CAAxB;IACH;EACJ,CAhCD;;EAiCAQ,CAAC,CAAC2B,SAAF,CAAYU,mBAAZ,GAAkC,UAAUrC,CAAV,EAAa6B,CAAb,EAAgB;IAC9C,IAAIE,CAAC,GAAGhC,MAAM,WAAN,CAAeiC,GAAvB;IACA,IAAItC,CAAC,GAAGT,MAAM,CAACyE,MAAP,CAAc,EAAd,EAAkB3D,MAAM,WAAN,CAAeiC,GAAf,CAAmB2B,aAAnB,EAAlB,CAAR;IACA,IAAI9B,CAAC,KAAKpC,CAAC,CAACa,KAAZ,EACI,QAAQN,CAAR;MACI,KAAKR,CAAC,CAACS,SAAP;QACI,OAAO,CAACP,CAAC,CAACkE,IAAF,CAAOC,OAAR,EAAiB,UAAjB,CAAP;;MACJ,KAAKrE,CAAC,CAACU,UAAP;QACI,OAAO,CAACR,CAAC,CAACoE,KAAF,CAAQD,OAAT,EAAkB,UAAlB,CAAP;;MACJ,KAAKrE,CAAC,CAACW,OAAP;QACI,OAAO,CAACT,CAAC,CAACkE,IAAF,CAAOG,MAAR,EAAgB,QAAhB,CAAP;;MACJ,KAAKvE,CAAC,CAACY,QAAP;QACI,OAAO,CAACV,CAAC,CAACoE,KAAF,CAAQC,MAAT,EAAiB,QAAjB,CAAP;IARR,CADJ,MAWK,IAAIlC,CAAC,KAAKpC,CAAC,CAACc,KAAZ,EACD,QAAQP,CAAR;MACI,KAAKR,CAAC,CAACS,SAAP;QACI,OAAO,CAAC8B,CAAC,CAACiC,iBAAF,EAAD,EAAwB,UAAxB,CAAP;;MACJ,KAAKxE,CAAC,CAACU,UAAP;QACI,OAAO,CAAC6B,CAAC,CAACkC,kBAAF,EAAD,EAAyB,UAAzB,CAAP;;MACJ,KAAKzE,CAAC,CAACW,OAAP;QACI,OAAO,CAAC4B,CAAC,CAACmC,eAAF,EAAD,EAAsB,QAAtB,CAAP;;MACJ,KAAK1E,CAAC,CAACY,QAAP;QACI,OAAO,CAAC2B,CAAC,CAACoC,gBAAF,EAAD,EAAuB,QAAvB,CAAP;IARR;EAUP,CAzBD;;EA0BAnE,CAAC,CAAC2B,SAAF,CAAYyC,cAAZ,GAA6B,YAAY;IACrC,KAAKC,gBAAL,GACKzB,IADL,CACU,UAAU5C,CAAV,EAAa;MACf,IAAI6B,CAAC,GAAG9B,MAAM,WAAN,CAAeiC,GAAvB;MACA,IAAID,CAAC,GAAG/B,CAAC,CAAC6C,IAAV;MACAd,CAAC,IACGA,CAAC,CAACe,IAAF,CAAO,UAAU9C,CAAV,EAAa6B,CAAb,EAAgB;QACnB,OAAOA,CAAC,CAACkB,UAAF,GAAe/C,CAAC,CAAC+C,UAAxB;MACH,CAFD,CADJ;MAIA,IAAIT,CAAC,GAAGT,CAAC,CAACO,qBAAF,EAAR;MACA,IAAIG,CAAC,GAAG/C,CAAC,CAACa,SAAV;MACA,IAAIK,CAAC,GAAGmB,CAAC,CAACyC,iBAAF,EAAR;MACA,IAAI9B,CAAC,GAAGF,CAAC,CAACjB,QAAV;MACA,IAAIqB,CAAC,GAAG,CAAR;MACA,IAAI6B,CAAC,GAAGxC,CAAC,CAAC,EAAD,CAAT;;MACA,IAAKwC,CAAC,KAAK7B,CAAC,GAAG6B,CAAC,CAACxB,UAAX,CAAD,EAAyBN,MAAM,CAAC/B,CAAD,CAAN,GAAY+B,MAAM,CAACD,CAAD,CAAlB,IAAyBC,MAAM,CAAC/B,CAAD,CAAN,GAAY+B,MAAM,CAACC,CAAD,CAAzE,EAA+E;QAC3EJ,CAAC,CAACjB,QAAF,GAAaX,CAAb;QACA,IAAI8D,CAAC,GAAG,EAAR;QACAA,CAAC,CAACvB,KAAF,GAAUpB,CAAC,CAACqB,YAAF,EAAV;QACA,IAAIuB,CAAC,GAAG;UAACtB,QAAQ,EAAEZ,CAAX;UAAcQ,UAAU,EAAErC,CAA1B;UAA6B0C,SAAS,EAAE1D,CAAC,CAACc,IAA1C;UAAgD6C,UAAU,EAAEmB;QAA5D,CAAR;;QACA3E,QAAQ,WAAR,CAAiBmC,GAAjB,CAAqBsB,UAArB,CAAgCmB,CAAhC,EAAmChF,CAAC,CAACc,KAArC;MACH;;MACDsB,CAAC,CAAC4B,qBAAF,CAAwBnB,CAAxB;IACH,CAtBL,WAuBW,YAAY;MACfiB,OAAO,CAACC,KAAR,CAAc,gBAAd;IACH,CAzBL;EA0BH,CA3BD;;EA4BAxD,CAAC,CAAC2B,SAAF,CAAYgB,iBAAZ,GAAgC,UAAU3C,CAAV,EAAa6B,CAAb,EAAgBE,CAAhB,EAAmB;IAC/C,KAAK,CAAL,KAAWA,CAAX,KAAiBA,CAAC,GAAGrC,CAAC,CAACc,IAAvB;IACA,IAAIhB,CAAC,GAAGM,KAAK,WAAL,CAAckC,GAAd,CAAkB0C,UAAlB,IAAgCC,IAAI,CAACC,KAAL,CAAW,IAAIC,IAAJ,GAAWC,OAAX,KAAuB,GAAlC,CAAxC;IACA,IAAIxC,CAAC,GAAG9C,CAAC,GAAG,KAAKmB,eAAT,IAA4B,IAApC;IACA2B,CAAC,IAAI,KAAKyC,SAAL,EAAL;IACA,IAAI/B,CAAC,GAAG,KAAKgC,mBAAL,CAAyBhF,CAAzB,EAA4B6B,CAA5B,CAAR;IACA,IAAI,CAACS,CAAD,IAAMU,CAAV,EAAa,OAAO,KAAKgC,mBAAL,CAAyBhF,CAAzB,EAA4B6B,CAA5B,CAAP;;IACb,IAAM,KAAKlB,eAAL,GAAuBnB,CAAxB,EAA4BqC,CAAC,KAAKpC,CAAC,CAACa,KAAzC,EAAiD;MAC7C,IAAII,CAAC,GAAGb,QAAQ,WAAR,CAAiBmC,GAAjB,CAAqBiD,OAArB,CAA6BjF,CAA7B,EAAgC6B,CAAhC,EAAmCE,CAAnC,CAAR;;MACA,KAAKmD,mBAAL,CAAyBlF,CAAzB,EAA4B6B,CAA5B,EAA+BnB,CAA/B;MACA,OAAOA,CAAP;IACH;;IACD,IAAImB,CAAC,KAAKpC,CAAC,CAACc,KAAZ,EAAmB;MACf,IAAIiC,CAAC,GAAG1C,KAAK,WAAL,CAAckC,GAAd,CAAkB0C,UAAlB,IAAgC,IAAIG,IAAJ,GAAWC,OAAX,EAAxC;MACAtC,CAAC,IAAI,CAACA,CAAC,GAAG,KAAL,IAAc,KAAnB;MACAA,CAAC,IAAI,GAAL;;MACA,IAAIE,CAAC,GAAG7C,QAAQ,WAAR,CAAiBmC,GAAjB,CAAqBiD,OAArB,CAA6BjF,CAA7B,EAAgC6B,CAAhC,EAAmCE,CAAnC,EAAsCS,CAAtC,CAAR;;MACA,KAAK0C,mBAAL,CAAyBlF,CAAzB,EAA4B6B,CAA5B,EAA+Ba,CAA/B;MACA,OAAOA,CAAP;IACH;EACJ,CApBD;;EAqBA1C,CAAC,CAAC2B,SAAF,CAAYwD,kBAAZ,GAAiC,UAAUnF,CAAV,EAAa6B,CAAb,EAAgB;IAC7C,IAAIE,CAAC,GAAGhC,MAAM,WAAN,CAAeiC,GAAf,CAAmB2B,aAAnB,EAAR;;IACA,IAAI9B,CAAC,KAAKpC,CAAC,CAACc,KAAZ,EACI,QAAQP,CAAR;MACI,KAAKR,CAAC,CAACS,SAAP;QACI,OAAOF,MAAM,WAAN,CAAeiC,GAAf,CAAmBgC,iBAAnB,EAAP;;MACJ,KAAKxE,CAAC,CAACU,UAAP;QACI,OAAOH,MAAM,WAAN,CAAeiC,GAAf,CAAmBiC,kBAAnB,EAAP;;MACJ,KAAKzE,CAAC,CAACW,OAAP;QACI,OAAOJ,MAAM,WAAN,CAAeiC,GAAf,CAAmBkC,eAAnB,EAAP;;MACJ,KAAK1E,CAAC,CAACY,QAAP;QACI,OAAOL,MAAM,WAAN,CAAeiC,GAAf,CAAmBmC,gBAAnB,EAAP;IARR,CADJ,MAWK,IAAItC,CAAC,KAAKpC,CAAC,CAACa,KAAZ,EACD,QAAQN,CAAR;MACI,KAAKR,CAAC,CAACS,SAAP;QACI,OAAO8B,CAAC,CAAC6B,IAAF,CAAOC,OAAd;;MACJ,KAAKrE,CAAC,CAACU,UAAP;QACI,OAAO6B,CAAC,CAAC+B,KAAF,CAAQD,OAAf;;MACJ,KAAKrE,CAAC,CAACW,OAAP;QACI,OAAO4B,CAAC,CAAC6B,IAAF,CAAOG,MAAd;;MACJ,KAAKvE,CAAC,CAACY,QAAP;QACI,OAAO2B,CAAC,CAAC+B,KAAF,CAAQC,MAAf;IARR;EAUP,CAxBD;;EAyBA/D,CAAC,CAAC2B,SAAF,CAAY0C,gBAAZ,GAA+B,YAAY;IACvC,IAAIrE,CAAC,GAAGF,KAAK,WAAL,CAAckC,GAAd,CAAkB0C,UAAlB,IAAgCC,IAAI,CAACC,KAAL,CAAW,IAAIC,IAAJ,GAAWC,OAAX,KAAuB,GAAlC,CAAxC;IACA,IAAIjD,CAAC,GAAG7B,CAAC,GAAG,KAAKY,eAAT,IAA4B,IAApC;IACAiB,CAAC,KAAK,KAAKT,MAAL,GAAc,IAAnB,CAAD;IACA,IAAIW,CAAC,GAAG,KAAKiD,mBAAL,CAAyBxF,CAAC,CAACa,SAA3B,EAAsCZ,CAAC,CAACc,KAAxC,CAAR;;IACA,IAAIsB,CAAC,IAAI,CAACE,CAAV,EAAa;MACT,KAAKnB,eAAL,GAAuBZ,CAAvB;MACA,IAAIsC,CAAC,GAAGxC,KAAK,WAAL,CAAckC,GAAd,CAAkB0C,UAAlB,IAAgCC,IAAI,CAACC,KAAL,CAAW,IAAIC,IAAJ,GAAWC,OAAX,KAAuB,GAAlC,CAAxC;MACAxC,CAAC,IAAI,CAACA,CAAC,GAAG,KAAL,IAAc,KAAnB;MACAA,CAAC,IAAI,GAAL;;MACA,IAAIU,CAAC,GAAGnD,QAAQ,WAAR,CAAiBmC,GAAjB,CAAqBiD,OAArB,CAA6BzF,CAAC,CAACa,SAA/B,EAA0CZ,CAAC,CAACc,KAA5C,EAAmDb,CAAC,CAACc,IAArD,EAA2D8B,CAA3D,CAAR;;MACA,KAAK4C,mBAAL,CAAyB1F,CAAC,CAACa,SAA3B,EAAsCZ,CAAC,CAACc,KAAxC,EAA+CyC,CAA/C;MACA,OAAOA,CAAP;IACH;;IACD,OAAO,KAAKgC,mBAAL,CAAyBxF,CAAC,CAACa,SAA3B,EAAsCZ,CAAC,CAACc,KAAxC,CAAP;EACH,CAfD;;EAgBAP,CAAC,CAAC2B,SAAF,CAAYyD,eAAZ,GAA8B,YAAY;IACtC,IAAIpF,CAAC,GAAGF,KAAK,WAAL,CAAckC,GAAd,CAAkB0C,UAAlB,IAAgCC,IAAI,CAACC,KAAL,CAAW,IAAIC,IAAJ,GAAWC,OAAX,KAAuB,GAAlC,CAAxC;IACA9E,CAAC,IAAI,KAAL;IACAA,CAAC,IAAI,CAACA,CAAC,GAAG,KAAL,IAAc,KAAnB;IACAA,CAAC,IAAI,GAAL;IACA,IAAI6B,CAAC,GAAG,KAAKwD,mBAAL,EAAR;;IACA,IAAI,KAAKxD,CAAC,CAACyD,MAAX,EAAmB;MACf,IAAIvD,CAAC,GAAG;QAACc,IAAI,EAAEhB;MAAP,CAAR;MACA,OAAO0D,OAAO,CAACC,OAAR,CAAgBzD,CAAhB,CAAP;IACH;;IACD,OAAOlC,QAAQ,WAAR,CAAiBmC,GAAjB,CAAqBiD,OAArB,CAA6BzF,CAAC,CAACa,SAA/B,EAA0CZ,CAAC,CAACc,KAA5C,EAAmDb,CAAC,CAACc,IAArD,EAA2DR,CAA3D,CAAP;EACH,CAXD;;EAYAA,CAAC,CAAC2B,SAAF,CAAY8D,kBAAZ,GAAiC,YAAY;IACzC,OAAO1F,MAAM,WAAN,CAAeiC,GAAf,CAAmBsC,iBAAnB,EAAP;EACH,CAFD;;EAGAtE,CAAC,CAAC2B,SAAF,CAAY+D,iBAAZ,GAAgC,YAAY;IACxC,OAAO3F,MAAM,WAAN,CAAeiC,GAAf,CAAmB2D,gBAAnB,EAAP;EACH,CAFD;;EAGA3F,CAAC,CAAC2B,SAAF,CAAYuD,mBAAZ,GAAkC,UAAUlF,CAAV,EAAa6B,CAAb,EAAgBE,CAAhB,EAAmB;IACjD,IAAIF,CAAC,KAAKpC,CAAC,CAACa,KAAZ,EACI,QAAQN,CAAR;MACI,KAAKR,CAAC,CAACS,SAAP;QACI,KAAKY,QAAL,GAAgBkB,CAAhB;QACA;;MACJ,KAAKvC,CAAC,CAACU,UAAP;QACI,KAAKY,QAAL,GAAgBiB,CAAhB;QACA;;MACJ,KAAKvC,CAAC,CAACW,OAAP;QACI,KAAKY,MAAL,GAAcgB,CAAd;QACA;;MACJ,KAAKvC,CAAC,CAACY,QAAP;QACI,KAAKY,MAAL,GAAce,CAAd;IAXR,CADJ,MAcK,IAAIF,CAAC,KAAKpC,CAAC,CAACc,KAAZ,EACD,QAAQP,CAAR;MACI,KAAKR,CAAC,CAACS,SAAP;QACI,KAAKgB,QAAL,GAAgBc,CAAhB;QACA;;MACJ,KAAKvC,CAAC,CAACU,UAAP;QACI,KAAKgB,QAAL,GAAgBa,CAAhB;QACA;;MACJ,KAAKvC,CAAC,CAACW,OAAP;QACI,KAAKgB,MAAL,GAAcY,CAAd;QACA;;MACJ,KAAKvC,CAAC,CAACY,QAAP;QACI,KAAKgB,MAAL,GAAcW,CAAd;QACA;;MACJ,KAAKvC,CAAC,CAACa,SAAP;QACI,KAAKe,MAAL,GAAcW,CAAd;IAdR;EAgBP,CAhCD;;EAiCA/B,CAAC,CAAC2B,SAAF,CAAYqD,mBAAZ,GAAkC,UAAUhF,CAAV,EAAa6B,CAAb,EAAgB;IAC9C,IAAIA,CAAC,KAAKpC,CAAC,CAACa,KAAZ,EACI,QAAQN,CAAR;MACI,KAAKR,CAAC,CAACS,SAAP;QACI,OAAO,KAAKY,QAAZ;;MACJ,KAAKrB,CAAC,CAACU,UAAP;QACI,OAAO,KAAKY,QAAZ;;MACJ,KAAKtB,CAAC,CAACW,OAAP;QACI,OAAO,KAAKY,MAAZ;;MACJ,KAAKvB,CAAC,CAACY,QAAP;QACI,OAAO,KAAKY,MAAZ;IARR,CADJ,MAWK,IAAIa,CAAC,KAAKpC,CAAC,CAACc,KAAZ,EACD,QAAQP,CAAR;MACI,KAAKR,CAAC,CAACS,SAAP;QACI,OAAO,KAAKgB,QAAZ;;MACJ,KAAKzB,CAAC,CAACU,UAAP;QACI,OAAO,KAAKgB,QAAZ;;MACJ,KAAK1B,CAAC,CAACW,OAAP;QACI,OAAO,KAAKgB,MAAZ;;MACJ,KAAK3B,CAAC,CAACY,QAAP;MACA,KAAKZ,CAAC,CAACa,SAAP;QACI,OAAO,KAAKe,MAAZ;IATR;EAWP,CAxBD;;EAyBApB,CAAC,CAAC2B,SAAF,CAAYoD,SAAZ,GAAwB,YAAY;IAChC,KAAKlE,QAAL,GAAgB,IAAhB;IACA,KAAKC,QAAL,GAAgB,IAAhB;IACA,KAAKC,MAAL,GAAc,IAAd;IACA,KAAKC,MAAL,GAAc,IAAd;IACA,KAAKC,QAAL,GAAgB,IAAhB;IACA,KAAKC,QAAL,GAAgB,IAAhB;IACA,KAAKC,MAAL,GAAc,IAAd;IACA,KAAKC,MAAL,GAAc,IAAd;EACH,CATD;;EAUApB,CAAC,CAAC2B,SAAF,CAAY0D,mBAAZ,GAAkC,YAAY;IAC1C,IAAIrF,CAAC,GAAG,KAAK4F,oBAAL,GAA4BC,UAApC;IACA,OAAO,QAAQ7F,CAAR,GAAY,EAAZ,GAAiBA,CAAxB;EACH,CAHD;;EAIAA,CAAC,CAAC2B,SAAF,CAAYmE,mBAAZ,GAAkC,UAAU9F,CAAV,EAAa;IAC3C,KAAK+F,oBAAL,CAA0B;MAACF,UAAU,EAAE7F;IAAb,CAA1B;EACH,CAFD;;EAGAA,CAAC,CAAC2B,SAAF,CAAYoE,oBAAZ,GAAmC,UAAU/F,CAAV,EAAa;IAC5C,IAAI6B,CAAC,GAAG,KAAK+D,oBAAL,EAAR;IACA,KAAKtE,SAAL,GAAiBrC,MAAM,CAACyE,MAAP,CAAczE,MAAM,CAACyE,MAAP,CAAc,EAAd,EAAkB7B,CAAlB,CAAd,EAAoC7B,CAApC,CAAjB;;IACAL,IAAI,CAACqG,QAAL,CAAcC,UAAd,CAAyB,cAAzB,EAAyC,KAAK3E,SAA9C;EACH,CAJD;;EAKAtB,CAAC,CAAC2B,SAAF,CAAYiE,oBAAZ,GAAmC,YAAY;IAC3C,QAAQ,KAAKtE,SAAb,KAA2B,KAAKA,SAAL,GAAiB3B,IAAI,CAACqG,QAAL,CAAcE,UAAd,CAAyB,cAAzB,KAA4C,EAAxF;IACA,OAAO,KAAK5E,SAAZ;EACH,CAHD;;EAIA,OAAOtB,CAAP;AACH,CAtSO,EAAR;;AAuSAb,OAAO,WAAP,GAAkBuB,CAAlB","sourceRoot":"/","sourcesContent":["Object.defineProperty(exports, \"__esModule\", {value: !0});\nexports.rankSortType = exports.rankType = exports.rankTag = void 0;\nvar n;\nvar i;\nvar r;\nvar _idx = require(\"idx\");\nvar _request = require(\"request\");\nvar _time = require(\"time\");\nvar _pInfo = require(\"pInfo\");\n(function (t) {\n    (t.mainScore = \"main_score\"),\n        (t.dailyScore = \"daily_score\"),\n        (t.mainWin = \"main_win\"),\n        (t.dailyWin = \"daily_win\"),\n        (t.raceScore = \"race_score\");\n})((n = exports.rankTag || (exports.rankTag = {})));\n(function (t) {\n    (t.Total = \"total\"), (t.Today = \"daily\");\n})((i = exports.rankType || (exports.rankType = {})));\n(function (t) {\n    t.Desc = \"desc\";\n    t.Asc = \"asc\";\n})((r = exports.rankSortType || (exports.rankSortType = {})));\nvar u = (function () {\n    function t() {\n        this.lastRequestTime = 0;\n        this.lastReqRaceTime = 0;\n        this.ttMScore = null;\n        this.ttDScore = null;\n        this.ttMWin = null;\n        this.ttDWin = null;\n        this.tdMScore = null;\n        this.tdDScore = null;\n        this.tdMWin = null;\n        this.tdDWin = null;\n        this.tdRScore = null;\n        this.localData = null;\n    }\n    Object.defineProperty(t, \"ins\", {\n        get: function () {\n            return this._ins || (this._ins = new t());\n        },\n        enumerable: !1,\n        configurable: !0\n    });\n    t.prototype.uploadRankData = function () {\n        var t = i.Total;\n        var e = n.mainScore;\n        this.uploadRankDataByTag(e, t);\n        e = n.mainWin;\n        this.uploadRankDataByTag(e, t);\n        e = n.dailyScore;\n        this.uploadRankDataByTag(e, t);\n        e = n.dailyWin;\n        this.uploadRankDataByTag(e, t);\n        t = i.Today;\n        e = n.mainScore;\n        this.uploadRankDataByTag(e, t);\n        e = n.dailyScore;\n        this.uploadRankDataByTag(e, t);\n        e = n.mainWin;\n        this.uploadRankDataByTag(e, t);\n        e = n.dailyWin;\n        this.uploadRankDataByTag(e, t);\n    };\n    t.prototype.uploadRankDataByTag = function (t, e) {\n        var o = _pInfo.default.ins;\n        var n = JSON.parse(JSON.stringify(o.getLastUploadRankData()));\n        var i = this.getValueAndKeyByTag(t, e);\n        var a = i[0];\n        var c = i[1];\n        var u = n[c];\n        var p = Number(a);\n        if (p > Number(u)) {\n            var d = this.getRankDataByType(t, e);\n            n[c] = a;\n            d.then(function (n) {\n                var i = n.data;\n                var a = 0;\n                if (i) {\n                    i.sort(function (t, e) {\n                        return e.sort_value - t.sort_value;\n                    });\n                    var c = i[99];\n                    c && (a = c.sort_value);\n                }\n                if (p > Number(a)) {\n                    var l = {};\n                    l.uSkin = o.getUsingSkin();\n                    var u = {rank_tag: t, sort_value: p, sort_type: r.Desc, extra_data: l};\n                    _request.default.ins.uploadRank(u, e);\n                }\n            }).catch(function () {\n                console.error(\"getRankDataErr\");\n            });\n            o.setLastUploadRankData(n);\n        }\n    };\n    t.prototype.getValueAndKeyByTag = function (t, e) {\n        var o = _pInfo.default.ins;\n        var r = Object.assign({}, _pInfo.default.ins.getRecordData());\n        if (e === i.Total)\n            switch (t) {\n                case n.mainScore:\n                    return [r.main.tPoints, \"ttMScore\"];\n                case n.dailyScore:\n                    return [r.daily.tPoints, \"ttDScore\"];\n                case n.mainWin:\n                    return [r.main.heWins, \"ttMWin\"];\n                case n.dailyWin:\n                    return [r.daily.heWins, \"ttDWin\"];\n            }\n        else if (e === i.Today)\n            switch (t) {\n                case n.mainScore:\n                    return [o.getTodayMainScore(), \"tdMScore\"];\n                case n.dailyScore:\n                    return [o.getTodayDailyScore(), \"tdDScore\"];\n                case n.mainWin:\n                    return [o.getTodayMainWin(), \"tdMWin\"];\n                case n.dailyWin:\n                    return [o.getTodayDailyWin(), \"tdDWin\"];\n            }\n    };\n    t.prototype.uploadRaceData = function () {\n        this.getTodayRaceData()\n            .then(function (t) {\n                var e = _pInfo.default.ins;\n                var o = t.data;\n                o &&\n                    o.sort(function (t, e) {\n                        return e.sort_value - t.sort_value;\n                    });\n                var a = e.getLastUploadRankData();\n                var c = n.raceScore;\n                var u = e.getTodayRaceScore();\n                var p = a.tdRScore;\n                var d = 0;\n                var h = o[99];\n                if ((h && (d = h.sort_value), Number(u) > Number(p) && Number(u) > Number(d))) {\n                    a.tdRScore = u;\n                    var f = {};\n                    f.uSkin = e.getUsingSkin();\n                    var g = {rank_tag: c, sort_value: u, sort_type: r.Desc, extra_data: f};\n                    _request.default.ins.uploadRank(g, i.Today);\n                }\n                e.setLastUploadRankData(a);\n            })\n            .catch(function () {\n                console.error(\"uploadRaceData\");\n            });\n    };\n    t.prototype.getRankDataByType = function (t, e, o) {\n        void 0 === o && (o = r.Desc);\n        var n = _time.default.ins.serverTime || Math.floor(new Date().getTime() / 1e3);\n        var a = n - this.lastRequestTime >= 3600;\n        a && this.clearData();\n        var l = this.getCachedDataByType(t, e);\n        if (!a && l) return this.getCachedDataByType(t, e);\n        if (((this.lastRequestTime = n), e === i.Total)) {\n            var u = _request.default.ins.getRank(t, e, o);\n            this.setCachedDataByType(t, e, u);\n            return u;\n        }\n        if (e === i.Today) {\n            var p = _time.default.ins.serverTime || new Date().getTime();\n            p -= (p + 28800) % 86400;\n            p *= 1e3;\n            var d = _request.default.ins.getRank(t, e, o, p);\n            this.setCachedDataByType(t, e, d);\n            return d;\n        }\n    };\n    t.prototype.getMyRankDataByTag = function (t, e) {\n        var o = _pInfo.default.ins.getRecordData();\n        if (e === i.Today)\n            switch (t) {\n                case n.mainScore:\n                    return _pInfo.default.ins.getTodayMainScore();\n                case n.dailyScore:\n                    return _pInfo.default.ins.getTodayDailyScore();\n                case n.mainWin:\n                    return _pInfo.default.ins.getTodayMainWin();\n                case n.dailyWin:\n                    return _pInfo.default.ins.getTodayDailyWin();\n            }\n        else if (e === i.Total)\n            switch (t) {\n                case n.mainScore:\n                    return o.main.tPoints;\n                case n.dailyScore:\n                    return o.daily.tPoints;\n                case n.mainWin:\n                    return o.main.heWins;\n                case n.dailyWin:\n                    return o.daily.heWins;\n            }\n    };\n    t.prototype.getTodayRaceData = function () {\n        var t = _time.default.ins.serverTime || Math.floor(new Date().getTime() / 1e3);\n        var e = t - this.lastReqRaceTime >= 3600;\n        e && (this.tdDWin = null);\n        var o = this.getCachedDataByType(n.raceScore, i.Today);\n        if (e || !o) {\n            this.lastReqRaceTime = t;\n            var a = _time.default.ins.serverTime || Math.floor(new Date().getTime() / 1e3);\n            a -= (a + 28800) % 86400;\n            a *= 1e3;\n            var l = _request.default.ins.getRank(n.raceScore, i.Today, r.Desc, a);\n            this.setCachedDataByType(n.raceScore, i.Today, l);\n            return l;\n        }\n        return this.getCachedDataByType(n.raceScore, i.Today);\n    };\n    t.prototype.getYdayRaceData = function () {\n        var t = _time.default.ins.serverTime || Math.floor(new Date().getTime() / 1e3);\n        t -= 86400;\n        t -= (t + 28800) % 86400;\n        t *= 1e3;\n        var e = this.getYdayRaceRankData();\n        if (0 != e.length) {\n            var o = {data: e};\n            return Promise.resolve(o);\n        }\n        return _request.default.ins.getRank(n.raceScore, i.Today, r.Desc, t);\n    };\n    t.prototype.getMyRaceTodayData = function () {\n        return _pInfo.default.ins.getTodayRaceScore();\n    };\n    t.prototype.getMyRaceYdayData = function () {\n        return _pInfo.default.ins.getYdayRaceScore();\n    };\n    t.prototype.setCachedDataByType = function (t, e, o) {\n        if (e === i.Total)\n            switch (t) {\n                case n.mainScore:\n                    this.ttMScore = o;\n                    break;\n                case n.dailyScore:\n                    this.ttDScore = o;\n                    break;\n                case n.mainWin:\n                    this.ttMWin = o;\n                    break;\n                case n.dailyWin:\n                    this.ttDWin = o;\n            }\n        else if (e === i.Today)\n            switch (t) {\n                case n.mainScore:\n                    this.tdMScore = o;\n                    break;\n                case n.dailyScore:\n                    this.tdDScore = o;\n                    break;\n                case n.mainWin:\n                    this.tdMWin = o;\n                    break;\n                case n.dailyWin:\n                    this.tdDWin = o;\n                    break;\n                case n.raceScore:\n                    this.tdDWin = o;\n            }\n    };\n    t.prototype.getCachedDataByType = function (t, e) {\n        if (e === i.Total)\n            switch (t) {\n                case n.mainScore:\n                    return this.ttMScore;\n                case n.dailyScore:\n                    return this.ttDScore;\n                case n.mainWin:\n                    return this.ttMWin;\n                case n.dailyWin:\n                    return this.ttDWin;\n            }\n        else if (e === i.Today)\n            switch (t) {\n                case n.mainScore:\n                    return this.tdMScore;\n                case n.dailyScore:\n                    return this.tdDScore;\n                case n.mainWin:\n                    return this.tdMWin;\n                case n.dailyWin:\n                case n.raceScore:\n                    return this.tdDWin;\n            }\n    };\n    t.prototype.clearData = function () {\n        this.ttMScore = null;\n        this.ttDScore = null;\n        this.ttMWin = null;\n        this.ttDWin = null;\n        this.tdMScore = null;\n        this.tdDScore = null;\n        this.tdMWin = null;\n        this.tdDWin = null;\n    };\n    t.prototype.getYdayRaceRankData = function () {\n        var t = this.getLocalRaceRankData().ydayRRData;\n        return null == t ? [] : t;\n    };\n    t.prototype.setYdayRaceRankData = function (t) {\n        this.setLocalRaceRankData({ydayRRData: t});\n    };\n    t.prototype.setLocalRaceRankData = function (t) {\n        var e = this.getLocalRaceRankData();\n        this.localData = Object.assign(Object.assign({}, e), t);\n        _idx.platform.setStorage(\"ydayRankData\", this.localData);\n    };\n    t.prototype.getLocalRaceRankData = function () {\n        null == this.localData && (this.localData = _idx.platform.getStorage(\"ydayRankData\") || {});\n        return this.localData;\n    };\n    return t;\n})();\nexports.default = u;\n"]}