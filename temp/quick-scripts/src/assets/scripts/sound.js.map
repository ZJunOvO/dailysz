{"version":3,"sources":["assets\\scripts\\sound.js"],"names":["Object","defineProperty","exports","value","_pInfo","require","_c","_evts","_uData","l","t","isSharing","isHiding","delayID","clips","plE","on","e","onShow","ins","onSoundChange","onHide","adE","ADE","SHARE","VIDEO","get","_ins","enumerable","configurable","prototype","_bgmVolume","getSetting","bgmVolume","set","cc","audioEngine","setMusicVolume","_effectVolume","effectVolume","clearTimeout","setTimeout","stopAll","resumeAll","stopAllEffects","resumeMusic","resumeAllEffects","stopMusic","play","__awaiter","o","n","r","__generator","i","label","effectSound","Math","max","min","AudioClip","Promise","assetManager","loadBundle","load","sent","playEffect","setEffectsVolume","duration","playBGM","bgmSound","ROOT","sceneType","game","guide","BGM","curBg","isMusicPlaying","playMusic","stopBGM","CLICK","WIN","LOSE","RIGHT","ERROR","SHOVEL","ROCKETLAUNCH","ROCKETATTACK","TIME","FINISH_PUZZLE"],"mappings":"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","sourceRoot":"/","sourcesContent":["Object.defineProperty(exports, \"__esModule\", {value: !0});\nvar _pInfo = require(\"pInfo\");\nvar _c = require(\"c\");\nvar _evts = require(\"evts\");\nvar _uData = require(\"uData\");\nvar l = (function () {\n    function t() {\n        this.isSharing = !1;\n        this.isHiding = !1;\n        this.delayID = 0;\n        this.clips = {};\n        _evts.default.plE.on(function (e) {\n            e.onShow\n                ? ((t.ins.isHiding = !1), t.ins.onSoundChange())\n                : e.onHide && ((t.ins.isHiding = !0), t.ins.onSoundChange());\n        });\n        _evts.default.adE.on(function (e) {\n            t.ins.isSharing = e == _c.ADE.SHARE || e == _c.ADE.VIDEO;\n            t.ins.onSoundChange();\n        });\n    }\n    Object.defineProperty(t, \"ins\", {\n        get: function () {\n            this._ins || (this._ins = new t());\n            return this._ins;\n        },\n        enumerable: !1,\n        configurable: !0\n    });\n    Object.defineProperty(t.prototype, \"bgmVolume\", {\n        get: function () {\n            void 0 === this._bgmVolume && (this._bgmVolume = _uData.default.ins.getSetting().bgmVolume);\n            return this._bgmVolume;\n        },\n        set: function (t) {\n            cc.audioEngine.setMusicVolume(t);\n            this._bgmVolume = t;\n        },\n        enumerable: !1,\n        configurable: !0\n    });\n    Object.defineProperty(t.prototype, \"effectVolume\", {\n        get: function () {\n            void 0 === this._effectVolume && (this._effectVolume = _uData.default.ins.getSetting().effectVolume);\n            return this._effectVolume;\n        },\n        set: function (t) {\n            this._effectVolume = t;\n        },\n        enumerable: !1,\n        configurable: !0\n    });\n    t.prototype.onSoundChange = function () {\n        clearTimeout(this.delayID);\n        this.delayID = setTimeout(function () {\n            clearTimeout(t.ins.delayID);\n            t.ins.delayID = 0;\n            t.ins.isSharing || t.ins.isHiding ? t.ins.stopAll() : t.ins.resumeAll();\n        }, 100);\n    };\n    t.prototype.stopAllEffects = function () {\n        cc.audioEngine.stopAllEffects();\n    };\n    t.prototype.resumeAll = function () {\n        cc.audioEngine.resumeMusic();\n        cc.audioEngine.resumeAllEffects();\n    };\n    t.prototype.stopAll = function () {\n        cc.audioEngine.stopMusic();\n        cc.audioEngine.stopAllEffects();\n    };\n    t.prototype.play = function (t, e) {\n        void 0 === e && (e = 0);\n        return __awaiter(this, void 0, void 0, function () {\n            var o;\n            var n;\n            var r;\n            return __generator(this, function (i) {\n                switch (i.label) {\n                    case 0:\n                        return !1 !== _uData.default.ins.getSetting().effectSound && null != t ? [3, 1] : [2];\n                    case 1:\n                        return (\n                            (e = Math.max(1, Math.min(0, e))), t instanceof cc.AudioClip ? ((o = t), [3, 5]) : [3, 2]\n                        );\n                    case 2:\n                        return null != this.clips[t]\n                            ? [3, 4]\n                            : ((n = this.clips),\n                              (r = t),\n                              [\n                                  4,\n                                  new Promise(function (e) {\n                                      cc.assetManager.loadBundle(\"sound\", function (o, n) {\n                                          o\n                                              ? e(o)\n                                              : n.load(t, cc.AudioClip, function (t, o) {\n                                                    e(t ? null : o);\n                                                });\n                                      });\n                                  })\n                              ]);\n                    case 3:\n                        return (o = n[r] = i.sent()), [3, 5];\n                    case 4:\n                        (o = this.clips[t]), (i.label = 5);\n                    case 5:\n                        return o\n                            ? (cc.audioEngine.playEffect(o, !1),\n                              cc.audioEngine.setEffectsVolume(e * this.effectVolume),\n                              [2, o.duration])\n                            : [2];\n                    case 6:\n                        return [2];\n                }\n            });\n        });\n    };\n    t.prototype.playBGM = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var e;\n            var o;\n            var n = this;\n            return __generator(this, function () {\n                return 0 == (e = _uData.default.ins.getSetting().bgmSound)\n                    ? [2]\n                    : ((o =\n                          _pInfo.ROOT == _pInfo.sceneType.game || _pInfo.ROOT == _pInfo.sceneType.guide\n                              ? \"Game\"\n                              : \"Main\"),\n                      cc.assetManager.loadBundle(\"sound\", function (i, r) {\n                          i ||\n                              r.load(t.BGM + o, cc.AudioClip, function (t, i) {\n                                  if (!t) {\n                                      var r = cc.audioEngine;\n                                      (n.curBg == o && r.isMusicPlaying()) ||\n                                          !e ||\n                                          ((n.curBg = o), r.playMusic(i, !0), r.setMusicVolume(n.bgmVolume));\n                                  }\n                              });\n                      }),\n                      [2]);\n            });\n        });\n    };\n    t.prototype.stopBGM = function (t) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function () {\n                return _uData.default.ins.getSetting().bgmSound && !t ? [2] : (cc.audioEngine.stopMusic(), [2]);\n            });\n        });\n    };\n    t.CLICK = \"click\";\n    t.BGM = \"BGM\";\n    t.WIN = \"win\";\n    t.LOSE = \"lose\";\n    t.RIGHT = \"right\";\n    t.ERROR = \"error\";\n    t.SHOVEL = \"shovel\";\n    t.ROCKETLAUNCH = \"rocketLaunch\";\n    t.ROCKETATTACK = \"rocketAttack\";\n    t.TIME = \"time\";\n    t.FINISH_PUZZLE = \"finish_puzzle\";\n    return t;\n})();\nexports.default = l;\n"]}