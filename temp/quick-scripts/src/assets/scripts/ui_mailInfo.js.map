{"version":3,"sources":["assets\\scripts\\ui_mailInfo.js"],"names":["n","Object","defineProperty","exports","value","_evts","require","_item1","_mailMgr","_panelMgr","_baseUI","p","cc","_decorator","d","ccclass","h","property","f","t","e","apply","arguments","scrollView","title","cont","itemPfb","awardNode","deleteNode","_mailItem","__extends","prototype","start","init","length","o","id","mailId","ins","serverMail","string","msg","updateItem","mailInfo","mail","i","JSON","parse","props","r","content","children","forEach","push","removeAllChildren","hasOwnProperty","a","shift","instantiate","addChild","getComponent","childrenCount","l","width","node","x","Math","min","scrollToLeft","u","keys","active","mailState","award","updMail","getAward","parent","convertToWorldSpaceAR","position","itemId","key","worldPos","countStr","open","itemDatas","deleteMail","hideThis","opE","emit","action","UPDMAIL","data","type","changereadState","readMail","hide","onHide","__decorate","ScrollView","Label","Prefab","Node"],"mappings":"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","sourceRoot":"/","sourcesContent":["var n;\nObject.defineProperty(exports, \"__esModule\", {value: !0});\nvar _evts = require(\"evts\");\nvar _item1 = require(\"item1\");\nvar _mailMgr = require(\"mailMgr\");\nvar _panelMgr = require(\"panelMgr\");\nvar _baseUI = require(\"baseUI\");\nvar p = cc._decorator;\nvar d = p.ccclass;\nvar h = p.property;\nvar f = (function (t) {\n    function e() {\n        var e = (null !== t && t.apply(this, arguments)) || this;\n        e.scrollView = null;\n        e.title = null;\n        e.cont = null;\n        e.itemPfb = null;\n        e.awardNode = null;\n        e.deleteNode = null;\n        e._mailItem = [];\n        return e;\n    }\n    __extends(e, t);\n    e.prototype.start = function () {};\n    e.prototype.init = function () {\n        for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];\n        var o = t[0].id;\n        this.mailId = o;\n        var n = _mailMgr.default.ins.serverMail;\n        this.title.string = n[o].title;\n        this.cont.string = n[o].msg;\n        this.updateItem();\n    };\n    e.prototype.updateItem = function (t) {\n        var e = this;\n        void 0 === t && (t = !0);\n        var o = _mailMgr.default.ins.mailInfo.mail[this.mailId];\n        var n = _mailMgr.default.ins.serverMail;\n        var i = JSON.parse(n[this.mailId].props);\n        if (t) {\n            for (var r in (this.scrollView.content.children.forEach(function (t) {\n                e._mailItem.push(t);\n            }),\n            this.scrollView.content.removeAllChildren(),\n            i))\n                if (i.hasOwnProperty(r)) {\n                    var a = this._mailItem.shift() || cc.instantiate(this.itemPfb);\n                    this.scrollView.content.addChild(a);\n                    a.getComponent(_item1.default).init(r, i[r], o);\n                }\n            if (this.scrollView.content.childrenCount) {\n                var l = (this.scrollView.content.children[0].width + 5.5) * this.scrollView.content.childrenCount;\n                this.scrollView.node.x =\n                    l > this.scrollView.node.width ? -209 : (this.scrollView.node.width - l) / 2 - 209;\n                l = Math.min(l, 360);\n                this.scrollView.node.width = l;\n                this.scrollView.scrollToLeft();\n            }\n        }\n        var u = Object.keys(i).length > 0;\n        this.awardNode.active = u && o != _mailMgr.mailState.award;\n        this.deleteNode.active = !this.awardNode.active;\n    };\n    e.prototype.updMail = function () {};\n    e.prototype.getAward = function () {\n        if (_mailMgr.default.ins.getAward(this.mailId)) {\n            for (var t = [], e = this.scrollView.content.childrenCount - 1; e >= 0; e--) {\n                var o = this.scrollView.content.children[e];\n                var n = o.parent.convertToWorldSpaceAR(o.position);\n                var i = {};\n                i.itemId = o.getComponent(_item1.default).key;\n                i.worldPos = n;\n                i.value = o.getComponent(_item1.default).countStr;\n                t.push(i);\n            }\n            _panelMgr.default.ins.open(\"ui/ui_flyAni\", {itemDatas: t});\n            this.updateItem(!1);\n        }\n    };\n    e.prototype.delete = function () {\n        _mailMgr.default.ins.deleteMail(this.mailId);\n        this.hideThis();\n        _evts.default.opE.emit({action: _evts.default.UPDMAIL, data: {type: \"delete\", id: this.mailId}});\n    };\n    e.prototype.changereadState = function () {\n        _mailMgr.default.ins.readMail(this.mailId) &&\n            _evts.default.opE.emit({action: _evts.default.UPDMAIL, data: {type: \"read\", id: this.mailId}});\n    };\n    e.prototype.hideThis = function () {\n        this.hide();\n    };\n    e.prototype.onHide = function () {\n        this.changereadState();\n    };\n    __decorate([h(cc.ScrollView)], e.prototype, \"scrollView\", void 0);\n    __decorate([h(cc.Label)], e.prototype, \"title\", void 0);\n    __decorate([h(cc.Label)], e.prototype, \"cont\", void 0);\n    __decorate([h(cc.Prefab)], e.prototype, \"itemPfb\", void 0);\n    __decorate([h(cc.Node)], e.prototype, \"awardNode\", void 0);\n    __decorate([h(cc.Node)], e.prototype, \"deleteNode\", void 0);\n    return __decorate([d], e);\n})(_baseUI.default);\nexports.default = f;\n"]}