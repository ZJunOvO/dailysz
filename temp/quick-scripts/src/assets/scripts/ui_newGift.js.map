{"version":3,"sources":["assets\\scripts\\ui_newGift.js"],"names":["n","Object","defineProperty","exports","value","_evts","require","_idx","_cfgMgr","_item","_bagMgr","_panelMgr","_pInfo","_baseUI","f","cc","_decorator","g","ccclass","y","property","m","t","e","apply","arguments","itemsNode","itemPre","bgSpr","adGetBtn","hideCb","__extends","prototype","init","serverCfg","props","set","forEach","Number","init_val","o","instantiate","active","parent","getComponent","initByData","key","node","adDotData","hideThis","hide","onAdGet","getItem","childrenCount","i","children","r","convertToWorldSpaceAR","position","h","itemId","worldPos","count","push","ins","addItem","isMaxAdCount","platform","reportEvent","ERepEvt","newGiftGet","setIsGetNewGif","open","itemDatas","opE","emit","action","UPD_NEW_GIFT","onDestroy","assetManager","releaseAsset","spriteFrame","__decorate","Node","Sprite","Button"],"mappings":"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","sourceRoot":"/","sourcesContent":["var n;\nObject.defineProperty(exports, \"__esModule\", {value: !0});\nvar _evts = require(\"evts\");\nvar _idx = require(\"idx\");\nvar _cfgMgr = require(\"cfgMgr\");\nvar _item = require(\"item\");\nvar _bagMgr = require(\"bagMgr\");\nvar _panelMgr = require(\"panelMgr\");\nvar _pInfo = require(\"pInfo\");\nvar _baseUI = require(\"baseUI\");\nvar f = cc._decorator;\nvar g = f.ccclass;\nvar y = f.property;\nvar m = (function (t) {\n    function e() {\n        var e = (null !== t && t.apply(this, arguments)) || this;\n        e.itemsNode = null;\n        e.itemPre = null;\n        e.bgSpr = null;\n        e.adGetBtn = null;\n        e.hideCb = null;\n        return e;\n    }\n    __extends(e, t);\n    e.prototype.init = function () {\n        var t = this;\n        _cfgMgr.default.serverCfg.props.set.forEach(function (e) {\n            if (Number(e.init_val) > 0) {\n                var o = cc.instantiate(t.itemPre);\n                (o.active = !0), (o.parent = t.itemsNode), o.getComponent(_item.default).initByData(e.key, e.init_val);\n            }\n        });\n        this.adGetBtn.node.adDotData = \"新手礼包\";\n    };\n    e.prototype.hideThis = function () {\n        this.hide();\n    };\n    e.prototype.onAdGet = function () {\n        this.getItem();\n    };\n    e.prototype.getItem = function () {\n        for (var t = this, e = [], o = 0, n = this.itemsNode.childrenCount; o < n; o++) {\n            var i = this.itemsNode.children[o];\n            var r = i.parent.convertToWorldSpaceAR(i.position);\n            var h = {};\n            h.itemId = i.getComponent(_item.default).key;\n            h.worldPos = r;\n            h.value = i.getComponent(_item.default).count;\n            e.push(h);\n        }\n        _cfgMgr.default.serverCfg.props.set.forEach(function (t) {\n            _bagMgr.default.ins.addItem(t.key, t.init_val, !0);\n        });\n        !_pInfo.default.ins.isMaxAdCount() && _idx.platform.reportEvent(_idx.ERepEvt.newGiftGet);\n        _pInfo.default.ins.setIsGetNewGif(!0);\n        _panelMgr.default.ins.open(\"ui/ui_flyAni\", {\n            itemDatas: e,\n            hideCb: function () {\n                _evts.default.opE.emit({action: _evts.default.UPD_NEW_GIFT});\n                t.hideThis();\n            }\n        });\n    };\n    e.prototype.onDestroy = function () {\n        cc.assetManager.releaseAsset(this.bgSpr.spriteFrame);\n    };\n    __decorate([y(cc.Node)], e.prototype, \"itemsNode\", void 0);\n    __decorate([y(cc.Node)], e.prototype, \"itemPre\", void 0);\n    __decorate([y(cc.Sprite)], e.prototype, \"bgSpr\", void 0);\n    __decorate([y(cc.Button)], e.prototype, \"adGetBtn\", void 0);\n    return __decorate([g], e);\n})(_baseUI.default);\nexports.default = m;\n"]}