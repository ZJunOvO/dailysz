{"version":3,"sources":["assets\\scripts\\ui_rePlayRace.js"],"names":["n","Object","defineProperty","exports","value","_uData","require","_lang","_rankMgr","_raceRankItem","_ui_rePlay","h","cc","_decorator","f","ccclass","g","property","y","t","e","apply","arguments","scrollRank","selfRank","idxIconArr","rankLb","rankItem","rankLength","__extends","prototype","onLoad","call","string","lang","content","children","init","o","curScore","continueCb","__awaiter","i","r","a","l","d","m","v","_","b","w","__generator","s","label","ins","getYdayRaceData","sent","data","concat","getRandomScoreArr","nick","getName","score","idx","headUrl","getHeadImg","sort","Math","random","length","getUid","game_uid","push","nickname","toString","avatar","getRandString","parseInt","forEach","childrenCount","instantiate","addChild","x","winSize","width","scheduleOnce","showLoadAni","getComponent","initItem","tween","to","easing","start","floor","String","fromCharCode","__decorate","ScrollView","SpriteFrame","Label"],"mappings":";;;;;;AAAA,IAAIA,CAAJ;AACAC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;EAACC,KAAK,EAAE,CAAC;AAAT,CAA7C;;AACA,IAAIC,MAAM,GAAGC,OAAO,CAAC,OAAD,CAApB;;AACA,IAAIC,KAAK,GAAGD,OAAO,CAAC,MAAD,CAAnB;;AACA,IAAIE,QAAQ,GAAGF,OAAO,CAAC,SAAD,CAAtB;;AACA,IAAIG,aAAa,GAAGH,OAAO,CAAC,cAAD,CAA3B;;AACA,IAAII,UAAU,GAAGJ,OAAO,CAAC,WAAD,CAAxB;;AACA,IAAIK,CAAC,GAAGC,EAAE,CAACC,UAAX;AACA,IAAIC,CAAC,GAAGH,CAAC,CAACI,OAAV;AACA,IAAIC,CAAC,GAAGL,CAAC,CAACM,QAAV;;AACA,IAAIC,CAAC,GAAI,UAAUC,CAAV,EAAa;EAClB,SAASC,CAAT,GAAa;IACT,IAAIA,CAAC,GAAI,SAASD,CAAT,IAAcA,CAAC,CAACE,KAAF,CAAQ,IAAR,EAAcC,SAAd,CAAf,IAA4C,IAApD;IACAF,CAAC,CAACG,UAAF,GAAe,IAAf;IACAH,CAAC,CAACI,QAAF,GAAa,IAAb;IACAJ,CAAC,CAACK,UAAF,GAAe,EAAf;IACAL,CAAC,CAACM,MAAF,GAAW,IAAX;IACAN,CAAC,CAACO,QAAF,GAAa,IAAb;IACAP,CAAC,CAACQ,UAAF,GAAe,EAAf;IACA,OAAOR,CAAP;EACH;;EACDS,SAAS,CAACT,CAAD,EAAID,CAAJ,CAAT;;EACAC,CAAC,CAACU,SAAF,CAAYC,MAAZ,GAAqB,YAAY;IAC7BZ,CAAC,CAACW,SAAF,CAAYC,MAAZ,CAAmBC,IAAnB,CAAwB,IAAxB;IACA,KAAKN,MAAL,CAAYO,MAAZ,GAAqB1B,KAAK,CAAC2B,IAAN,CAAW,KAAX,CAArB;IACA,KAAKP,QAAL,GAAgB,KAAKJ,UAAL,CAAgBY,OAAhB,CAAwBC,QAAxB,CAAiC,CAAjC,CAAhB;EACH,CAJD;;EAKAhB,CAAC,CAACU,SAAF,CAAYO,IAAZ,GAAmB,UAAUjB,CAAV,EAAa;IAC5B,IAAIkB,CAAC,GAAGlB,CAAC,CAACmB,QAAV;IACA,IAAIvC,CAAC,GAAGoB,CAAC,CAACoB,UAAV;IACA,OAAOC,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;MAC/C,IAAIrB,CAAJ;MACA,IAAIsB,CAAJ;MACA,IAAIC,CAAJ;MACA,IAAIC,CAAJ;MACA,IAAIC,CAAJ;MACA,IAAIC,CAAJ;MACA,IAAInC,CAAJ;MACA,IAAIG,CAAJ;MACA,IAAIE,CAAJ;MACA,IAAIE,CAAJ;MACA,IAAI6B,CAAJ;MACA,IAAIC,CAAJ;;MACA,IAAIC,CAAJ;;MACA,IAAIC,CAAJ;MACA,IAAIC,CAAC,GAAG,IAAR;MACA,OAAOC,WAAW,CAAC,IAAD,EAAO,UAAUC,CAAV,EAAa;QAClC,QAAQA,CAAC,CAACC,KAAV;UACI,KAAK,CAAL;YACI,OACInC,CAAC,CAACW,SAAF,CAAYO,IAAZ,CAAiBL,IAAjB,CAAsB,IAAtB,EAA4B;cAACO,QAAQ,EAAED,CAAX;cAAcE,UAAU,EAAExC;YAA1B,CAA5B,GACA,CAAC,CAAD,EAAIQ,QAAQ,WAAR,CAAiB+C,GAAjB,CAAqBC,eAArB,EAAJ,CAFJ;;UAIJ,KAAK,CAAL;YACI,KACIpC,CAAC,GAAGiC,CAAC,CAACI,IAAF,EAAJ,EACIf,CAAC,GAAG,EADR,EAEItB,CAAC,CAACsC,IAAF,KAAWhB,CAAC,GAAG,GAAGiB,MAAH,CAAUvC,CAAC,CAACsC,IAAZ,CAAf,CAFJ,EAGIf,CAAC,GAAG,KAAKf,UAAL,GAAkB,CAH1B,EAIIgB,CAAC,GAAG,KAAKgB,iBAAL,EAJR,EAKIf,CAAC,GAAG,EALR,EAMIC,CAAC,GAAGzC,MAAM,WAAN,CAAekD,GANvB,EAOI5C,CAAC,GAAG;cAACkD,IAAI,EAAEf,CAAC,CAACgB,OAAF,EAAP;cAAoBC,KAAK,EAAEzB,CAA3B;cAA8B0B,GAAG,EAAE,EAAnC;cAAuCC,OAAO,EAAEnB,CAAC,CAACoB,UAAF;YAAhD,CAPR,EAQIxB,CAAC,CAACyB,IAAF,CAAO,YAAY;cACf,OAAOC,IAAI,CAACC,MAAL,KAAgB,GAAvB;YACH,CAFD,CARJ,EAWIvD,CAAC,GAAG,CAXR,EAYIE,CAAC,GAAG,CAbZ,EAcIA,CAAC,GAAG0B,CAAC,CAAC4B,MAAN,IAAgB,EAAEtD,CAAC,IAAI2B,CAAP,CAdpB,EAeI3B,CAAC,EAfL;cAiBKE,CAAC,GAAGwB,CAAC,CAAC1B,CAAD,CAAN,EACK+B,CAAC,GAAGD,CAAC,CAACyB,MAAF,EADT,EAEIrD,CAAC,CAACsD,QAAF,IAAczB,CAAd,KACKjC,CAAC,IACF+B,CAAC,CAAC4B,IAAF,CAAO;gBAACZ,IAAI,EAAE3C,CAAC,CAACwD,QAAT;gBAAmBX,KAAK,EAAEnB,CAAC,CAAC5B,CAAD,CAAD,CAAK2D,QAAL,EAA1B;gBAA2CX,GAAG,EAAE,EAAhD;gBAAoDC,OAAO,EAAE/C,CAAC,CAAC0D;cAA/D,CAAP,CAFJ,CAFJ;YAjBJ;;YAsBA,IAAI/B,CAAC,CAACyB,MAAF,GAAW3B,CAAf,EACI,KAAKK,CAAC,GAAGL,CAAC,GAAGE,CAAC,CAACyB,MAAV,EAAkBrB,CAAC,GAAG,CAA3B,EAA8BA,CAAC,GAAGD,CAAlC,EAAqCC,CAAC,EAAtC;cACKC,CAAC,GAAG,SAAS,KAAK2B,aAAL,EAAd,EACIhC,CAAC,CAAC4B,IAAF,CAAO;gBAACZ,IAAI,EAAEX,CAAP;gBAAUa,KAAK,EAAEnB,CAAC,CAAC9B,CAAC,GAAGmC,CAAL,CAAD,CAAS0B,QAAT,EAAjB;gBAAsCX,GAAG,EAAE,EAA3C;gBAA+CC,OAAO,EAAE;cAAxD,CAAP,CADJ;YADJ;YAGJ,OACIpB,CAAC,CAAC4B,IAAF,CAAO9D,CAAP,GACAkC,CAAC,CAACsB,IAAF,CAAO,UAAUhD,CAAV,EAAaC,CAAb,EAAgB;cACnB,OAAO0D,QAAQ,CAAC1D,CAAC,CAAC2C,KAAH,CAAR,GAAoBe,QAAQ,CAAC3D,CAAC,CAAC4C,KAAH,CAAnC;YACH,CAFD,CADA,EAIAlB,CAAC,CAACkC,OAAF,CAAU,UAAU5D,CAAV,EAAaC,CAAb,EAAgB;cACtBD,CAAC,CAAC6C,GAAF,GAAQ,CAAC5C,CAAC,GAAG,CAAL,EAAQuD,QAAR,EAAR;cACA,IAAIrC,CAAC,GAAG,IAAR;cACAa,CAAC,CAAC5B,UAAF,CAAaY,OAAb,CAAqB6C,aAArB,GAAqC5D,CAArC,GACOkB,CAAC,GAAGa,CAAC,CAAC5B,UAAF,CAAaY,OAAb,CAAqBC,QAArB,CAA8BhB,CAA9B,CADX,IAEQkB,CAAC,GAAG1B,EAAE,CAACqE,WAAH,CAAe9B,CAAC,CAACxB,QAAjB,CAAL,EAAkCwB,CAAC,CAAC5B,UAAF,CAAaY,OAAb,CAAqB+C,QAArB,CAA8B5C,CAA9B,CAFzC;cAGAA,CAAC,CAAC6C,CAAF,GAAM,CAACvE,EAAE,CAACwE,OAAH,CAAWC,KAAX,GAAmB/C,CAAC,CAAC+C,KAAtB,IAA+B,CAArC;cACAlC,CAAC,CAACmC,YAAF,CAAe,YAAY;gBACvBnC,CAAC,CAACoC,WAAF,CAAcjD,CAAd;cACH,CAFD,EAEG,OAAOlB,CAFV;cAGAkB,CAAC,CAACkD,YAAF,CAAe/E,aAAa,WAA5B,EAAsCgF,QAAtC,CAA+CtE,CAA/C,EAAkDgC,CAAC,CAAC1B,UAAF,CAAaL,CAAb,CAAlD;YACH,CAXD,CAJA,EAgBA,KAAKI,QAAL,CAAcgE,YAAd,CAA2B/E,aAAa,WAAxC,EAAkDgF,QAAlD,CAA2D9E,CAA3D,EAA8D,KAAKc,UAAL,CAAgBd,CAAC,CAACqD,GAAlB,CAA9D,CAhBA,EAiBA,CAAC,CAAD,CAlBJ;QAjCR;MAsDH,CAvDiB,CAAlB;IAwDH,CAxEe,CAAhB;EAyEH,CA5ED;;EA6EA5C,CAAC,CAACU,SAAF,CAAYyD,WAAZ,GAA0B,UAAUpE,CAAV,EAAa;IACnCP,EAAE,CAAC8E,KAAH,CAASvE,CAAT,EAAYwE,EAAZ,CAAe,GAAf,EAAoB;MAACR,CAAC,EAAE;IAAJ,CAApB,EAA4B;MAACS,MAAM,EAAE;IAAT,CAA5B,EAAmDC,KAAnD;EACH,CAFD;;EAGAzE,CAAC,CAACU,SAAF,CAAY8B,iBAAZ,GAAgC,YAAY;IACxC,KAAK,IAAIzC,CAAC,GAAG,EAAR,EAAYC,CAAC,GAAG,KAAKQ,UAAL,GAAkB,CAAlC,EAAqCU,CAAC,GAAG,CAA9C,EAAiDA,CAAC,GAAGlB,CAArD,EAAwDkB,CAAC,EAAzD,EAA6D;MACzD,IAAItC,CAAC,GAAG,KAAK,CAAb;MACA,IAAI0C,CAAC,GAAG,KAAK,CAAb;MACAJ,CAAC,GAAG,CAAJ,IACQtC,CAAC,GAAG,OAAO,IAAIsC,CAAX,CAAL,EAAsBI,CAAC,GAAG,OAAO,IAAIJ,CAAX,CADjC,IAEMA,CAAC,IAAI,CAAL,IAAUA,CAAC,IAAI,CAAf,KAAsBtC,CAAC,GAAG,CAAC,EAAD,IAAOsC,CAAC,GAAG,CAAX,CAAL,EAAsBI,CAAC,GAAG,CAAC,EAAD,GAAMJ,CAAN,GAAU,GAAzD,CAFN;MAGA,IAAIK,CAAC,GAAGyB,IAAI,CAAC0B,KAAL,CAAW1B,IAAI,CAACC,MAAL,MAAiB3B,CAAC,GAAG1C,CAArB,CAAX,IAAsCA,CAA9C;MACAmB,CAAC,CAACsD,IAAF,CAAO9B,CAAP;IACH;;IACD,OAAOxB,CAAP;EACH,CAXD;;EAYAC,CAAC,CAACU,SAAF,CAAY+C,aAAZ,GAA4B,YAAY;IACpC,KAAK,IAAI1D,CAAC,GAAG,EAAR,EAAYC,CAAC,GAAG,CAArB,EAAwBA,CAAC,GAAG,CAA5B,EAA+BA,CAAC,EAAhC,EAAoC;MAChC,IAAIkB,CAAJ;MACA,IAAItC,CAAC,GAAGoE,IAAI,CAAC0B,KAAL,CAAW,IAAI1B,IAAI,CAACC,MAAL,EAAf,CAAR;MACA/B,CAAC,GACG,MAAMtC,CAAN,GACMoE,IAAI,CAAC0B,KAAL,CAAW,KAAK1B,IAAI,CAACC,MAAL,EAAhB,IAAiC,EADvC,GAEM,MAAMrE,CAAN,GACAoE,IAAI,CAAC0B,KAAL,CAAW,KAAK1B,IAAI,CAACC,MAAL,EAAhB,IAAiC,EADjC,GAEAD,IAAI,CAAC0B,KAAL,CAAW,KAAK1B,IAAI,CAACC,MAAL,EAAhB,IAAiC,EAL3C;MAMAlD,CAAC,CAACsD,IAAF,CAAOnC,CAAP;IACH;;IACD,OAAOyD,MAAM,CAACC,YAAP,CAAoB3E,KAApB,CAA0B0E,MAA1B,EAAkC5E,CAAlC,CAAP;EACH,CAbD;;EAcA8E,UAAU,CAAC,CAACjF,CAAC,CAACJ,EAAE,CAACsF,UAAJ,CAAF,CAAD,EAAqB9E,CAAC,CAACU,SAAvB,EAAkC,YAAlC,EAAgD,KAAK,CAArD,CAAV;;EACAmE,UAAU,CAAC,CAACjF,CAAC,CAACP,aAAa,WAAd,CAAF,CAAD,EAA6BW,CAAC,CAACU,SAA/B,EAA0C,UAA1C,EAAsD,KAAK,CAA3D,CAAV;;EACAmE,UAAU,CAAC,CAACjF,CAAC,CAAC,CAACJ,EAAE,CAACuF,WAAJ,CAAD,CAAF,CAAD,EAAwB/E,CAAC,CAACU,SAA1B,EAAqC,YAArC,EAAmD,KAAK,CAAxD,CAAV;;EACAmE,UAAU,CAAC,CAACjF,CAAC,CAACJ,EAAE,CAACwF,KAAJ,CAAF,CAAD,EAAgBhF,CAAC,CAACU,SAAlB,EAA6B,QAA7B,EAAuC,KAAK,CAA5C,CAAV;;EACA,OAAOmE,UAAU,CAAC,CAACnF,CAAD,CAAD,EAAMM,CAAN,CAAjB;AACH,CAhIO,CAgILV,UAAU,WAhIL,CAAR;;AAiIAP,OAAO,WAAP,GAAkBe,CAAlB","sourceRoot":"/","sourcesContent":["var n;\nObject.defineProperty(exports, \"__esModule\", {value: !0});\nvar _uData = require(\"uData\");\nvar _lang = require(\"lang\");\nvar _rankMgr = require(\"rankMgr\");\nvar _raceRankItem = require(\"raceRankItem\");\nvar _ui_rePlay = require(\"ui_rePlay\");\nvar h = cc._decorator;\nvar f = h.ccclass;\nvar g = h.property;\nvar y = (function (t) {\n    function e() {\n        var e = (null !== t && t.apply(this, arguments)) || this;\n        e.scrollRank = null;\n        e.selfRank = null;\n        e.idxIconArr = [];\n        e.rankLb = null;\n        e.rankItem = null;\n        e.rankLength = 10;\n        return e;\n    }\n    __extends(e, t);\n    e.prototype.onLoad = function () {\n        t.prototype.onLoad.call(this);\n        this.rankLb.string = _lang.lang[40003];\n        this.rankItem = this.scrollRank.content.children[0];\n    };\n    e.prototype.init = function (e) {\n        var o = e.curScore;\n        var n = e.continueCb;\n        return __awaiter(this, void 0, void 0, function () {\n            var e;\n            var i;\n            var r;\n            var a;\n            var l;\n            var d;\n            var h;\n            var f;\n            var g;\n            var y;\n            var m;\n            var v;\n            var _;\n            var b;\n            var w = this;\n            return __generator(this, function (s) {\n                switch (s.label) {\n                    case 0:\n                        return (\n                            t.prototype.init.call(this, {curScore: o, continueCb: n}),\n                            [4, _rankMgr.default.ins.getYdayRaceData()]\n                        );\n                    case 1:\n                        for (\n                            e = s.sent(),\n                                i = [],\n                                e.data && (i = [].concat(e.data)),\n                                r = this.rankLength - 1,\n                                a = this.getRandomScoreArr(),\n                                l = [],\n                                d = _uData.default.ins,\n                                h = {nick: d.getName(), score: o, idx: \"\", headUrl: d.getHeadImg()},\n                                i.sort(function () {\n                                    return Math.random() - 0.5;\n                                }),\n                                f = 0,\n                                g = 0;\n                            g < i.length && !(g >= r);\n                            g++\n                        )\n                            (y = i[g]),\n                                (m = d.getUid()),\n                                y.game_uid != m &&\n                                    (f++,\n                                    l.push({nick: y.nickname, score: a[g].toString(), idx: \"\", headUrl: y.avatar}));\n                        if (l.length < r)\n                            for (v = r - l.length, _ = 0; _ < v; _++)\n                                (b = \"卷卷大王\" + this.getRandString()),\n                                    l.push({nick: b, score: a[f + _].toString(), idx: \"\", headUrl: \"\"});\n                        return (\n                            l.push(h),\n                            l.sort(function (t, e) {\n                                return parseInt(e.score) - parseInt(t.score);\n                            }),\n                            l.forEach(function (t, e) {\n                                t.idx = (e + 1).toString();\n                                var o = null;\n                                w.scrollRank.content.childrenCount > e\n                                    ? (o = w.scrollRank.content.children[e])\n                                    : ((o = cc.instantiate(w.rankItem)), w.scrollRank.content.addChild(o));\n                                o.x = (cc.winSize.width + o.width) / 2;\n                                w.scheduleOnce(function () {\n                                    w.showLoadAni(o);\n                                }, 0.05 * e);\n                                o.getComponent(_raceRankItem.default).initItem(t, w.idxIconArr[e]);\n                            }),\n                            this.selfRank.getComponent(_raceRankItem.default).initItem(h, this.idxIconArr[h.idx]),\n                            [2]\n                        );\n                }\n            });\n        });\n    };\n    e.prototype.showLoadAni = function (t) {\n        cc.tween(t).to(0.5, {x: 0}, {easing: \"backInOut\"}).start();\n    };\n    e.prototype.getRandomScoreArr = function () {\n        for (var t = [], e = this.rankLength - 1, o = 0; o < e; o++) {\n            var n = void 0;\n            var i = void 0;\n            o < 7\n                ? ((n = 100 * (7 - o)), (i = 100 * (8 - o)))\n                : o >= 7 && o <= 8 && ((n = -20 * (o - 8)), (i = -80 * o + 660));\n            var r = Math.floor(Math.random() * (i - n)) + n;\n            t.push(r);\n        }\n        return t;\n    };\n    e.prototype.getRandString = function () {\n        for (var t = [], e = 0; e < 4; e++) {\n            var o;\n            var n = Math.floor(3 * Math.random());\n            o =\n                0 === n\n                    ? Math.floor(26 * Math.random()) + 65\n                    : 1 === n\n                    ? Math.floor(26 * Math.random()) + 97\n                    : Math.floor(10 * Math.random()) + 48;\n            t.push(o);\n        }\n        return String.fromCharCode.apply(String, t);\n    };\n    __decorate([g(cc.ScrollView)], e.prototype, \"scrollRank\", void 0);\n    __decorate([g(_raceRankItem.default)], e.prototype, \"selfRank\", void 0);\n    __decorate([g([cc.SpriteFrame])], e.prototype, \"idxIconArr\", void 0);\n    __decorate([g(cc.Label)], e.prototype, \"rankLb\", void 0);\n    return __decorate([f], e);\n})(_ui_rePlay.default);\nexports.default = y;\n"]}