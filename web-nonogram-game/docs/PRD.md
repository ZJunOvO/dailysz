# 卷宝专属数织游戏 Web版 - 产品需求文档（PRD）

## 1. 产品概述

### 1.1 项目背景
为卷宝（女朋友）定制开发一款浪漫的数织游戏web版本，基于现有Cocos Creator项目的核心算法，创建更简洁易用的web版本。

### 1.2 产品定位
- **目标用户**：卷宝（主要用户）+ 菌子（开发者/男朋友）
- **产品类型**：定制化数织解谜游戏
- **平台**：Web浏览器（HTML5/CSS3/JavaScript）
- **核心特色**：个性化定制 + 现金奖励系统 + 浪漫元素

## 2. 核心功能需求

### 2.1 用户系统
- **默认用户名**：卷卷大王
- **头像系统**：支持自定义头像上传
- **数据持久化**：使用localStorage保存用户进度

### 2.2 游戏核心功能

#### 2.2.1 数织玩法
- **游戏类型**：数织/Picross/Nonogram解谜游戏
- **关卡系统**：
  - 初始解锁：前51关自动解锁
  - 设置开关：可在设置中开启/关闭自动解锁功能
  - 难度分级：入门、简单、中级、困难、专家
- **操作方式**：
  - 鼠标左键：标记填充格子
  - 鼠标右键：标记X（排除格子）
  - 支持拖拽连续操作
- **辅助功能**：
  - 撤销/重做
  - 提示系统
  - 自动保存进度

#### 2.2.2 现金奖励系统
**核心机制**：
- **基础奖励**：¥0.52-5.2 根据难度浮动
- **难度系数**：
  - 入门：0.5x
  - 简单：0.8x
  - 中级：1.0x
  - 困难：1.5x
  - 专家：2.0x
- **连胜奖励**：连续通关奖励递增（最高3倍）
- **特殊日期奖励**：
  - 生日奖励（04-22, 12-28）：5倍奖励
  - 纪念日奖励（09-16）：3倍奖励
- **显示方式**：顶部状态栏实时显示累计现金

### 2.3 界面系统

#### 2.3.1 主界面布局
```
[头像] [卷卷大王] [设置] [记录]
[现金：¥X.XX] [金币：XXX] [体力：XX/100]
          [开始游戏]
       [关卡选择] [设置]
```

#### 2.3.2 游戏界面
```
[返回] [关卡X] [提示] [撤销]
     数织游戏区域
[当前现金奖励：¥X.XX]
```

#### 2.3.3 设置界面
- 音效开关
- 背景音乐开关
- 自动解锁开关
- 数据清除
- 关于游戏

### 2.4 视觉设计要求

#### 2.4.1 色彩方案
- **主色调**：温暖粉色系 + 金色装饰
- **辅助色**：柔和蓝色、薄荷绿
- **强调色**：现金奖励使用金黄色

#### 2.4.2 UI风格
- **设计风格**：简约、温馨、浪漫
- **字体**：圆润、清晰易读
- **图标**：可爱、统一风格
- **动画**：柔和过渡效果

## 3. 技术需求

### 3.1 技术栈
- **前端**：原生HTML5 + CSS3 + JavaScript (ES6+)
- **数据存储**：localStorage
- **构建工具**：可选择Vite或Webpack
- **代码规范**：ESLint + Prettier

### 3.2 核心算法
从Cocos项目提取：
- 数织谜题生成算法
- 谜题验证逻辑
- 关卡数据结构
- 难度计算系统

### 3.3 性能要求
- **加载时间**：首屏加载 < 3秒
- **响应时间**：操作响应 < 100ms
- **兼容性**：支持现代浏览器（Chrome 70+、Firefox 65+、Safari 12+）
- **移动端适配**：响应式设计，支持手机和平板

## 4. 数据结构设计

### 4.1 用户数据
```javascript
const userData = {
  name: "卷卷大王",
  avatar: "default_avatar.png",
  level: 1,
  totalCash: 500, // 分为单位
  coins: 1000,
  power: 100,
  unlockedLevels: 51,
  winStreak: 0,
  settings: {
    autoUnlock: true,
    soundEnabled: true,
    musicEnabled: true
  },
  progress: {
    currentLevel: 1,
    completedLevels: [],
    lastPlayTime: Date.now()
  }
}
```

### 4.2 关卡数据
```javascript
const levelData = {
  id: 1,
  name: "关卡1",
  difficulty: 1, // 1-5
  size: {width: 10, height: 10},
  solution: [], // 解决方案数组
  hints: {
    rows: [], // 行提示
    cols: []  // 列提示
  },
  reward: {
    baseCash: 52, // 基础奖励（分）
    baseCoins: 10
  }
}
```

## 5. 奖励系统详细设计

### 5.1 现金计算公式
```javascript
最终奖励 = 基础奖励 × 难度系数 × 连胜系数 × 特殊日期系数

基础奖励：52-520分（¥0.52-5.20）
难度系数：0.5-2.0
连胜系数：1.0-3.0 
特殊日期系数：1.0/3.0/5.0
```

### 5.2 连胜机制
- 1-2连胜：1.0x
- 3-5连胜：1.2x
- 6-10连胜：1.5x
- 11-20连胜：2.0x
- 21+连胜：3.0x

### 5.3 特殊日期检测
```javascript
const specialDates = {
  "04-22": {name: "卷宝生日", multiplier: 5.0},
  "12-28": {name: "菌子生日", multiplier: 5.0}, 
  "09-16": {name: "恋爱纪念日", multiplier: 3.0}
}
```

## 6. 开发计划

### 6.1 开发阶段
1. **阶段一**：算法提取与核心逻辑实现（1-2天）
2. **阶段二**：基础UI界面开发（2-3天）
3. **阶段三**：奖励系统集成（1天）
4. **阶段四**：优化与测试（1天）

### 6.2 里程碑
- **MVP版本**：基础游戏功能 + 简单奖励
- **完整版本**：所有功能完整实现
- **优化版本**：性能优化 + 用户体验提升

## 7. 测试需求

### 7.1 功能测试
- 游戏逻辑正确性
- 奖励计算准确性
- 数据持久化可靠性
- 界面交互流畅性

### 7.2 兼容性测试
- 不同浏览器兼容性
- 不同设备屏幕适配
- 不同网络环境下性能

### 7.3 用户体验测试
- 操作便利性
- 视觉舒适度
- 游戏趣味性

## 8. 上线与维护

### 8.1 部署方案
- **本地部署**：直接打开HTML文件
- **在线部署**：可选择GitHub Pages或其他静态托管

### 8.2 后续优化
- 根据卷宝使用反馈进行优化
- 增加更多关卡内容
- 完善奖励机制
- 添加更多浪漫元素

---

**开发者备注**：这是一个为卷宝定制的专属游戏，每个细节都充满爱意 💕